


<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>題孳</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
    --primary-gray: #4B5563;
    --secondary-gray: #6B7280;
    --accent-gray: #9CA3AF;
    --primary-blue: #1F2937;
    --secondary-blue: #374151;
    --accent-blue: #4B5563;
    --primary-purple: #6D28D9;
    --secondary-purple: #7C3AED;
    --accent-purple: #8B5CF6;
    --primary-green: #065F46;
    --secondary-green: #047857;
    --accent-green: #34D399;
    --primary-rose: #9F1239;
    --secondary-rose: #BE123C;
    --accent-rose: #F43F5E;
    --primary-amber: #B45309;
    --secondary-amber: #D97706;
    --accent-amber: #F59E0B;
    --primary-indigo: #3730A3;
    --secondary-indigo: #4338CA;
    --accent-indigo: #4F46E5;
    --primary-cyan: #0E7490;
    --secondary-cyan: #0891B2;
    --accent-cyan: #06B6D4;
    --divider-color: #9CA3AF;
}

body {
    font-family: 'Noto Serif TC', 'cwTeXHei', 'cwTeXFangSong', 'cwTeXKai', 'cwTeXMing', 'PingFang TC', 'Microsoft JhengHei', serif;
    font-size: 18px;
    background: linear-gradient(135deg, #F3F4F6 0%, #E5E7EB 100%);
    background-attachment: fixed;
    overflow-x: hidden;
}

* {
    box-sizing: border-box;
}


@media (max-width: 767px) {
    .text-center {
        display: flex;
        flex-wrap: nowrap; /* 防止換行 */
        justify-content: center; /* 水平置中 */
        gap: 10px; /* 按鍵間距 */
        padding: 0 10px; /* 左右邊距 */
    }
    .text-center button {
        flex: 1 1 auto; /* 按鍵寬度自適應 */
        min-width: 100px; /* 最小寬度 */
        max-width: 120px; /* 最大寬度，避免過寬 */
        padding: 10px 12px; /* 調整內距 */
        font-size: 14px; /* 縮小字體 */
        margin: 0; /* 移除原始外距 */
    }
}


.question-number {
    background: linear-gradient(135deg, #45b39d , #2471a3);
}


.btn-pdf {
    background: linear-gradient(135deg, #73c6b6   0%, #117a65 100%); /* 綠色漸變 */
    color: white;
    border-radius: 16px;
    padding: 12px 24px;
    font-weight: 600;
    transition: all 0.3s ease;
}



/* 響應式PDF輸出優化 */
@media print {
    html, body {
        width: 794px !important; /* A4寬度，96dpi */
        height: 1123px !important; /* A4高度，96dpi */
        margin: 0 !important;
        padding: 0 !important;
        overflow: visible !important; /* 確保內容不被截斷 */
        background: #ffffff !important; /* 純白背景 */
        color: #000000 !important; /* 純黑文字 */
        -webkit-print-color-adjust: exact !important; /* 強制精確顏色 */
        print-color-adjust: exact !important; /* 標準屬性 */
        font-size: 12pt !important; /* 提高可讀性 */
        line-height: 1.5 !important; /* 調整行距 */
    }

    /* 內容區域適應A4 */
    #questionsDisplay {
        width: 100% !important;
        max-width: 754px !important; /* 保留20px邊距 */
        margin: 0 auto !important;
        padding: 20px !important;
    }

    /* 問題卡片樣式 */
    .question-card {
        width: 754px !important;
        height: auto !important;
        margin: 20px auto !important;
        padding: 20px !important;
        background: #ffffff !important;
        color: #000000 !important;
        page-break-inside: avoid !important; /* 避免跨頁 */
        box-sizing: border-box !important;
        border: 1px solid #000000 !important; /* 深色邊框 */
    }

    /* 強制文字與背景高對比 */
    .question-title, .answer-section, .steps-section, 
    p, span, div, h1, h2, h3, h4, h5, h6 {
        background: #ffffff !important;
        color: #000000 !important;
        opacity: 1 !important; /* 移除透明度 */
    }

    /* 表格清晰度 */
    table, th, td {
        border: 1px solid #000000 !important;
        background: #ffffff !important;
        color: #000000 !important;
    }

    /* 移除不需要的元素 */
    .floating-header, .floating-generate-btn, 
    .copyright-footer, .btn-primary, .btn-secondary, 
    .btn-accent, button {
        display: none !important;
    }

    /* 移除漸變與透明度 */
    [style*="linear-gradient"], [style*="opacity"], [style*="rgba"] {
        background: #ffffff !important;
        opacity: 1 !important;
        color: #000000 !important;
    }

    /* 確保所有文字為黑色 */
    * {
        color: #000000 !important;
    }
}

/* 設備適應性CSS */
@media screen and (max-width: 768px) {
    .question-card {
        font-size: 16px !important;
        padding: 15px !important;
    }
}

@media screen and (min-width: 1200px) {
    .question-card {
        font-size: 18px !important;
        padding: 25px !important;
    }
}




.progress-bar-container {
    position: relative;
    width: 100%;
    height: 100%;
    background-color: #e6e6e6;
    border-radius: 999px;
    overflow: hidden;
}

.progress-bar {
    height: 100%;
    background: linear-gradient(135deg, #76d7c4 0%, #45b39d 100%);
    transition: width 0.4s ease-in-out;
}



.practical-table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
}

.practical-table th, .practical-table td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: left;
}

.practical-table th {
    background-color: #f2f2f2;
    font-weight: bold;
}


.copyright-footer {
    position: fixed;
    bottom: 0;
    right: 0;
    padding: 5px 10px;
    background-color: #f1f1f1;
    z-index: 1000;
}

.copyright-footer p {
    margin: 0;
    font-size: 14px;
}

.divider {
    height: 1px;
    background: linear-gradient(135deg, #a9cce3 0%, #d4e6f1 100%);
    border-radius: 999px;
    margin: 2rem 0;
}

.h-1.bg-gradient-to-r {
    background: linear-gradient(135deg, #a9cce3 0%, #d4e6f1 100%);
}

.glass-card {
    backdrop-filter: blur(20px);
    background: rgba(255, 255, 255, 0.85);
    border: 2px solid rgba(75, 85, 99, 0.2);
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    border-radius: 24px;
}

.sidebar-card {
    backdrop-filter: blur(15px);
    background: linear-gradient(135deg, rgba(107, 114, 128, 0.1) 0%, rgba(55, 65, 81, 0.1) 100%);
    border: 2px solid rgba(75, 85, 99, 0.3);
    box-shadow: 0 20px 40px rgba(75, 85, 99, 0.15);
    border-radius: 20px;
}

.question-card {
    background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
    border-left: 6px solid var(--primary-gray);
    border-radius: 20px;
    transition: all 0.4s ease;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
}

.question-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
}

.btn-primary {
    background: linear-gradient(135deg, #cd6155 0%, #a93226 100%);
    color: white;
    border-radius: 16px;
    padding: 14px 28px;
    font-weight: 700;
    font-size: 20px;
    transition: all 0.3s ease;
    border: 2px solid transparent;
    box-shadow: 0 8px 25px rgba(75, 85, 99, 0.3);
}

.btn-primary:hover {
    transform: translateY(-3px);
    box-shadow: 0 15px 35px rgba(75, 85, 99, 0.4);
    background: linear-gradient(135deg, var(--secondary-gray) 0%, var(--accent-gray) 100%);
}

.btn-secondary {
    background: linear-gradient(135deg, #2471a3 0%, #a2d9ce  100%);
    color: white;
    border-radius: 16px;
    padding: 12px 24px;
    font-weight: 600;
    transition: all 0.3s ease;
}

.btn-accent {
    background: linear-gradient(135deg, #d98880 0%, #cb4335 100%);
    color: white;
    border-radius: 16px;
    padding: 12px 24px;
    font-weight: 600;
    transition: all 0.3s ease;
}

.type-selector-btn {
    cursor: pointer;
    transition: all 0.4s ease;
    border: 3px solid transparent;
    border-radius: 20px;
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    position: relative;
    overflow: hidden;
}

.type-selector-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(75, 85, 99, 0.2), transparent);
    transition: left 0.5s ease;
}

.type-selector-btn:hover::before {
    left: 100%;
}

.type-selector-btn:hover {
    transform: translateY(-4px);
    box-shadow: 0 15px 35px rgba(75, 85, 99, 0.2);
    border-color: var(--accent-gray);
}

.type-selector-btn.selected {
    border-color: var(--primary-gray);
    background: linear-gradient(135deg, #a9cce3 0%, rgba(213, 245, 227, 0.8) 100%);
    box-shadow: 0 10px 30px rgba(75, 85, 99, 0.25);
}

.quantity-control {
    display: flex;
    align-items: center;
    justify-content: center;
    background: white;
    border: 2px solid var(--accent-gray);
    border-radius: 12px;
    overflow: hidden;
    width: auto;
    max-width: 150px;
    margin: 0 auto;
    padding: 0;
    gap: 0;
}

.quantity-btn {
    background: linear-gradient(135deg, #a9cce3 0%, #d4e6f1 100%);
    color: white;
    border: none;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 600;
    flex-shrink: 0;
    margin: 0;
    padding: 0;
}

.quantity-input {
    border: none;
    width: 60px;
    text-align: center;
    font-weight: 700;
    font-size: 18px;
    color: var(--primary-gray);
    background: transparent;
    flex-shrink: 0;
    margin: 0;
    padding: 0;
    height: 40px;
    line-height: 40px;
}

/* 平板設備 */
@media (max-width: 1023px) {
    .quantity-control {
        max-width: 120px;
        height: 40px;
    }

    .quantity-btn {
        width: 35px;
        height: 35px;
        font-size: 16px;
    }

    .quantity-input {
        width: 50px;
        font-size: 16px;
        height: 35px;
        line-height: 35px;
    }
}

/* 手機設備 */
@media (max-width: 767px) {
    .quantity-control {
        max-width: 100px;
        height: 35px;
    }

    .quantity-btn {
        width: 30px;
        height: 30px;
        font-size: 14px;
    }

    .quantity-input {
        width: 40px;
        font-size: 14px;
        height: 30px;
        line-height: 30px;
    }
}

.toggle-switch {
    position: relative;
    width: 70px;
    height: 36px;
    background: #e2e8f0;
    border-radius: 18px;
    cursor: pointer;
    transition: all 0.3s ease;
    flex-shrink: 0;
}

.toggle-switch.active {
    background: linear-gradient(135deg, #a9cce3 0%, #d4e6f1 100%);
}

.toggle-slider {
    position: absolute;
    top: 3px;
    left: 3px;
    width: 30px;
    height: 30px;
    background: white;
    border-radius: 50%;
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.toggle-switch.active .toggle-slider {
    transform: translateX(34px);
}

.floating-generate-btn {
    position: fixed;
    bottom: 50px; /* 修訂為50px，從30px上移 */
    right: 30px;
    z-index: 1001; /* 修訂為1001，高於FOOTER的1000 */
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--primary-rose) 0%, var(--secondary-rose) 100%);
    color: white;
    border: none;
    cursor: pointer;
    box-shadow: 0 15px 35px rgba(225, 29, 72, 0.4);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
}

/* 平板設備 */
@media (max-width: 1023px) and (min-width: 768px) {
    .floating-generate-btn {
        bottom: 35px; /* 平板上移至35px */
        width: 70px;
        height: 70px;
        font-size: 24px;
    }
}

/* 手機設備 */
@media (max-width: 767px) {
    .floating-generate-btn {
        bottom: 40px; /* 手機上移至40px */
        right: 20px;
        width: 60px;
        height: 60px;
        font-size: 20px;
    }
}

/* 更小的手機設備 */
@media (max-width: 480px) {
    .floating-generate-btn {
        bottom: 50px; /* 超小屏幕上移至50px */
        right: 15px;
        width: 50px;
        height: 50px;
        font-size: 18px;
    }
}

.progress-ring {
    transform: rotate(-90deg);
}

.progress-ring-circle {
    transition: stroke-dasharray 0.4s ease-in-out;
}

.fade-in {
    opacity: 0;
    animation: fadeIn 0.8s ease-in forwards;
}

@keyframes fadeIn {
    to { opacity: 1; }
}

.slide-up {
    transform: translateY(30px);
    opacity: 0;
    animation: slideUp 1s ease-out forwards;
}

@keyframes slideUp {
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.floating-header {
    position: sticky;
    top: 0;
    z-index: 50;
    backdrop-filter: blur(15px);
    background: linear-gradient(135deg, var(--primary-gray) 0%, var(--primary-blue) 100%);
    border-bottom: 3px solid var(--accent-gray);
    padding: 15px 0; /* 原為 py-10 (40px)，減小到 15px */
    transition: display 0.3s ease; /* 添加平滑過渡 */
}

/* 調整標題文字大小 */
.floating-header h1 {
    font-size: 2.5rem; /* 原為 5xl (約 3.75rem)，減小到 2.5rem */
}

.result-page {
    background: linear-gradient(135deg, #F9FAFB 0%, #F3F4F6 100%);
    min-height: 100vh;
}

.question-number {
    color: #1F2937;
}

.question-title {
    background: linear-gradient(135deg, var(--primary-amber) 0%, var(--secondary-amber) 100%);
    color: #1F2937;
    padding: 12px 20px;
    border-radius: 12px;
    font-weight: 700;
    font-size: 20px;
}

.answer-section {
    background: linear-gradient(135deg, #d0ece7 0%, #73c6b6 100%);
    border: 2px solid #4B5563;
    border-radius: 16px;
    padding: 20px;
    margin-top: 16px;
}

.steps-section {
    background: linear-gradient(135deg, #d4e6f1 0%, #7fb3d5 100%);
    border: 2px solid #4B5563;
    border-radius: 16px;
    padding: 20px;
    margin-top: 16px;
    color: #1F2937;
}

textarea, input[type="text"] {
    min-height: 150px !important;
    font-size: 16px;
    line-height: 1.6;
}

#targetPassage {
    min-height: 300px !important;
}

.reference-qa textarea {
    min-height: 180px !important;
}

.question-type-container {
    max-width: 600px;
    margin: 0 auto;
}

.text-library-selector {
    background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
    border: 3px solid #e2e8f0;
    border-radius: 20px;
    padding: 20px;
    margin-bottom: 20px;
    transition: all 0.3s ease;
}

.text-library-selector:hover {
    border-color: #a9cce3;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
}

.text-library-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 16px;
    max-height: 400px;
    overflow-y: auto;
}

.text-item {
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    padding: 16px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.text-item:hover {
    border-color: #a9cce3;
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
}

.text-item.selected {
    border-color: #3498db;
    background: linear-gradient(135deg, #ebf5fb 0%, #d6eaf8 50%);
}

.text-item-title {
    font-weight: 700;
    font-size: 18px;
    color: #1F2937;
    margin-bottom: 8px;
}

.text-item-info {
    font-size: 14px;
    color: #6B7280;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.text-category {
    background: linear-gradient(135deg, #a9cce3 0%, #d4e6f1 100%);
    color: white;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
}

/* 响应式设计 - 桌面端 */
.container {
    max-width: 100%;
    margin: 0 auto;
    padding: 0 1.5rem;
}

/* 平板端优化 (768px - 1023px) */
@media (max-width: 1023px) and (min-width: 768px) {
    body {
        font-size: 16px;
    }
    
    .container {
        padding: 0 1rem;
    }
    
    .floating-header h1 {
        font-size: 3rem;
    }
    
    .glass-card, .sidebar-card {
        padding: 1.5rem;
    }
    
    .question-type-container {
        max-width: 100%;
    }
    
    .grid {
        grid-template-columns: 1fr;
        gap: 2rem;
    }
    
    .xl\:col-span-1, .xl\:col-span-2 {
        grid-column: span 1;
    }
    
    .type-selector-btn {
        padding: 1rem;
    }
    
    .floating-generate-btn {
        bottom: 20px;
        right: 20px;
        width: 60px;
        height: 60px;
        font-size: 20px;
    }
    
    .quantity-control {
        max-width: 140px;
    }
    
    .quantity-btn {
        width: 35px;
        height: 35px;
    }
    
    .quantity-input {
        width: 50px;
        font-size: 16px;
    }
    
    .toggle-switch {
        width: 60px;
        height: 32px;
    }
    
    .toggle-slider {
        width: 26px;
        height: 26px;
    }
    
    .toggle-switch.active .toggle-slider {
        transform: translateX(28px);
    }
    
    .text-library-grid {
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    }
}

/* 手机端优化 (max-width: 767px) */
@media (max-width: 767px) {
    body {
        font-size: 14px;
        padding: 0;
        margin: 0;
    }
    
    * {
        box-sizing: border-box;
    }
    
    .container {
        padding: 0 0.75rem;
        max-width: 100vw;
        overflow-x: hidden;
    }
    
    .floating-header {
        padding: 1rem 0;
    }
    
    .floating-header h1 {
        font-size: 2rem;
        margin-bottom: 0.5rem;
    }
    
    .floating-header .container {
        padding: 0 1rem;
    }
    
    /* 主要布局调整 - 单列布局 */
    .grid {
        grid-template-columns: 1fr;
        gap: 1.5rem;
    }
    
    .xl\:col-span-1, .xl\:col-span-2 {
        grid-column: span 1;
    }
    
    /* 侧边栏卡片调整 - 减少AI擬题系統占比 */
    .sidebar-card {
        padding: 1rem;
        margin-bottom: 1rem;
        position: static;
    }
    
    .sidebar-card h2 {
        font-size: 1.25rem;
        margin-bottom: 1rem;
    }
    
    /* 主要配置区域调整 */
    .glass-card {
        padding: 1rem;
        margin-bottom: 1rem;
    }
    
    .glass-card h3 {
        font-size: 1.5rem;
        margin-bottom: 1rem;
    }
    
    /* 题型选择器优化 */
    .type-selector-btn {
        padding: 0.75rem;
        margin-bottom: 0.5rem;
    }
    
    .type-selector-btn i {
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
    }
    
    .type-selector-btn div {
        font-size: 0.875rem;
    }
    
    /* 题型选择网格 */
    .question-type-container .grid {
        grid-template-columns: 1fr;
        gap: 0.75rem;
    }
    
    .md\:grid-cols-2 {
        grid-template-columns: 1fr;
    }
    
    /* 题型选择项优化 */
    .question-type-selection {
        padding: 0.75rem;
        border-radius: 1rem;
        width: 100%;
        max-width: 100%;
    }
    
    .question-type-selection .flex {
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
    }
    
    .question-type-selection .toggle-switch {
        width: 50px;
        height: 28px;
        margin: 0;
    }
    
    .question-type-selection .toggle-slider {
        width: 22px;
        height: 22px;
        top: 3px;
        left: 3px;
    }
    
    .question-type-selection.active .toggle-slider {
        transform: translateX(22px);
    }
    
    /* 数量控制器优化 - 修正宽度问题 */
    .quantity-control {
        width: auto;
        max-width: 120px;
        margin: 0.5rem auto 0;
        justify-content: center;
    }
    
    .quantity-btn {
        width: 30px;
        height: 30px;
        flex-shrink: 0;
    }
    
    .quantity-input {
        width: 40px;
        font-size: 14px;
        text-align: center;
        flex-shrink: 0;
    }
    
    /* 浮动生成按钮 */
    .floating-generate-btn {
        bottom: 15px;
        right: 15px;
        width: 50px;
        height: 50px;
        font-size: 18px;
    }
    
    /* 文本库网格 */
    .text-library-grid {
        grid-template-columns: 1fr;
        gap: 0.75rem;
        max-height: 300px;
    }
    
    .text-item {
        padding: 0.75rem;
    }
    
    .text-item-title {
        font-size: 1rem;
    }
    
    .text-item-info {
        font-size: 0.75rem;
    }
    
    /* 表单元素 */
    textarea, input[type="text"], select {
        font-size: 16px;
        padding: 0.75rem;
        border-radius: 0.75rem;
        width: 100%;
        max-width: 100%;
    }
    
    #targetPassage {
        min-height: 200px !important;
    }
    
    .reference-qa textarea {
        min-height: 120px !important;
    }
    
    /* 按钮调整 */
    .btn-primary, .btn-secondary, .btn-accent {
        padding: 0.75rem 1rem;
        font-size: 1rem;
        width: 100%;
        max-width: 200px;
        margin: 0 auto;
        display: block;
    }
    
    /* 参考题目控制按钮 */
    .reference-qa .flex {
        justify-content: center;
        gap: 0.5rem;
        margin-top: 1rem;
    }
    
    .reference-qa .w-14 {
        width: 2.5rem;
        height: 2.5rem;
    }
    
    /* 问题卡片 */
    .question-card {
        padding: 1rem;
        margin-bottom: 1rem;
    }
    
    .question-title {
        font-size: 1rem;
        padding: 0.75rem 1rem;
    }
    
    .answer-section, .steps-section {
        padding: 0.75rem;
        margin-top: 0.75rem;
    }
    
    /* 进度模态框 */
    .progress-ring {
        width: 80px;
        height: 80px;
    }
    
    #progressPercent {
        font-size: 1.25rem;
    }
    
    #timeRemaining {
        font-size: 1rem;
    }
    
    /* 结果页面 */
    .result-page .btn-primary, .result-page .btn-secondary {
        padding: 0.75rem 1rem;
        font-size: 0.875rem;
        margin: 0.25rem;
        width: auto;
        min-width: 120px;
    }
    
    /* 版权信息 */
    .copyright-footer {
        font-size: 10px;
        padding: 3px 6px;
    }
    
    /* 确保没有横向滚动 */
    .overflow-x-hidden {
        overflow-x: hidden;
    }
    
    /* 标签和标题调整 */
    label {
        font-size: 1rem;
        margin-bottom: 0.5rem;
    }
    
    /* 空间和边距优化 */
    .space-y-4 > * + * {
        margin-top: 0.75rem;
    }
    
    .space-y-6 > * + * {
        margin-top: 1rem;
    }
    
    .space-y-10 > * + * {
        margin-top: 1.5rem;
    }
    
    .mb-10 {
        margin-bottom: 1.5rem;
    }
    
    .mb-8 {
        margin-bottom: 1rem;
    }
    
    .mb-6 {
        margin-bottom: 0.75rem;
    }
    
    .py-12 {
        padding-top: 1.5rem;
        padding-bottom: 1.5rem;
    }
    
    .p-10 {
        padding: 1rem;
    }
    
    .p-8 {
        padding: 0.75rem;
    }
    
    .p-6 {
        padding: 0.5rem;
    }
    
    /* 自定义题型区域 */
    .col-span-full {
        grid-column: 1 / -1;
    }
    
    /* 长文写作配置 */
    .range-slider {
        width: 100%;
        margin: 0.5rem 0;
    }
    
    /* 实用文配置 */
    select option {
        font-size: 16px;
    }
}

/* 超小屏幕优化 (max-width: 480px) */
@media (max-width: 480px) {
    .container {
        padding: 0 0.5rem;
    }
    
    .floating-header h1 {
        font-size: 1.75rem;
    }
    
    .glass-card, .sidebar-card {
        padding: 0.75rem;
        border-radius: 1rem;
    }
    
    .question-type-selection {
        padding: 0.5rem;
    }
    
    .quantity-control {
        max-width: 100px;
    }
    
    .quantity-btn {
        width: 25px;
        height: 25px;
    }
    
    .quantity-input {
        width: 35px;
        font-size: 12px;
    }
    
    .floating-generate-btn {
        width: 45px;
        height: 45px;
        font-size: 16px;
        bottom: 10px;
        right: 10px;
    }
}

/* 横屏模式优化 */
@media (max-height: 500px) and (orientation: landscape) {
    .floating-header {
        position: relative;
    }
    
    .floating-header h1 {
        font-size: 1.5rem;
        margin-bottom: 0.25rem;
    }
    
    .py-12 {
        padding-top: 1rem;
        padding-bottom: 1rem;
    }
    
    .sidebar-card {
        position: static;
        margin-bottom: 1rem;
    }
}

/* 确保内容区域不会超出视口 */
@media (max-width: 767px) {
    .min-h-screen {
        min-height: 100vh;
        width: 100vw;
        max-width: 100vw;
        overflow-x: hidden;
    }
    
    body, html {
        overflow-x: hidden;
        max-width: 100vw;
    }
    
    * {
        max-width: 100%;
        word-wrap: break-word;
    }
}
    </style>
</head>
<body class="min-h-screen">
    <!-- 主要配置區域 -->
    <div id="mainContainer" class="min-h-screen">
        <!-- Header -->
        <header class="floating-header text-white py-10 shadow-2xl">
            <div class="container mx-auto px-6">
                <div class="text-center">
                    <h1 class="text-5xl md:text-6xl font-bold mb-4">
                        <i class="fas fa-graduation-cap mr-4"></i>題孳
                    </h1>
                </div>
            </div>
        </header>

        <!-- 主體內容區域 -->
        <div class="container mx-auto px-6 py-12">
            <div class="grid grid-cols-1 xl:grid-cols-3 gap-10 min-h-screen">
                
                <!-- 左側配置面板 -->
                <div class="xl:col-span-1">
                    <div class="sidebar-card p-10 mb-10 fade-in sticky top-32">
                        <h2 class="text-3xl font-bold mb-10 text-gray-800 flex items-center">
                            <i class="fas fa-sliders-h mr-4 text-teal-700"></i>配置選項
                        </h2>

                        <!-- 擬題範疇選擇 -->
                        <div class="mb-10">
                            <label class="block text-xl font-semibold text-gray-700 mb-6">
                                <i class="fas fa-list-alt mr-3"></i>選擇擬題範疇
                            </label>
                            <div class="space-y-4">
                                <div class="relative">
                                    <input type="radio" id="reading" name="generatorType" value="reading" class="sr-only" checked>
                                    <label for="reading" class="type-selector-btn block p-6 cursor-pointer text-center">
                                        <i class="fas fa-book-open text-4xl text-teal-600 mb-4 block"></i>
                                        <div class="font-bold text-xl text-gray-700">閱讀理解</div>
                                        <div class="text-base text-gray-500 mt-2">多元化題型設計</div>
                                    </label>
                                </div>
                                <div class="relative">
                                    <input type="radio" id="essay" name="generatorType" value="essay" class="sr-only">
                                    <label for="essay" class="type-selector-btn block p-6 cursor-pointer text-center">
                                        <i class="fas fa-pen-fancy text-4xl text-blue-600 mb-4 block"></i>
                                        <div class="font-bold text-xl text-gray-700">長文寫作</div>
                                        <div class="text-base text-gray-500 mt-2">創意思維訓練</div>
                                    </label>
                                </div>
                                <div class="relative">
                                    <input type="radio" id="practical" name="generatorType" value="practical" class="sr-only">
                                    <label for="practical" class="type-selector-btn block p-6 cursor-pointer text-center">
                                        <i class="fas fa-file-alt text-4xl text-green-600 mb-4 block"></i>
                                        <div class="font-bold text-xl text-gray-700">實用文體</div>
                                        <div class="text-base text-gray-500 mt-2">應用能力培養</div>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 右側主要配置區域 -->
                <div class="xl:col-span-2">
                    
                    <!-- 動態配置區域 -->
                    <div id="configContainer" class="space-y-10">
                        
                        <!-- 閱讀配置 -->
                        <div id="readingConfig" class="config-panel">
                            <div class="glass-card p-10 slide-up">
                                <h3 class="text-3xl font-bold mb-8 text-gray-800 flex items-center">
                                    <i class="fas fa-book mr-4 text-teal-600"></i>閱讀理解配置
                                </h3>

                                <!-- 題型選擇和數量設定 -->
                                <div class="mb-10">
                                    <label class="block text-xl font-semibold text-gray-700 mb-6">
                                        <i class="fas fa-tasks mr-3"></i>題型選擇及數量設定
                                    </label>
                                    <div class="question-type-container">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                            
<!-- 選擇題型 -->
<div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-teal-300 transition-all duration-300" data-type="選擇">
    <div class="flex items-center justify-between mb-4">
        <div class="flex items-center">
            <div class="toggle-switch mr-4" onclick="toggleQuestionType(this, '選擇')">
                <div class="toggle-slider"></div>
            </div>
            <div>
                <i class="fas fa-check-square text-orange-500 text-2xl mr-3"></i>
                <span class="font-bold text-lg">選擇</span>
            </div>
        </div>
    </div>
    <div class="quantity-control mt-4" style="display: none;">
        <button type="button" class="quantity-btn" onclick="adjustQuantity('選擇', -1)">
            <i class="fas fa-minus"></i>
        </button>
        <input type="number" id="quantity-選擇" min="1" max="10" value="1" class="quantity-input" readonly>
        <button type="button" class="quantity-btn" onclick="adjustQuantity('選擇', 1)">
            <i class="fas fa-plus"></i>
        </button>
    </div>
</div>


                                            <!-- 複述題型 -->
                                            <div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-teal-300 transition-all duration-300" data-type="複述">
                                                <div class="flex items-center justify-between mb-4">


                                                    <div class="flex items-center">
                                                        <div class="toggle-switch mr-4" onclick="toggleQuestionType(this, '複述')">
                                                            <div class="toggle-slider"></div>
                                                        </div>
                                                        <div>
                                                            <i class="fas fa-quote-left text-blue-500 text-2xl mr-3"></i>
                                                            <span class="font-bold text-lg">複述</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="quantity-control mt-4" style="display: none;">
                                                    <button type="button" class="quantity-btn" onclick="adjustQuantity('複述', -1)">
                                                        <i class="fas fa-minus"></i>
                                                    </button>
                                                    <input type="number" id="quantity-複述" min="1" max="10" value="1" class="quantity-input" readonly>
                                                    <button type="button" class="quantity-btn" onclick="adjustQuantity('複述', 1)">
                                                        <i class="fas fa-plus"></i>
                                                    </button>
                                                </div>
                                            </div>

                                            <!-- 分析題型 -->
                                            <div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-teal-300 transition-all duration-300" data-type="分析">
                                                <div class="flex items-center justify-between mb-4">
                                                    <div class="flex items-center">
                                                        <div class="toggle-switch mr-4" onclick="toggleQuestionType(this, '分析')">
                                                            <div class="toggle-slider"></div>
                                                        </div>
                                                        <div>
                                                            <i class="fas fa-search text-green-500 text-2xl mr-3"></i>
                                                            <span class="font-bold text-lg">分析</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="quantity-control mt-4" style="display: none;">
                                                    <button type="button" class="quantity-btn" onclick="adjustQuantity('分析', -1)">
                                                        <i class="fas fa-minus"></i>
                                                    </button>
                                                    <input type="number" id="quantity-分析" min="1" max="10" value="1" class="quantity-input" readonly>
                                                    <button type="button" class="quantity-btn" onclick="adjustQuantity('分析', 1)">
                                                        <i class="fas fa-plus"></i>
                                                    </button>
                                                </div>
                                            </div>

                                            <!-- 印證題型 -->
                                            <div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-teal-300 transition-all duration-300" data-type="印證">
                                                <div class="flex items-center justify-between mb-4">
                                                    <div class="flex items-center">
                                                        <div class="toggle-switch mr-4" onclick="toggleQuestionType(this, '印證')">
                                                            <div class="toggle-slider"></div>
                                                        </div>
                                                        <div>
                                                            <i class="fas fa-check-circle text-purple-500 text-2xl mr-3"></i>
                                                            <span class="font-bold text-lg">印證</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="quantity-control mt-4" style="display: none;">
                                                    <button type="button" class="quantity-btn" onclick="adjustQuantity('印證', -1)">
                                                        <i class="fas fa-minus"></i>
                                                    </button>
                                                    <input type="number" id="quantity-印證" min="1" max="10" value="1" class="quantity-input" readonly>
                                                    <button type="button" class="quantity-btn" onclick="adjustQuantity('印證', 1)">
                                                        <i class="fas fa-plus"></i>
                                                    </button>
                                                </div>
                                            </div>

                                            <!-- 闡明題型 -->
                                            <div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-teal-300 transition-all duration-300" data-type="闡明">
                                                <div class="flex items-center justify-between mb-4">
                                                    <div class="flex items-center">
                                                        <div class="toggle-switch mr-4" onclick="toggleQuestionType(this, '闡明')">
                                                            <div class="toggle-slider"></div>
                                                        </div>
                                                        <div>
                                                            <i class="fas fa-lightbulb text-yellow-500 text-2xl mr-3"></i>
                                                            <span class="font-bold text-lg">闡明</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="quantity-control mt-4" style="display: none;">
                                                    <button type="button" class="quantity-btn" onclick="adjustQuantity('闡明', -1)">
                                                        <i class="fas fa-minus"></i>
                                                    </button>
                                                    <input type="number" id="quantity-闡明" min="1" max="10" value="1" class="quantity-input" readonly>
                                                    <button type="button" class="quantity-btn" onclick="adjustQuantity('闡明', 1)">
                                                        <i class="fas fa-plus"></i>
                                                    </button>
                                                </div>
                                            </div>

                                            <!-- 意見題型 -->
                                            <div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-teal-300 transition-all duration-300" data-type="意見">
                                                <div class="flex items-center justify-between mb-4">
                                                    <div class="flex items-center">
                                                        <div class="toggle-switch mr-4" onclick="toggleQuestionType(this, '意見')">
                                                            <div class="toggle-slider"></div>
                                                        </div>
                                                        <div>
                                                            <i class="fas fa-comment text-red-500 text-2xl mr-3"></i>
                                                            <span class="font-bold text-lg">意見</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="quantity-control mt-4" style="display: none;">
                                                    <button type="button" class="quantity-btn" onclick="adjustQuantity('意見', -1)">
                                                        <i class="fas fa-minus"></i>
                                                    </button>
                                                    <input type="number" id="quantity-意見" min="1" max="10" value="1" class="quantity-input" readonly>
                                                    <button type="button" class="quantity-btn" onclick="adjustQuantity('意見', 1)">
                                                        <i class="fas fa-plus"></i>
                                                    </button>
                                                </div>
                                            </div>

                                            <!-- 比較題型 -->
                                            <div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-teal-300 transition-all duration-300" data-type="比較">
                                                <div class="flex items-center justify-between mb-4">
                                                    <div class="flex items-center">
                                                        <div class="toggle-switch mr-4" onclick="toggleQuestionType(this, '比較')">
                                                            <div class="toggle-slider"></div>
                                                        </div>
                                                        <div>
                                                            <i class="fas fa-balance-scale text-indigo-500 text-2xl mr-3"></i>
                                                            <span class="font-bold text-lg">比較</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="quantity-control mt-4" style="display: none;">
                                                    <button type="button" class="quantity-btn" onclick="adjustQuantity('比較', -1)">
                                                        <i class="fas fa-minus"></i>
                                                    </button>
                                                    <input type="number" id="quantity-比較" min="1" max="10" value="1" class="quantity-input" readonly>
                                                    <button type="button" class="quantity-btn" onclick="adjustQuantity('比較', 1)">
                                                        <i class="fas fa-plus"></i>
                                                    </button>
                                                </div>
                                            </div>

                                            <!-- 自訂題型 -->
                                            <div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-teal-300 transition-all duration-300 col-span-full" data-type="自訂">
                                                <div class="flex items-center justify-center">
                                                    <div class="toggle-switch mr-4" onclick="toggleQuestionType(this, '自訂')">
                                                        <div class="toggle-slider"></div>
                                                    </div>
                                                    <div>
                                                        <i class="fas fa-edit text-gray-500 text-2xl mr-3"></i>
                                                        <span class="font-bold text-lg">自訂</span>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>

                                <!-- 自訂模式的配置 -->
                                <div id="customReadingConfig" class="hidden">
                                    <div class="divider"></div>
                                    <div>
                                        <label class="block text-xl font-semibold text-gray-700 mb-6">
                                            <i class="fas fa-clipboard-list mr-3"></i>參考題目與答案設定
                                        </label>
                                        <div id="referenceQAList" class="space-y-6">
                                            <div class="reference-qa">
                                                <div class="flex items-start space-x-4 bg-white p-8 rounded-2xl border-3 border-teal-200">
                                                    <span class="flex-shrink-0 w-12 h-12 bg-gradient-to-r from-teal-500 to-blue-500 text-white rounded-full flex items-center justify-center font-bold text-lg question-number">1</span>
                                                    <textarea class="flex-1 p-6 border-2 border-teal-200 rounded-xl focus:border-teal-400 focus:ring-0 transition-colors duration-300 resize-vertical" placeholder="在此輸入參考題目與答案"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="flex justify-center space-x-6 mt-8">
                                            <button onclick="addReferenceQA()" class="w-14 h-14 bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 text-white rounded-full flex items-center justify-center transition-all duration-300 text-xl">
                                                <i class="fas fa-plus"></i>
                                            </button>
                                            <button onclick="removeReferenceQA()" class="w-14 h-14 bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 text-white rounded-full flex items-center justify-center transition-all duration-300 text-xl">
                                                <i class="fas fa-minus"></i>
                                            </button>
                                            <button onclick="clearReferenceQA()" class="w-14 h-14 bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white rounded-full flex items-center justify-center transition-all duration-300 text-xl">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!-- 擬題篇章選擇 -->
                                <div class="h-1 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full my-8"></div>
                                <div>
                                    <label class="block text-xl font-semibold text-gray-700 mb-6">
                                        <i class="fas fa-scroll mr-3"></i>擬題篇章選擇
                                    </label>
                                    
                                   <div class="text-library-selector mb-6">
    <div class="flex items-center justify-between mb-4">
        <h4 class="text-lg font-bold text-gray-800 flex items-center">
            <i class="fas fa-book-open mr-3 text-blue-600"></i>範文庫選擇
        </h4>
    </div>
    
    <div id="textLibraryGrid" class="text-library-grid">
        <!-- 範文庫內容將通過 JavaScript 生成 -->
    </div>
</div>
                                        
                                        <div id="textLibraryGrid" class="text-library-grid hidden">
                                            <!-- 範文庫內容將通過 JavaScript 生成 -->
                                        </div>
                                    </div>

                                    <!-- 自訂篇章輸入 -->
                                    <div>
                                        <label for="targetPassage" class="block text-lg font-semibold text-gray-700 mb-4">
                                            <i class="fas fa-edit mr-3"></i>自訂篇章內容
                                        </label>
                                        <textarea id="targetPassage" class="w-full p-8 border-3 border-teal-200 rounded-2xl focus:border-teal-400 focus:ring-0 transition-colors duration-300 resize-vertical bg-white" placeholder="在此輸入擬題篇章內容，或從上方範文庫選擇"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                     <!-- 長文配置 -->
<div id="essayConfig" class="config-panel hidden">
    <div class="glass-card p-10 slide-up">
        <h3 class="text-3xl font-bold mb-8 text-gray-800 flex items-center">
            <i class="fas fa-pen-fancy mr-4 text-blue-600"></i>長文寫作配置
        </h3>



<div class="mb-10">
    <label class="block text-xl font-semibold text-gray-700 mb-6">
        <i class="fas fa-tasks mr-3"></i>題目記錄管理
    </label>
</div>
<div class="flex space-x-4 items-center">
    <button onclick="showQuestionHistory()" class="btn-secondary px-6 py-3 text-base">
        <i class="fas fa-eye mr-2"></i> 紀錄
    </button>
    <button onclick="clearGeneratedQuestions()" class="btn-accent px-6 py-3 text-lg">
        <i class="fas fa-trash mr-3"></i> 清除
    </button>
   
</div>

  <div class="h-1 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full my-8"></div>

        <!-- 題型選擇和數量設定 -->
        <div class="mb-10">
            <label class="block text-xl font-semibold text-gray-700 mb-6">
                <i class="fas fa-tasks mr-3"></i>題型選擇及數量設定
            </label>
            <div class="question-type-container">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- 敘事題型 -->
                    <div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-blue-300 transition-all duration-300" data-type="敘事">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <div class="toggle-switch mr-4" onclick="toggleWritingQuestionType(this, '敘事')">
                                    <div class="toggle-slider"></div>
                                </div>
                                <div>
                                    <i class="fas fa-book-open text-orange-500 text-2xl mr-3"></i>
                                    <span class="font-bold text-lg">敘事</span>
                                </div>
                            </div>
                        </div>
                        <div class="quantity-control mt-4" style="display: none;">
                            <button type="button" class="quantity-btn" onclick="adjustQuantity('敘事', -1)">
                                <i class="fas fa-minus"></i>
                            </button>
                            <input type="number" id="quantity-敘事" min="1" max="10" value="1" class="quantity-input" readonly>
                            <button type="button" class="quantity-btn" onclick="adjustQuantity('敘事', 1)">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>

                    <!-- 開放題型 -->
                    <div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-blue-300 transition-all duration-300" data-type="開放">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <div class="toggle-switch mr-4" onclick="toggleWritingQuestionType(this, '開放')">
                                    <div class="toggle-slider"></div>
                                </div>
                                <div>
                                    <i class="fas fa-unlock text-green-500 text-2xl mr-3"></i>
                                    <span class="font-bold text-lg">開放</span>
                                </div>
                            </div>
                        </div>
                        <div class="quantity-control mt-4" style="display: none;">
                            <button type="button" class="quantity-btn" onclick="adjustQuantity('開放', -1)">
                                <i class="fas fa-minus"></i>
                            </button>
                            <input type="number" id="quantity-開放" min="1" max="10" value="1" class="quantity-input" readonly>
                            <button type="button" class="quantity-btn" onclick="adjustQuantity('開放', 1)">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>

                    <!-- 議論題型 -->
                    <div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-blue-300 transition-all duration-300" data-type="議論">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <div class="toggle-switch mr-4" onclick="toggleWritingQuestionType(this, '議論')">
                                    <div class="toggle-slider"></div>
                                </div>
                                <div>
                                    <i class="fas fa-balance-scale text-purple-500 text-2xl mr-3"></i>
                                    <span class="font-bold text-lg">議論</span>
                                </div>
                            </div>
                        </div>
                        <div class="quantity-control mt-4" style="display: none;">
                            <button type="button" class="quantity-btn" onclick="adjustQuantity('議論', -1)">
                                <i class="fas fa-minus"></i>
                            </button>
                            <input type="number" id="quantity-議論" min="1" max="10" value="1" class="quantity-input" readonly>
                            <button type="button" class="quantity-btn" onclick="adjustQuantity('議論', 1)">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>

                    <!-- 自訂題型 -->
                    <div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-blue-300 transition-all duration-300 col-span-full" data-type="自訂">
                        <div class="flex items-center justify-center">
                            <div class="toggle-switch mr-4" onclick="toggleWritingQuestionType(this, '自訂')">
                                <div class="toggle-slider"></div>
                            </div>
                            <div>
                                <i class="fas fa-edit text-gray-500 text-2xl mr-3"></i>
                                <span class="font-bold text-lg">自訂</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 自訂配置區域 -->
        <div id="customEssayConfig" class="hidden">
            <div class="h-1 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full my-8"></div>

            <label class="block text-xl font-semibold text-gray-700 mb-4">
                <i class="fas fa-clipboard-list mr-3"></i>請選擇自訂類型：
            </label>
            <div class="custom-essay-container mt-6 mb-8 p-6 bg-white border rounded-lg">
                <div class="flex space-x-4">
                    <div class="p-4 border rounded-lg flex-1">
                        <label class="flex items-center">
                            <input type="radio" name="customEssayType" value="narrative" class="mr-2">
                            <i class="fas fa-book-open mr-2"></i>敘事
                        </label>
                        <p class="text-sm text-gray-600 mt-2">敘事文著重於講述故事或事件。</p>
                    </div>
                    <div class="p-4 border rounded-lg flex-1">
                        <label class="flex items-center">
                            <input type="radio" name="customEssayType" value="argumentative" class="mr-2">
                            <i class="fas fa-gavel mr-2"></i>議論
                        </label>
                        <p class="text-sm text-gray-600 mt-2">議論文著重於表達觀點並提供論據支持。</p>
                    </div>
                </div>
            </div>

            <div class="h-1 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full my-8"></div>

            <div>
                <label class="block text-xl font-semibold text-gray-700 mb-6">
                    <i class="fas fa-clipboard-list mr-3"></i>參考題目設定
                </label>
                <div id="essayReferenceList" class="space-y-6">
                    <div class="essay-reference">
                        <div class="flex items-start space-x-4 bg-white p-8 rounded-2xl border-3 border-blue-200">
                            <span class="flex-shrink-0 w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-full flex items-center justify-center font-bold text-lg question-number">1</span>
                            <textarea class="flex-1 p-6 border-2 border-blue-200 rounded-xl focus:border-blue-400 focus:ring-0 transition-colors duration-300 resize-vertical" placeholder="在此輸入參考題目"></textarea>
                        </div>
                    </div>
                </div>
                <div class="flex justify-center space-x-6 mt-8">
                    <button onclick="addEssayReference()" class="w-14 h-14 bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 text-white rounded-full flex items-center justify-center transition-all duration-300 text-xl">
                        <i class="fas fa-plus"></i>
                    </button>
                    <button onclick="removeEssayReference()" class="w-14 h-14 bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 text-white rounded-full flex items-center justify-center transition-all duration-300 text-xl">
                        <i class="fas fa-minus"></i>
                    </button>
                    <button onclick="clearEssayReference()" class="w-14 h-14 bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white rounded-full flex items-center justify-center transition-all duration-300 text-xl">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

         

                        <!-- 實用文配置 -->
                        <div id="practicalConfig" class="config-panel hidden">
                            <div class="glass-card p-10 slide-up">
                                <h3 class="text-3xl font-bold mb-8 text-gray-800 flex items-center">
                                    <i class="fas fa-file-alt mr-4 text-green-600"></i>實用文體配置
                                </h3>
                                
                                <div class="space-y-10">
                                    <div>
                                        <label for="topicSelect" class="block text-xl font-semibold text-gray-700 mb-6">
                                            <i class="fas fa-tag mr-3"></i>主題選擇
                                        </label>
                                        <select id="topicSelect" class="w-full p-6 border-3 border-green-200 rounded-2xl focus:border-green-400 focus:ring-0 transition-colors duration-300 bg-white text-lg">
                                            <option value="random">隨機主題</option>
                                            <option value="custom">自訂主題</option>
                                            <option value="運動">運動</option>
                                            <option value="生涯規劃">生涯規劃</option>
                                            <option value="責任">責任</option>
                                            <option value="教育">教育</option>
                                            <option value="文化">文化</option>
                                            <option value="社會">社會</option>
                                            <option value="歷史">歷史</option>
                                            <option value="地理">地理</option>
                                            <option value="藝術">藝術</option>
                                            <option value="體育">體育</option>
                                            <option value="法律">法律</option>
                                            <option value="健康">健康</option>
                                            <option value="心理">心理</option>
                                            <option value="家庭">家庭</option>
                                            <option value="友誼">友誼</option>
                                            <option value="愛情">愛情</option>
                                            <option value="就業">就業</option>
                                            <option value="經濟">經濟</option>
                                            <option value="生態">生態</option>
                                            <option value="能源">能源</option>
                                            <option value="資源">資源</option>
                                            <option value="安全">安全</option>
                                            <option value="網路">網路</option>
                                            <option value="媒體">媒體</option>
                                            <option value="資訊">資訊</option>
                                            <option value="道德">道德</option>
                                            <option value="誠信">誠信</option>
                                            <option value="公平">公平</option>
                                            <option value="自由">自由</option>
                                            <option value="權利">權利</option>
                                            <option value="義務">義務</option>
                                            <option value="隱私">隱私</option>
                                            <option value="禮儀">禮儀</option>
                                            <option value="榜樣">榜樣</option>
                                            <option value="創新">創新</option>
                                            <option value="創業">創業</option>
                                            <option value="消費">消費</option>
                                            <option value="儲蓄">儲蓄</option>
                                            <option value="民族">民族</option>
                                            <option value="語言">語言</option>
                                            <option value="宗教">宗教</option>
                                            <option value="傳統">傳統</option>
                                            <option value="現代">現代</option>
                                            <option value="城鄉">城鄉</option>
                                            <option value="社區">社區</option>
                                            <option value="公益">公益</option>
                                            <option value="慈善">慈善</option>
                                            <option value="災害">災害</option>
                                            <option value="醫療">醫療</option>
                                            <option value="疾病">疾病</option>
                                            <option value="飲食">飲食</option>
                                            <option value="旅遊">旅遊</option>
                                            <option value="建築">建築</option>
                                            <option value="娛樂">娛樂</option>
                                            <option value="音樂">音樂</option>
                                            <option value="電影">電影</option>
                                            <option value="文學">文學</option>
                                            <option value="人口">人口</option>
                                            <option value="性別">性別</option>
                                            <option value="年齡">年齡</option>
                                            <option value="職業">職業</option>
                                            <option value="學業">學業</option>
                                            <option value="考試">考試</option>
                                            <option value="升學">升學</option>
                                            <option value="校園">校園</option>
                                            <option value="師生">師生</option>
                                            <option value="同學">同學</option>
                                            <option value="課外">課外</option>
                                            <option value="社團">社團</option>
                                            <option value="競賽">競賽</option>
                                            <option value="志願">志願</option>
                                            <option value="壓力">壓力</option>
                                            <option value="自律">自律</option>
                                            <option value="時間">時間</option>
                                            <option value="興趣">興趣</option>
                                            <option value="習慣">習慣</option>
                                            <option value="遊戲">遊戲</option>
                                            <option value="睡眠">睡眠</option>
                                            <option value="氣候">氣候</option>
                                            <option value="汙染">汙染</option>
                                            <option value="閱讀">閱讀</option>
                                        </select>
                                    </div>
                                    

<div id="customTopicGroup" class="hidden">
<label for="customTopic" class="block text-xl font-semibold text-gray-700 mb-6">
<i class="fas fa-edit mr-3"></i>自訂主題內容
</label>
<input type="text" id="customTopic" class="w-full p-6 border-3 border-green-200 rounded-2xl focus:border-green-400 focus:ring-0 transition-colors duration-300 bg-white text-lg" placeholder="請輸入自訂主題">
</div>



<!-- 在主題選擇代碼後添加 -->
<div class="mb-10">
    <label clas"block text-xl font-semibold text-gray-700 mb-6">
        <i class="fas fa-file-alt mr-3"></i>體裁選擇
    </label>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- 書信 -->
        <div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-green-300 transition-all duration-300" data-type="書信">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center">
                    <div class="toggle-switch mr-4" onclick="togglePracticalType(this, '書信')">
                        <div class="toggle-slider"></div>
                    </div>
                    <div>
                        <i class="fas fa-envelope text-blue-500 text-2xl mr-3"></i>
                        <span class="font-bold text-lg">書信</span>
                    </div>
                </div>
            </div>
            <div class="quantity-control mt-4" style="display: none;">
                <button type="button" class="quantity-btn" onclick="adjustPracticalQuantity('書信', -1)">
                    <i class="fas fa-minus"></i>
                </button>
                <input type="number" id="quantity-書信" min="1" max="10" value="1" class="quantity-input" readonly>
                <button type="button" class="quantity-btn" onclick="adjustPracticalQuantity('書信', 1)">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
        </div>
        <!-- 演講辭 -->
        <div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-green-300 transition-all duration-300" data-type="演講辭">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center">
                    <div class="toggle-switch mr-4" onclick="togglePracticalType(this, '演講辭')">
                        <div class="toggle-slider"></div>
                    </div>
                    <div>
                        <i class="fas fa-microphone text-red-500 text-2xl mr-3"></i>
                        <span class="font-bold text-lg">演講辭</span>
                    </div>
                </div>
            </div>
            <div class="quantity-control mt-4" style="display: none;">
                <button type="button" class="quantity-btn" onclick="adjustPracticalQuantity('演講辭', -1)">
                    <i class="fas fa-minus"></i>
                </button>
                <input type="number" id="quantity-演講辭" min="1" max="10" value="1" class="quantity-input" readonly>
                <button type="button" class="quantity-btn" onclick="adjustPracticalQuantity('演講辭', 1)">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
        </div>
        <!-- 報告 -->
        <div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-green-300 transition-all duration-300" data-type="報告">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center">
                    <div class="toggle-switch mr-4" onclick="togglePracticalType(this, '報告')">
                        <div class="toggle-slider"></div>
                    </div>
                    <div>
                        <i class="fas fa-file-alt text-purple-500 text-2xl mr-3"></i>
                        <span class="font-bold text-lg">報告</span>
                    </div>
                </div>
            </div>
            <div class="quantity-control mt-4" style="display: none;">
                <button type="button" class="quantity-btn" onclick="adjustPracticalQuantity('報告', -1)">
                    <i class="fas fa-minus"></i>
                </button>
                <input type="number" id="quantity-報告" min="1" max="10" value="1" class="quantity-input" readonly>
                <button type="button" class="quantity-btn" onclick="adjustPracticalQuantity('報告', 1)">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
        </div>
        <!-- 建議書 -->
        <div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-green-300 transition-all duration-300" data-type="建議書">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center">
                    <div class="toggle-switch mr-4" onclick="togglePracticalType(this, '建議書')">
                        <div class="toggle-slider"></div>
                    </div>
                    <div>
                        <i class="fas fa-lightbulb text-yellow-500 text-2xl mr-3"></i>
                        <span class="font-bold text-lg">建議書</span>
                    </div>
                </div>
            </div>
            <div class="quantity-control mt-4" style="display: none;">
                <button type="button" class="quantity-btn" onclick="adjustPracticalQuantity('建議書', -1)">
                    <i class="fas fa-minus"></i>
                </button>
                <input type="number" id="quantity-建議書" min="1" max="10" value="1" class="quantity-input" readonly>
                <button type="button" class="quantity-btn" onclick="adjustPracticalQuantity('建議書', 1)">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
        </div>
        <!-- 評論 -->
        <div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-green-300 transition-all duration-300" data-type="評論">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center">
                    <div class="toggle-switch mr-4" onclick="togglePracticalType(this, '評論')">
                        <div class="toggle-slider"></div>
                    </div>
                    <div>
                        <i class="fas fa-comment-dots text-orange-500 text-2xl mr-3"></i>
                        <span class="font-bold text-lg">評論</span>
                    </div>
                </div>
            </div>
            <div class="quantity-control mt-4" style="display: none;">
                <button type="button" class="quantity-btn" onclick="adjustPracticalQuantity('評論', -1)">
                    <i class="fas fa-minus"></i>
                </button>
                <input type="number" id="quantity-評論" min="1" max="10" value="1" class="quantity-input" readonly>
                <button type="button" class="quantity-btn" onclick="adjustPracticalQuantity('評論', 1)">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
        </div>
        <!-- 專題文章 -->
        <div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-green-300 transition-all duration-300" data-type="專題文章">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center">
                    <div class="toggle-switch mr-4" onclick="togglePracticalType(this, '專題文章')">
                        <div class="toggle-slider"></div>
                    </div>
                    <div>
                        <i class="fas fa-newspaper text-green-500 text-2xl mr-3"></i>
                        <span class="font-bold text-lg">專題文章</span>
                    </div>
                </div>
            </div>
            <div class="quantity-control mt-4" style="display: none;">
                <button type="button" class="quantity-btn" onclick="adjustPracticalQuantity('專題文章', -1)">
                    <i class="fas fa-minus"></i>
                </button>
                <input type="number" id="quantity-專題文章" min="1" max="10" value="1" class="quantity-input" readonly>
                <button type="button" class="quantity-btn" onclick="adjustPracticalQuantity('專題文章', 1)">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
        </div>
        <!-- 自訂 -->
        <div class="question-type-selection bg-white p-6 rounded-2xl border-3 border-transparent hover:border-green-300 transition-all duration-300" data-type="自訂">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center">
                    <div class="toggle-switch mr-4" onclick="togglePracticalType(this, '自訂')">
                        <div class="toggle-slider"></div>
                    </div>
                    <div>
                        <i class="fas fa-edit text-gray-500 text-2xl mr-3"></i>
                        <span class="font-bold text-lg">自訂</span>
                    </div>
                </div>
            </div>
            <div class="quantity-control mt-4" style="display: none;">
                <button type="button" class="quantity-btn" onclick="adjustPracticalQuantity('自訂', -1)">
                    <i class="fas fa-minus"></i>
                </button>
                <input type="number" id="quantity-自訂" min="1" max="10" value="1" class="quantity-input" readonly>
                <button type="button" class="quantity-btn" onclick="adjustPracticalQuantity('自訂', 1)">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
        </div>
    </div>
</div>

<div id="customPracticalConfig" class="hidden">
    <div class="divider"></div>
    <div>
        <label class="block text-xl font-semibold text-gray-700 mb-6">
            <i class="fas fa-clipboard-list mr-3"></i>自訂參考內容
        </label>
        <div class="space-y-6">
            <div>
                <label for="customRefQuestion" class="block text-lg font-medium text-gray-700 mb-2">參考題目</label>
                <textarea id="customRefQuestion" class="w-full p-4 border-2 border-gray-300 rounded-lg focus:border-green-500 focus:ring-0" rows="4" placeholder="輸入自訂的參考題目"></textarea>
            </div>
            <div>
                <label for="customRefMaterial1" class="block text-lg font-medium text-gray-700 mb-2">參考資料一</label>
                <textarea id="customRefMaterial1" class="w-full p-4 border-2 border-gray-300 rounded-lg focus:border-green-500 focus:ring-0" rows="4" placeholder="輸入自訂的參考資料一"></textarea>
            </div>
            <div>
                <label for="customRefMaterial2" class="block text-lg font-medium text-gray-700 mb-2">參考資料二</label>
                <textarea id="customRefMaterial2" class="w-full p-4 border-2 border-gray-300 rounded-lg focus:border-green-500 focus:ring-0" rows="4" placeholder="輸入自訂的參考資料二"></textarea>
            </div>
        </div>
    </div>
</div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 浮動生成按鈕 -->
    <button id="generateBtn" class="floating-generate-btn" title="開始智能生成">
        <i class="fas fa-rocket"></i>
    </button>

    <!-- 進度顯示區域 -->
    <div id="progressModal" class="fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center hidden">
    <div class="glass-card p-12 max-w-2xl w-full mx-6 text-center fade-in">
        <div class="mb-10">
            <div class="relative w-32 h-8 mx-auto mb-8">
                <div class="progress-bar-container w-full h-full bg-gray-200 rounded-full overflow-hidden">
                    <div id="progressBar" class="progress-bar h-full bg-gradient-to-r from-teal-400 to-blue-500" style="width: 0%;"></div>
                </div>
                <div class="absolute inset-0 flex items-center justify-center">
                    <span id="progressPercent" class="text-2xl font-bold" style="color: var(--primary-teal);">0%</span>
                </div>
            </div>
            <h3 class="text-3xl font-bold text-gray-800 mb-4">AI擬題中......</h3>
        </div>
        <div class="text-center">
            <div id="timeRemaining" class="text-3xl font-bold" style="color: var(--primary-blue);">--</div>
            <div class="text-gray-500 mt-2 font-semibold">剩餘時間</div>
        </div>
    </div>
</div>

    <!-- 結果顯示頁面 -->
    <div id="resultContainer" class="hidden result-page">
    <div class="min-h-screen py-12">
        <div class="container mx-auto px-6">
            <!-- 操作按鈕 -->
            <div class="text-center mb-12 slide-up">
                <button onclick="goBack()" class="btn-secondary px-12 py-5 rounded-2xl font-bold mr-8 text-xl transform hover:-translate-y-2 transition-all duration-300">
                    <i class="fas fa-arrow-left mr-4"></i>返回
                </button>
                <button onclick="regenerate()" class="btn-primary px-12 py-5 rounded-2xl font-bold text-xl transform hover:-translate-y-2 transition-all duration-300">
                    <i class="fas fa-redo mr-4"></i>重新生成
                </button>
                <!-- 新增的輸出PDF按鈕 -->
                <button onclick="exportToPDF()" class="btn-pdf px-12 py-5 rounded-2xl font-bold text-xl transform hover:-translate-y-2 transition-all duration-300 ml-8">
    <i class="fas fa-file-pdf mr-4"></i>PDF
</button>
            </div>
            <!-- 題目內容 -->
            <div id="questionsDisplay" class="space-y-10 max-w-6xl mx-auto">
                <!-- 題目會在這裡動態生成 -->
            </div>
        </div>
    </div>
</div>

 

    <script>


window.addEventListener('scroll', function() {
    const header = document.querySelector('.floating-header');
    if (window.scrollY > 0) {
        header.style.display = 'none'; /* 滾動時隱藏 */
    } else {
        header.style.display = 'block'; /* 最上方時顯示 */
    }
});


var selectedPracticalTypes = new Set();


async function exportToPDF() {
    const { jsPDF } = window.jspdf;
    
    const doc = new jsPDF({
        orientation: 'portrait',
        unit: 'px',
        format: 'a4', // 初始格式，後續會動態調整
        compress: false
    });

    const questionsContainer = document.getElementById('questionsDisplay');
    const questionCards = questionsContainer.querySelectorAll('.question-card');
    
    if (questionCards.length === 0) {
        alert('沒有可輸出的題目內容');
        return;
    }

    // 進度提示
    const progressDiv = document.createElement('div');
    progressDiv.style.cssText = `
        position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
        background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        z-index: 10000; font-size: 18px; text-align: center; min-width: 300px;
    `;
    progressDiv.innerHTML = `
        <div>正在生成PDF...</div>
        <div id="pdfProgress" style="margin-top: 10px; font-size: 14px; color: #666;">準備中...</div>
    `;
    document.body.appendChild(progressDiv);

    try {
        // 檢測是否為手機設備
        const isMobile = window.innerWidth <= 768;
        const MARGIN = 20; // 統一邊距

        for (let i = 0; i < questionCards.length; i++) {
            const card = questionCards[i];
            document.getElementById('pdfProgress').textContent = 
                `正在處理第 ${i + 1} 題，共 ${questionCards.length} 題...`;

            // 保存原始樣式並強化文字
            const originalStyles = enhanceTextForPDF(card);
            
            // 設置用於測量的臨時樣式
            const originalStyle = card.getAttribute('style') || '';
            card.style.cssText = `
                position: relative !important;
                width: auto !important;
                height: auto !important;
                margin: 0 !important;
                padding: ${MARGIN}px !important;
                background: #ffffff !important;
                color: #000000 !important;
                border: none !important;
                max-width: none !important;
                font-size: ${isMobile ? '16px' : '14px'} !important;
                line-height: 1.6 !important;
            `;

            // 等待樣式應用
            await new Promise(resolve => setTimeout(resolve, 100));

            // 測量內容實際尺寸
            const tempCanvas = await html2canvas(card, {
                scale: 2,
                useCORS: true,
                backgroundColor: '#ffffff',
                logging: false,
                onclone: function(clonedDoc) {
                    const clonedCard = clonedDoc.querySelector(`[data-card-index="${i}"]`) || 
                                     clonedDoc.querySelectorAll('.question-card')[i];
                    if (clonedCard) {
                        enhanceClonedElementForPDF(clonedCard);
                    }
                }
            });

            // 還原樣式
            card.setAttribute('style', originalStyle);
            restoreOriginalStyles(card, originalStyles);

            // 計算最佳頁面尺寸
            const contentWidth = tempCanvas.width / 2; // 除以scale
            const contentHeight = tempCanvas.height / 2;
            
            // 動態計算頁面尺寸，確保內容充滿頁面
            let pageWidth, pageHeight;
            
            if (isMobile) {
                // 手機版：根據內容動態調整，但保持合理比例
                const minWidth = 400;
                const maxWidth = 600;
                const minHeight = 500;
                const maxHeight = 800;
                
                pageWidth = Math.max(minWidth, Math.min(maxWidth, contentWidth + MARGIN * 2));
                pageHeight = Math.max(minHeight, Math.min(maxHeight, contentHeight + MARGIN * 2));
                
                // 如果內容很長，適當增加高度
                if (contentHeight > 400) {
                    pageHeight = Math.min(maxHeight, contentHeight + MARGIN * 2);
                }
            } else {
                // 桌面版：使用標準A4或根據內容調整
                pageWidth = Math.max(595, contentWidth + MARGIN * 2); // A4寬度為595px
                pageHeight = Math.max(842, contentHeight + MARGIN * 2); // A4高度為842px
            }

            // 為每頁設置頁面格式
            if (i > 0) {
                doc.addPage([pageWidth, pageHeight], 'portrait');
            } else {
                // 設置第一頁的尺寸
                doc.internal.pageSize.width = pageWidth;
                doc.internal.pageSize.height = pageHeight;
            }

            // 重新設置卡片樣式以適應計算出的頁面尺寸
            card.style.cssText = `
                position: relative !important;
                width: ${pageWidth - MARGIN * 2}px !important;
                height: auto !important;
                margin: 0 !important;
                padding: ${MARGIN}px !important;
                background: #ffffff !important;
                color: #000000 !important;
                border: none !important;
                font-size: ${isMobile ? '16px' : '14px'} !important;
                line-height: 1.6 !important;
                box-sizing: border-box !important;
            `;

            // 再次強化文字
            enhanceTextForPDF(card);
            
            // 等待樣式應用
            await new Promise(resolve => setTimeout(resolve, 100));

            // 生成最終的畫布
            const finalCanvas = await html2canvas(card, {
                scale: 3, // 高解析度
                useCORS: true,
                backgroundColor: '#ffffff',
                width: pageWidth,
                height: Math.min(pageHeight, card.scrollHeight + MARGIN * 2),
                logging: false,
                onclone: function(clonedDoc) {
                    const clonedCard = clonedDoc.querySelector(`[data-card-index="${i}"]`) || 
                                     clonedDoc.querySelectorAll('.question-card')[i];
                    if (clonedCard) {
                        enhanceClonedElementForPDF(clonedCard);
                    }
                }
            });

            // 還原原始樣式
            card.setAttribute('style', originalStyle);
            restoreOriginalStyles(card, originalStyles);

            // 計算圖片在頁面中的尺寸（充滿頁面，保留少量邊距）
            const imgWidth = pageWidth - MARGIN * 2;
            const imgHeight = (finalCanvas.height * imgWidth) / finalCanvas.width;

            // 添加圖片到PDF
            const imgData = finalCanvas.toDataURL('image/png', 1.0);
            doc.addImage(imgData, 'PNG', MARGIN, MARGIN, imgWidth, Math.min(imgHeight, pageHeight - MARGIN * 2));
            
            // 為下次循環設置卡片索引
            card.setAttribute('data-card-index', i);
        }

        document.body.removeChild(progressDiv);
        doc.save('generated_questions.pdf');
        
    } catch (error) {
        console.error('PDF生成失敗：', error);
        if (document.body.contains(progressDiv)) {
            document.body.removeChild(progressDiv);
        }
        alert('PDF生成失敗，請稍後重試');
    }
}

// 修訂：強化PDF轉換前的文字樣式函數
function enhanceTextForPDF(element) {
    const originalStyles = new Map();
    
    // 強化所有文字元素的顏色和對比度
    const textElements = element.querySelectorAll('*');
    textElements.forEach((el, index) => {
        const computedStyle = window.getComputedStyle(el);
        const originalColor = computedStyle.color;
        const originalBackgroundColor = computedStyle.backgroundColor;
        
        // 儲存原始樣式
        originalStyles.set(index, {
            element: el,
            color: el.style.color,
            backgroundColor: el.style.backgroundColor,
            opacity: el.style.opacity,
            filter: el.style.filter
        });
        
        // 強化文字顏色為純黑色
        el.style.color = '#000000 !important';
        el.style.backgroundColor = 'transparent !important';
        el.style.opacity = '1 !important';
        el.style.filter = 'none !important';
    });
    
    return originalStyles;
}

// 修訂：處理克隆元素的函數
function enhanceClonedElementForPDF(clonedElement) {
    // 為克隆元素添加強制樣式
    const style = document.createElement('style');
    style.textContent = `
        * {
            color: #000000 !important;
            background-color: transparent !important;
            opacity: 1 !important;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }
        .question-card {
            background: #ffffff !important;
            border: none !important;
            box-shadow: none !important;
        }
        .question-title, .answer-section, .steps-section {
            background: #f8f9fa !important;
            border: 1px solid #dee2e6 !important;
        }
    `;
    
    if (clonedElement.ownerDocument && clonedElement.ownerDocument.head) {
        clonedElement.ownerDocument.head.appendChild(style);
    }
}

// 修訂：還原原始樣式的函數
function restoreOriginalStyles(element, originalStyles) {
    if (originalStyles && originalStyles.size > 0) {
        originalStyles.forEach((styleData, index) => {
            const el = styleData.element;
            if (el && el.style) {
                el.style.color = styleData.color;
                el.style.backgroundColor = styleData.backgroundColor;
                el.style.opacity = styleData.opacity;
                el.style.filter = styleData.filter;
            }
        });
    }
}


// 修訂：新增解析RGBA顏色的輔助函數
function parseRGBA(colorStr) {
    const match = colorStr.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);
    if (match) {
        return {
            r: parseInt(match[1]),
            g: parseInt(match[2]),
            b: parseInt(match[3]),
            a: match[4] ? parseFloat(match[4]) : 1
        };
    }
    return null;
}


function toggleAnswer(button) {
    const answerContent = button.nextElementSibling;
    const icon = button.querySelector('i');
    
    if (answerContent.classList.contains('hidden')) {
        answerContent.classList.remove('hidden');
        button.innerHTML = '<i class="fas fa-eye-slash mr-4"></i>隱藏詳細答案';
        // 修訂：移除動態顏色變更，使用固定深色
        button.style.color = '#2d3748';
        answerContent.style.maxHeight = answerContent.scrollHeight + 'px';
    } else {
        answerContent.classList.add('hidden');
        button.innerHTML = '<i class="fas fa-eye mr-4"></i>顯示詳細答案';
        // 修訂：移除動態顏色變更，使用固定深色
        button.style.color = '#2d3748';
        answerContent.style.maxHeight = '0';
    }
}




function togglePracticalType(toggleElement, practicalType) {
    const isActive = toggleElement.classList.contains('active');
    const quantityControl = toggleElement.closest('.question-type-selection').querySelector('.quantity-control');
    
    if (isActive) {
        toggleElement.classList.remove('active');
        selectedPracticalTypes.delete(practicalType);
        if (quantityControl) {
            quantityControl.style.display = 'none';
        }
        if (practicalType === '自訂') {
            document.getElementById('customPracticalConfig').classList.add('hidden');
        }
    } else {
        toggleElement.classList.add('active');
        selectedPracticalTypes.add(practicalType);
        if (quantityControl) {
            quantityControl.style.display = 'flex';
        }
        if (practicalType === '自訂') {
            document.getElementById('customPracticalConfig').classList.remove('hidden');
        }
    }
}

function adjustPracticalQuantity(practicalType, delta) {
    const input = document.getElementById(`quantity-${practicalType}`);
    if (input) {
        let currentValue = parseInt(input.value) || 1;
        currentValue += delta;
        if (currentValue < 1) currentValue = 1;
        if (currentValue > 10) currentValue = 10;
        input.value = currentValue;
    }
}


        // 範文庫資料
        const textLibrary = {
            "version": "1.0",
            "created_date": "2025-01-12",
            "description": "DSE中文範文庫",
            "texts": [
                {
                    "id": 1,
                    "title": "廉頗藺相如列傳",
                    "author": "司馬遷",
                    "category": "文言文",
                    "type": "史傳",
                    "length": "長篇",
                    "content": `　　廉頗者，趙之良將也。趙惠文王十六年 ，廉頗為趙將伐齊 ，大破之，取陽晉，拜為上卿 ，以勇氣聞於諸侯。藺相如者，趙人也，為趙宦者令繆賢舍人 。

　　趙惠文王時，得楚和氏璧 。秦昭王聞之，使人遺 趙王書，願以十五城請易璧。趙王與大將軍廉頗諸大臣謀：欲予秦，秦城恐不可得，徒見欺 ；欲勿予，即患秦兵之來。計未定，求人可使報秦者 ，未得。

　　宦者令繆賢曰：「臣舍人藺相如可使 。」王問：「何以知之？」對曰：「臣嘗有罪，竊計欲亡走燕 ，臣舍人相如止臣，曰：『君何以知燕王？』臣語 曰：『臣嘗從大王與燕王會境上 ，燕王私握臣手，曰「願結友。」以此知之，故欲往。』相如謂臣曰：『夫趙彊而燕弱，而君幸於趙王 ，故燕王欲結於君。今君乃亡趙走燕，燕畏趙，其勢必不敢留君，而束君歸趙矣 。君不如肉袒伏斧質請罪 ，則幸得脫矣。』臣從其計，大王亦幸赦臣。臣竊以為其人勇士，有智謀，宜可使。」

　　於是王召見，問藺相如曰：「秦王以十五城請易寡人之璧，可予不 ？」相如曰：「秦彊而趙弱，不可不許。」王曰：「取吾璧，不予我城，奈何？」相如曰：「秦以城求璧而趙不許，曲 在趙；趙予璧而秦不予趙城，曲在秦。均之二策 ，寧許以負秦曲 。」王曰：「誰可使者？」相如曰：「王必無人 ，臣願奉璧往使 。城入趙而璧留秦；城不入，臣請完璧歸趙 。」趙王於是遂遣相如奉璧西入秦。

　　秦王坐章台見相如 ，相如奉璧奏秦王 。秦王大喜，傳以示美人及左右 ，左右皆呼萬歲。相如視秦王無意償趙城，乃前曰：「璧有瑕 ，請指示王。」王授璧，相如因持璧，卻立 ，倚柱，怒髮上衝冠 ，謂秦王曰：「大王欲得璧，使人發書至趙王，趙王悉召羣臣議，皆曰：『秦貪，負其彊 ，以空言求璧，償城恐不可得』。議不欲予秦璧。臣以為布衣之交尚不相欺 ，況大國乎！且以一璧之故逆彊秦之驩 ，不可。於是趙王乃齋戒 五日，使臣奉璧，拜送書於庭 。何者？嚴大國之威以修敬也 。今臣至，大王見臣列觀 ，禮節甚倨 ；得璧，傳之美人，以戲弄臣。臣觀大王無意償趙王城邑，故臣復取璧。大王必欲急 臣，臣頭今與璧俱碎於柱矣！」

　　相如持其璧睨 柱，欲以擊柱。秦王恐其破璧，乃辭謝固請 ，召有司案圖 ，指從此以往十五都予趙 。

　　相如度秦王特以詐佯為予趙城 ，實不可得，乃謂秦王曰：「和氏璧，天下所共傳寶也 。趙王恐，不敢不獻。趙王送璧時，齋戒五日，今大王亦宜齋戒五日，設九賓於廷 ，臣乃敢上璧。」秦王度之，終不可彊奪 ，遂許齋五日，舍相如廣成傳 。

　　相如度秦王雖齋，決負約不償城，乃使其從者衣褐 ，懷其璧，從徑道 亡 ，歸璧於趙。

　　秦王齋五日後，乃設九賓禮於廷，引趙使者藺相如。相如至，謂秦王曰：「秦自繆公 以來二十餘君，未嘗有堅明約束者也 。臣誠恐見欺於王而負趙，故令人持璧歸，間至趙矣 。且秦彊而趙弱，大王遣一介 之使至趙，趙立奉璧來；今以秦之彊而先割十五都予趙，趙豈敢留璧而得罪於大王乎？臣知欺大王之罪當誅，臣請就湯鑊 。唯大王與羣臣孰計議之 ！」

　　秦王與羣臣相視而嘻 。左右或欲引相如去 ，秦王因 曰：「今殺相如，終不能得璧也，而絕秦趙之驩，不如因而厚遇之 ，使歸趙，趙王豈以一璧之故欺秦邪 ！」卒廷見相如 ，畢禮而歸之。

　　相如既歸，趙王以為賢大夫，使不辱於諸侯 ，拜相如為上大夫 。

　　秦亦不以城予趙，趙亦終不予秦璧。

　　其後秦伐趙，拔石城。明年，復攻趙，殺二萬人。

　　秦王使使者告趙王，欲與王為好會於西河外澠池 。趙王畏秦，欲毋行 。廉頗、藺相如計曰：「王不行，示趙弱且怯也。」趙王遂行，相如從。廉頗送至境，與王訣曰 ：「王行，度道里會遇之禮畢 ，還，不過三十日。三十日不還，則請立太子為王，以絕秦望。」王許之，遂與秦王會澠池。

　　秦王飲酒酣 ，曰：「寡人竊聞趙王好音，請奏瑟 。」趙王鼓瑟。秦御史前書曰 ：「某年月日，秦王與趙王會飲，令趙王鼓瑟。」藺相如前曰：「趙王竊聞秦王善為秦聲，請奏盆缻秦王 ，以相娛樂。」秦王怒，不許。於是相如前進缻，因跪請秦王。秦王不肯擊缻。相如曰：「五步之內，相如請得以頸血濺大王矣 ！」左右欲刃相如 ，相如張目叱之，左右皆靡 。於是秦王不懌 ，為一擊缻。相如顧 召趙御史書曰：「某年月日，秦王為趙王擊缻。」秦之羣臣曰：「請以趙十五城為秦王壽 。」藺相如亦曰：「請以秦之咸陽 為趙王壽。」

　　秦王竟酒 ，終不能加勝於趙。趙亦盛設兵以待秦，秦不敢動。

　　既罷歸國，以相如功大，拜為上卿，位在廉頗之右。

　　廉頗曰：「我為趙將，有攻城野戰之大功，而藺相如徒以口舌為勞 ，而位居我上，且相如素賤人 ，吾羞，不忍為之下 。」宣言曰：「我見相如，必辱之。」相如聞，不肯與會。相如每朝時，常稱病，不欲與廉頗爭列 。已而 相如出，望見廉頗，相如引車避匿 。

　　於是舍人相與諫曰：「臣所以去親戚而事君者 ，徒慕君之高義也 。今君與廉頗同列，廉君宣惡言而君畏匿之，恐懼殊甚，且庸人尚羞之，況於將相乎！臣等不肖 ，請辭去。」藺相如固止之，曰：「公之視廉將軍孰與秦王 ？」曰：「不若也 。」相如曰：「夫以秦王之威，而相如廷叱之，辱其羣臣，相如雖駑 ，獨畏廉將軍哉？顧 吾念之，彊秦之所以不敢加兵於趙者，徒以吾兩人在也。今兩虎共鬥，其勢不俱生 。吾所以為此者，以先國家之急而後私讎也 。」

　　廉頗聞之，肉袒 負荊 ，因賓客至藺相如門謝罪 。曰：「鄙賤之人，不知將軍寬之至此也 。」

　　卒相與驩，為刎頸之交 。`
                },
                {
                    "id": 2,
                    "title": "山居秋暝",
                    "author": "王維",
                    "category": "詩歌",
                    "type": "五言律詩",
                    "length": "短篇",
                    "content": `空山新雨後 ，天氣晚來秋。
明月松間照，清泉石上流。
竹喧歸浣女，蓮動下漁舟。 
隨意春芳歇 ，王孫自可留 。`
                },
                {
                    "id": 3,
                    "title": "月下獨酌",
                    "author": "李白",
                    "category": "詩歌",
                    "type": "五言古詩",
                    "length": "短篇",
                    "content": `花間一壺酒，獨酌無相親 。 
舉杯邀明月，對影成三人 。
月既不解 飲，影徒 隨我身。
暫伴月將 影，行樂須及春 。 
我歌月徘徊 ，我舞影零亂 。 
醒時同交歡 ，醉後各分散 。
永結無情遊 ，相期邈雲漢 。`
                },
                {
                    "id": 4,
                    "title": "登樓",
                    "author": "杜甫",
                    "category": "詩歌",
                    "type": "七言律詩",
                    "length": "短篇",
                    "content": `花近高樓傷客心， 萬方多難此登臨。 
錦江春色來天地， 玉壘浮雲變古今。 
北極朝廷終不改， 西山寇盜莫相侵。 
可憐後主還祠廟， 日暮聊為〈梁甫吟〉。`
                },
                {
                    "id": 5,
                    "title": "師說",
                    "author": "韓愈",
                    "category": "文言文",
                    "type": "論說文",
                    "length": "中篇",
                    "content": `　　古之學者必有師。師者，所以傳道  、受業 、解惑也。人非生而知之者 ，孰能無惑？惑而不從師，其為惑也終不解矣。

　　生乎吾前，其聞道 也固 先乎吾，吾從而師之；生乎吾後，其聞道也亦先乎吾，吾從而師之。吾師道也，夫庸知 其年之先後生於吾乎？是故無貴無賤，無長無少，道之所存，師之所存也。

　　嗟乎！師道之不傳也久矣！欲人之無惑也難矣！古之聖人，其出人也遠矣，猶且從師而問焉；今之眾人，其下聖人也亦遠矣，而恥學於師；是故聖益聖，愚益愚，聖人之所以為聖，愚人之所以為愚，其 皆出於此乎？

　　愛其子，擇師而教之，於其身也，則恥師焉，惑矣！彼童子之師，授之書而習其句讀 者也，非吾所謂傳其道，解其惑者也。句讀之不知，惑之不解，或師焉，或不焉，小學而大遺，吾未見其明也。

　　巫醫 、樂師，百工之人，不恥相師；士大夫之族，曰師、曰弟子云者，則群聚而笑之，問之，則曰：「彼與彼年相若也，道相似也。位卑則足羞，官盛則近諛 。」嗚呼！師道之不復可知矣。巫、醫、樂師、百工之人，君子 不齒 ，今其智乃反不能及，其可怪也歟！

　　聖人無常師 ，孔子師郯子 、萇弘 、師襄 、老聃 。郯子之徒，其賢不及孔子。孔子曰：「三人行，則必有我師。」 是故弟子不必不如師，師不必賢於弟子，聞道有先後，術業有專攻，如是而已。

　　李氏子蟠 ，年十七，好古文，六藝 經傳，皆通習之；不拘於時，學於余，余嘉其能行古道，作〈師說〉以貽 之。`
                },
                {
                    "id": 6,
                    "title": "岳陽樓記",
                    "author": "范仲淹",
                    "category": "文言文",
                    "type": "記敘文",
                    "length": "中篇",
                    "content": `　　慶曆四年春 ，滕子京 謫守巴陵郡 。越 明年，政通人和，百廢具 興。乃重修岳陽樓，增其舊制，刻唐賢、今人詩賦於其上；屬 予作文以記之。

　　予觀夫巴陵勝狀 ，在洞庭一湖。銜遠山，吞長江，浩浩湯湯 ，橫無際涯；朝暉夕陰，氣象萬千。此則岳陽樓之大觀也，前人之述備 矣。然則北通巫峽 ，南極瀟湘 ，遷客騷人 ，多會於此，覽物之情，得無異乎？

　　若夫霪雨霏霏 ，連月不開；陰風怒號 ，濁浪排空；日星隱耀，山岳潛形；商旅不行，檣傾楫摧 ；薄暮冥冥 ，虎嘯猿啼。登斯樓也，則有去國 懷鄉，憂讒畏譏，滿目蕭然 ，感極而悲者矣。

　　至若春和景明 ，波瀾不驚 ，上下天光，一碧萬頃；沙鷗翔集 ，錦鱗游泳，岸芷汀蘭 ，郁郁青青 。而或長煙一空 ，皓月千里，浮光躍金 ，靜影沉璧 ；漁歌互答，此樂何極！登斯樓也，則有心曠神怡 ，寵辱 皆忘，把酒臨風 ，其喜洋洋 者矣。

　　嗟夫！予嘗求古仁人之心，或異二者之為 。何哉？不以物喜，不以己悲 。居廟堂之高 ，則憂其民；處江湖之遠 ，則憂其君。是進亦憂，退亦憂，然則何時而樂耶？其必曰：「先天下之憂而憂，後天下之樂而樂」歟！噫！微斯人 ，吾誰與歸 ！`
                },
                {
                    "id": 7,
                    "title": "始得西山宴遊記",
                    "author": "柳宗元",
                    "category": "文言文",
                    "type": "記敘文",
                    "length": "中篇",
                    "content": `　　自余為僇人 ，居是州，恒惴慄 。其隙也 ，則施施 而行，漫漫 而遊。日與其徒 上高山，入深林，窮迴溪 ，幽泉 怪石，無遠不到。到則披草 而坐，傾壺而醉。醉則更相枕 以臥，臥而夢。意有所極 ，夢亦同趣 。覺 而起，起而歸。以為凡是州之山有異態者，皆我有也，而未始知西山之怪特。

　　今年九月二十八日，因坐法華西亭 ，望西山，始指異之 。遂命僕過湘江 ，緣染溪 ，斫榛莽 。焚茅茷 ，窮 山之高而止。

　　攀援而登，箕踞而遨 ，則凡數州之土壤 ，皆在衽席 之下。其高下之勢，岈然窪然 ，若垤 若穴，尺寸千里 ，攢蹙累積 ，莫得遯隱 。縈青繚白 ，外與天際 ，四望如一。然後知是山之特出，不與培塿 為類。悠悠乎與顥氣 俱，而莫得其涯；洋洋 乎與造物者遊 ，而不知其所窮。

　　引 觴滿酌，頹然 就醉，不知日之入。蒼然暮色 ，自遠而至，至無所見，而猶不欲歸。心凝形釋 ，與萬化冥合 。然後知吾嚮 之未始 遊，遊於是乎始，故為之文以志 。是歲元和四年 也。`
                },
                {
                    "id": 8,
                    "title": "念奴嬌‧赤壁懷古",
                    "author": "蘇軾",
                    "category": "詞",
                    "type": "豪放詞",
                    "length": "短篇",
                    "content": `大江東去，浪淘盡、千古風流人物。故壘 西邊，人道是、三國周郎 赤壁。亂石穿空，驚濤拍岸，捲起千堆雪。江山如畫，一時多少豪傑！

遙想公瑾當年，小喬 初嫁了，雄姿英發。羽扇綸巾 ，談笑間、檣櫓 灰飛煙滅。故國 神遊，多情應笑我，早生華髮 。人間如夢，一尊 還酹 江月。`
                },
                {
                    "id": 9,
                    "title": "青玉案",
                    "author": "辛棄疾",
                    "category": "詞",
                    "type": "婉約詞",
                    "length": "短篇",
                    "content": `東風夜放花千樹，  更吹落，星如雨。  寶馬雕車香滿路。  鳳簫聲動，  玉壺光轉，  一夜魚龍舞。 

蛾兒雪柳黃金縷，  笑語盈盈暗香去。  眾裏尋他千百度；  驀然迴首，  那人卻在，燈火闌珊處。`
                },
                {
                    "id": 10,
                    "title": "聲聲慢",
                    "author": "李清照",
                    "category": "詞",
                    "type": "婉約詞",
                    "length": "短篇",
                    "content": `尋尋覓覓，冷冷清清，悽悽慘慘戚戚。乍暖還寒時候， 最難將息。 三杯兩盞淡酒，怎敵他，  晚來風急？  雁過也，正傷心，卻是舊時相識。

滿地黃花堆積， 憔悴損，  如今有誰堪摘？  守著窗兒，獨自怎生得黑！  梧桐更兼細雨，到黃昏、點點滴滴。這次第，  怎一箇愁字了得！`
                },
                {
                    "id": 11,
                    "title": "逍遙遊",
                    "author": "莊子",
                    "category": "文言文",
                    "type": "哲理文",
                    "length": "中篇",
                    "content": `　　惠子 謂莊子曰：「魏王貽我大瓠之種 ，我樹之成而實五石 。以盛水漿，其堅不能自舉也 。剖之以為瓢 ，則瓠落無所容 。非不呺然 大也，吾為其無用而掊之 。」莊子曰：「夫子固拙於 用大矣！宋人有善為不龜手之藥者 ，世世以洴澼絖為事 。客聞之，請買其方百金。聚族而謀曰：『我世世為洴澼絖，不過數金；今一朝而鬻技百金 ，請與之。』客得之，以說 吳王。越有難 ，吳王使之將 ，冬與越人水戰，大敗越人，裂地 而封之。能不龜手一也 ；或以封，或不免於洴澼絖，則所用之異也 。今子有五石之瓠，何不慮以為大樽而浮於江湖 ，而憂其瓠落無所容，則夫子猶有蓬之心也夫 ！」

　　惠子謂莊子曰：「吾有大樹，人謂之樗 ；其大本擁腫而不中繩墨 ，其小枝卷曲而不中規矩 。立之塗 ，匠者不顧。今子之言，大而無用，衆所同去也 。」莊子曰：「子獨不見狸狌乎 ？卑身而伏，以候敖者 ；東西跳梁，不辟高下 ，中於機辟，死於罔罟 。今夫斄牛，其大若垂天之雲 ；此能為大矣，而不能執鼠 。今子有大樹，患其無用，何不樹之於無何有之鄉 ，廣莫之野 ，彷徨乎無為其側，逍遙乎寢臥其下 ；不夭斤斧，物無害者 。無所可用，安所困苦哉 ？」`
                },
                {
                    "id": 12,
                    "title": "出師表",
                    "author": "諸葛亮",
                    "category": "文言文",
                    "type": "表文",
                    "length": "長篇",
                    "content": `　　先帝創業未半 ，而中道崩殂 ；今天下三分 ，益州疲弊 ，此誠危急存亡之秋也﹗然侍衞之臣，不懈於內；忠志之士，忘身於外者 ，蓋追先帝之殊遇，欲報之於陛下也 。誠宜開張聖聽 ，以光先帝遺德 ，恢弘志士之氣 ﹔不宜妄自菲薄 ，引喻失義 ，以塞忠諫之路也 。

　　宮中、府中，俱為一體 ；陟罰臧否 ，不宜異同。若有作姦、犯科，及為忠善者 ，宜付有司，論其刑賞 ，以昭陛下平明之治 ；不宜偏私，使內外異法也 。

　　侍中、侍郎郭攸之、費禕、董允等 ，此皆良實，志慮忠純 ，是以先帝簡拔以遺陛下 。愚以為宮中之事，事無大小，悉以咨之 ，然後施行，必能裨補闕漏，有所廣益 。

　　將軍向寵，性行淑均 ，曉暢軍事，試用於昔日，先帝稱之曰「能」，是以眾議舉寵為督 。愚以為營中之事，悉以咨之，必能使行陣和睦，優劣得所 。

　　親賢臣，遠小人 ，此先漢所以興隆也﹔親小人，遠賢臣，此後漢所以傾頹也。先帝在時，每與臣論此事，未嘗不歎息痛恨於桓、靈也 ！侍中、尚書、長史、參軍 ，此悉貞良死節之臣，願陛下親之、信之，則漢室之隆，可計日而待也。

　　臣本布衣，躬耕於南陽 ，苟全性命於亂世，不求聞達於諸侯 。先帝不以臣卑鄙，猥自枉屈 ，三顧臣於草廬之中，諮臣以當世之事；由是感激，遂許先帝以驅馳 。後值傾覆 ，受任於敗軍之際，奉命於危難之間，爾來二十有一年矣 。先帝知臣謹慎，故臨崩寄臣以大事也 。受命以來，夙夜憂歎，恐託付不效，以傷先帝之明 。故五月渡瀘，深入不毛 。今南方已定，兵甲已足，當獎率三軍，北定中原，庶竭駑鈍，攘除姦凶 ，興復漢室，還於舊都 。此臣所以報先帝而忠陛下之職分也。至於斟酌損益，進盡忠言，則攸之、禕、允之任也 。

　　願陛下託臣以討賊興復之效；不效，則治臣之罪，以告先帝之靈。若無興德之言，則責攸之、禕、允等之慢，以彰其咎 。陛下亦宜自謀，以諮諏善道，察納雅言 ，深追先帝遺詔。臣不勝受恩感激。今當遠離，臨表涕零 ，不知所言 ！`
                },
                {
                    "id": 13,
                    "title": "六國論",
                    "author": "蘇洵",
                    "category": "文言文",
                    "type": "論說文",
                    "length": "中篇",
                    "content": `　　六國破滅 ，非兵不利 ，戰不善 ，弊在賂秦 。賂秦而力虧 ，破滅之道 也。或曰：「六國互喪 ，率 賂秦耶？」曰：「不賂者以賂者喪。」蓋失強援 ，不能獨完 ，故曰「弊在賂秦」也。

　　秦以攻取 之外，小則獲邑 ，大則得城，較秦之所得 與戰勝而得者，其實百倍；諸侯之所亡 與戰敗而亡者，其實亦百倍。則秦之所大欲，諸侯之所大患，固不在戰矣。思厥先祖父 ，暴霜露，斬荊棘 ，以有尺寸之地 。子孫視之不甚惜，舉以予人 ，如棄草芥 。今日割五城，明日割十城，然後得一夕安寢；起視四境，而秦兵又至矣。然則諸侯之地有限，暴秦之欲無厭 ，奉之彌 繁，侵之愈急，故不戰而強弱勝負已判 矣。至於顛覆 ，理固宜然。古人 云：「以地事秦，猶抱薪救火，薪不盡，火不滅。」 此言得之。 

　　齊人未嘗賂秦，終繼五國遷滅 ，何哉？與嬴 而不助五國也。五國既喪，齊亦不免矣。燕趙之君，始有遠略 ，能守其土，義不賂秦 。是故燕雖小國而後亡，斯用兵之效 也。至丹以荊卿為計 ，始速禍 焉。趙嘗五戰于秦 ，二敗而三勝 ；後秦擊趙者再，李牧 連卻 之；洎牧以讒誅 ，邯鄲為郡 ，惜其用武而不終 也。

　　且燕趙處秦革滅 殆盡之際，可謂智力孤危 ，戰敗而亡，誠不得已。向使三國各愛其地 ，齊人勿附於秦，刺客不行 ，良將 猶在，則勝負之數 ，存亡之理，當 與秦相較，或未易量 。

　　嗚呼！以賂秦之地，封天下之謀臣；以事秦之心，禮 天下之奇才；幷力西嚮 ，則吾恐秦人食之不得下嚥 也。悲夫！有如此之勢，而為秦人積威 之所劫，日削月割，以趨於亡！為國者無使為積威之所劫哉！

　　夫六國與秦皆諸侯，其勢弱於秦，而猶有可以不賂而勝之之勢；茍以天下之大，而從六國破亡之故事 ，是又在六國下矣！`
                },
                {
                    "id": 14,
                    "title": "勸學",
                    "author": "荀子",
                    "category": "文言文",
                    "type": "論說文",
                    "length": "中篇",
                    "content": `　　君子曰：學不可以已 。青，取之於藍 ，而青於藍 ；冰，水為之，而寒於水。木直中繩 ，輮 以為輪，其曲中規 ；雖有槁暴 、不復挺 者，輮使之然也。故木受繩則直 ，金就礪 則利，君子博學而日參省 乎己，則知 明而行 無過矣。

　　吾嘗終日而思矣，不如須臾 之所學也；吾嘗跂 而望矣，不如登高之博見也。登高而招，臂非加長也，而見者遠。順風而呼，聲非加疾 也，而聞者彰 。假輿馬者 ，非利足 也，而致 千里；假舟楫 者，非能水 也，而絕江河 。君子生非異 也，善假於物 也。

　　積土成山，風雨興焉；積水成淵 ，蛟龍 生焉；積善成德，而神明 自得，聖心 備焉。故不積跬步 ，無以至千里；不積小流，無以成江海。騏驥 一躍，不能十步；駑馬十駕 ，功在不舍 。鍥 而舍之，朽木不折；鍥而不舍，金石可鏤 。螾 無爪牙之利，筋骨之強，上食埃土 ，下飲黃泉，用心一也。蟹六跪而二螯 ，非蛇蟺 之穴無可寄託者，用心躁 也。`
                },
                {
                    "id": 15,
                    "title": "論仁、論孝、論君子",
                    "author": "孔子",
                    "category": "文言文",
                    "type": "語錄",
                    "length": "中篇",
                    "content": `論仁
(1)子曰：「不仁者，不可以久處約 ，不可以長處樂。仁者安仁，知者利仁 。」（《里仁》第四）
(2)子曰：「富與貴，是人之所欲也；不以其道得之，不處也 。貧與賤，是人之所惡也；不以其道得之 ，不去 也。君子去仁，惡乎成名 ？君子無終食之間違仁 ，造次必於是 ，顛沛必於是。」（《里仁》第四）
(3)顏淵問仁。
子曰：「克己復禮為仁 。一日克己復禮，天下歸仁焉。為仁由己，而由人乎哉 ？」
顏淵曰：「請問其目 。」子曰：「非禮勿視，非禮勿聽，非禮勿言，非禮勿動 。」
顏淵曰：「回雖不敏，請事斯語矣 。」（《顏淵》第十二）
(4)子曰：「志士仁人，無求生以害仁，有殺身以成仁 。」（《衛靈公》第十五）

論孝
(5)孟懿子 問孝。子曰：「無違 。」
樊遲御 ，子告之曰：「孟孫問孝於我，我對曰，無違。」
樊遲曰：「何謂也？」子曰：「生事之以禮 ；死葬之以禮，祭之以禮 。」（《為政》第二）
(6)子游 問孝。子曰：「今之孝者，是謂能養 。至於犬馬，皆能有養 ；不敬，何以別乎 ！」（《為政》第二）

(7)子曰：「事父母幾諫 ，見志不從，又敬不違，勞而不怨 。」（《里仁》第四）
(8)子曰：「父母之年，不可不知也。一則以喜，一則以懼 。」（《里仁》第四）

論君子
(9)子曰：「君子不重則不威 ；學則不固 。主忠信 。無友不如己者 。過則勿憚改 。」（《學而》第一）
(10)子曰：「君子坦蕩蕩，小人長戚戚 。」（《述而》第七）
(11)司馬牛 問君子。子曰：「君子不憂不懼。」曰：「不憂不懼，斯謂之君子已乎 ？」子曰：「內省不疚，夫何憂何懼 ？」（《顏淵》第十二）
(12)子曰：「君子成人之美，不成人之惡 。小人反是 。」（《顏淵》第十二）
(13)子曰：「君子恥其言而過其行 。」（《憲問》第十四）
(14)子曰：「君子義以為質 ，禮以行之，孫以出之，信以成之 。君子哉！」（《衛靈公》第十五）
(15)子曰：「君子病無能焉，不病人之不己知也 。」（《衛靈公》第十五）
(16)子曰：「君子求諸己，小人求諸人 。」（《衛靈公》第十五）`
                },
                {
                    "id": 16,
                    "title": "魚我所欲也",
                    "author": "孟子",
                    "category": "文言文",
                    "type": "論說文",
                    "length": "中篇",
                    "content": `　　孟子曰：「魚，我所欲也，熊掌，亦我所欲也；二者不可得兼，舍魚而取熊掌 者也。生亦我所欲也，義亦我所欲也；二者不可得兼，舍生而取義者也。

　　「生亦我所欲，所欲有甚於生者，故不為苟得 也；死亦我所惡 ，所惡有甚於死者，故患有所不辟 也。如使人之所欲莫甚於生，則凡可以得生者，何不用也？使人之所惡莫甚於死者，則凡可以辟患者，何不為也？由是則生而有不用也，由是則可以辟患而有不為也，是故所欲有甚於生者，所惡有甚於死者。非獨賢者有是心也，人皆有之，賢者能勿喪耳 。

　　一簞食 ，一豆羹 ，得之則生，弗 得則死。嘑爾而與之 ，行道之人弗受 ；蹴爾而與之 ，乞人不屑也 ；萬鍾 則不辯 禮義而受之。萬鍾於我何加 焉？為宮室之美、妻妾之奉 、所識窮乏者得我與 ？鄉 為身死而不受，今為宮室之美為之；鄉為身死而不受，今為妻妾之奉為之；鄉為身死而不受，今為所識窮乏者得我而為之，是亦不可以已 乎？此之謂失其本心 。」`
                }
            ]
        };


// 實用文試題庫
const practicalQuestionBank = {
    "專題文章": [
        {
            "題目": "杏壇中學學生會因應早前有關學生壓力的問卷調查結果，舉辦了「齊來減壓」活動。試以杏壇中學學生會會長董一心的身份，為校刊撰寫一篇專題文章，說明相關活動的好處，並鼓勵同學參加。",
            "資料一": `<div style="text-align: center; margin: 20px 0; padding: 20px; background-color: #e3f2fd; border-radius: 10px;">
<h2 style="color: #0288d1; font-size: 24px; margin: 10px 0;">杏壇中學學生會</h2>
<h1 style="color: #0277bd; font-size: 28px; margin: 10px 0;">「齊來減壓」活動</h1>
<p style="color: #039be5; font-size: 18px; margin-top: 15px;">為了讓同學減減壓，好好享受校園生活，學生會將於五月推行「齊來減壓」活動，歡迎同學參加。詳情如下：</p>
</div>

<table style="border-collapse: collapse; width: 100%; margin: 20px 0;">
<tr style="background-color: #f0f8ff;">
<td style="border: 2px solid #4a90e2; padding: 12px; font-weight: bold;">活動</td>
<td style="border: 2px solid #4a90e2; padding: 12px; font-weight: bold;">內容</td>
</tr>
<tr>
<td style="border: 2px solid #4a90e2; padding: 12px;">杏壇午間點唱站</td>
<td style="border: 2px solid #4a90e2; padding: 12px;">經校園電台給同學、老師或工友點唱打打氣。</td>
</tr>
<tr style="background-color: #f9f9f9;">
<td style="border: 2px solid #4a90e2; padding: 12px;">忙裡偷閒星期五</td>
<td style="border: 2px solid #4a90e2; padding: 12px;">逢星期五放學後特設興趣班，例如手工藝、烹飪、樂器體驗等，讓同學放鬆身心。</td>
</tr>
</table>`,
            "資料二": `<h3 style="color: #0288d1; margin-bottom: 15px;">杏壇中學學生壓力問卷調查報告結果（節錄）</h3>
<p>根據問卷調查，本校學生的主要壓力來源如下：</p>
<ul style="list-style-type: disc; padding-left: 20px;">
<li><span style="background-color: #ffeb3b; padding: 4px 8px; font-weight: bold;">學業前途</span>：因測驗、考試、升學方向感到焦慮。</li>
<li><span style="background-color: #ffeb3b; padding: 4px 8px; font-weight: bold;">常感孤獨</span>：因專注學業忽略與人交往，致人際關係疏離。</li>
</ul>`
        },
        {
            "題目": "仁德中學將推行「食得健康校園行動」，同學對行動有不同意見。試以仁德中學學生會宣傳幹事潘安儀名義，撰寫一篇刊登在學生會網頁的專題文章，說明該行動如何有助同學改善健康，並鼓勵同學支持。（全文不得多於550字，標點符號計算在內）",
            "資料一": `<div style="text-align: center; margin: 20px 0; padding: 20px; background-color: #e8f5e9; border-radius: 10px;">
<h2 style="color: #2e7d32; font-size: 24px; margin: 10px 0;">仁德中學學生會</h2>
<h1 style="color: #43a047; font-size: 28px; margin: 10px 0;">識飲識食 健康校園</h1>
<p style="color: #388e3c; font-size: 18px; margin-top: 15px;">近月，校方發現同學的身體健康情況明顯轉差，不少同學更出現超重和肥胖問題。因此本會將舉辦「食得健康校園行動」，希望能助同學改善身體健康，增強體魄。</p>
</div>

<table style="border-collapse: collapse; width: 100%; margin: 20px 0;">
<tr style="background-color: #e8f5e8;">
<td style="border: 2px solid #4caf50; padding: 12px; font-weight: bold;">健康行動</td>
<td style="border: 2px solid #4caf50; padding: 12px; font-weight: bold;">配合措施</td>
</tr>
<tr>
<td style="border: 2px solid #4caf50; padding: 12px;">1. 出售健康食品</td>
<td style="border: 2px solid #4caf50; padding: 12px;">小食部只出售低脂、低糖、低鈉的三低食品，停止供應油炸小食。</td>
</tr>
<tr style="background-color: #f1f8e9;">
<td style="border: 2px solid #4caf50; padding: 12px;">2. 健康飲食日誌</td>
<td style="border: 2px solid #4caf50; padding: 12px;">同學填寫健康飲食日誌，記錄每天飲食情況，計算每天攝取的熱量。</td>
</tr>
</table>`,
            "資料二": `<h3 style="color: #2e7d32; margin-bottom: 15px;">仁德中學校園討論區節錄</h3>
<p>主題：你支持「食得健康校園行動」嗎？</p>

<div style="background-color: #f5f5f5; padding: 15px; border-radius: 8px; margin: 10px 0;">
<div style="border-left: 4px solid #2196f3; padding-left: 15px; margin: 10px 0;">
<strong style="color: #1565c0;">樂樂</strong> <span style="color: #666; font-size: 12px;">2024/11/21 20:03</span>
<p>小食部出售健康食品對我們的身體固然是好，不過三低食品的味道必然是不美味的啊！</p>
</div>

<div style="border-left: 4px solid #ff5722; padding-left: 15px; margin: 10px 0;">
<strong style="color: #d84315;">家豪</strong> <span style="color: #666; font-size: 12px;">2024/11/21 20:07</span>
<p>每天光是做功課和溫習已疲憊不堪，還要記錄飲食情況？太浪費時間了吧？</p>
</div>

<div style="border-left: 4px solid #4caf50; padding-left: 15px; margin: 10px 0;">
<strong style="color: #2e7d32;">芷蕙</strong> <span style="color: #666; font-size: 12px;">2024/11/21 20:12</span>
<p>健康與美味是否不能並存呢？「食得健康校園行動」有助我們建立健康飲食習慣，好處多多，實在是太好了！</p>
</div>
</div>`
        }
    ],
    "演講辭": [
        {
            "題目": "香城中學中文學會擬推行「開卷有益」計劃，此舉引起同學的討論。試以香城中學中文學會主席何修端名義，撰寫一篇演講辭，在早會上向全體師生演講，針對同學的意見，游說他們支持該計劃。（全文不得多於550字，標點符號計算在內）",
            "資料一": `<div style="text-align: center; margin: 20px 0; padding: 20px; background-color: #fff8e1; border-radius: 10px;">
<h2 style="color: #8b4513; font-size: 24px; margin: 10px 0;">香城中學中文學會</h2>
<h1 style="color: #d2691e; font-size: 28px; margin: 10px 0;">「開卷有益」計劃</h1>
<p style="color: #a0522d; font-size: 18px; margin-top: 15px;">鑒於我校同學欠缺閱讀習慣，閱讀風氣未如理想，而閱讀卻在我們的學習以及成長上有舉足輕重的作用。中文學會擬於本學年舉實行「開卷有益」計劃，期望提升同學的閱讀量，培養閱讀習慣。</p>
</div>

<p>計劃詳情如下：</p>

<table style="border-collapse: collapse; width: 100%; margin: 20px 0;">
<tr style="background-color: #fff8dc;">
<td style="border: 2px solid #daa520; padding: 12px; font-weight: bold;">「開卷有益」計劃</td>
<td style="border: 2px solid #daa520; padding: 12px; font-weight: bold;">配合措施</td>
</tr>
<tr>
<td style="border: 2px solid #daa520; padding: 12px; vertical-align: top;">增加閱讀時數<br>提升閱讀深度</td>
<td style="border: 2px solid #daa520; padding: 12px;">每星期設一節閱讀課，於課堂閱讀。<br>每月一次班內閱讀分享會，由同學匯報閱讀心得。</td>
</tr>
</table>`,
            "資料二": `<h3 style="color: #8b4513; margin-bottom: 15px;">中文學會討論區對話節錄</h3>
<p>主題：「開卷有益」計劃之我見</p>

<div style="background-color: #f5f5f5; padding: 15px; border-radius: 8px; margin: 10px 0;">
<div style="border-left: 4px solid #f44336; padding-left: 15px; margin: 10px 0;">
<strong style="color: #c62828;">一心</strong> <span style="color: #666; font-size: 12px;">17:22</span>
<p>同學自選讀物在課堂上閱讀，質素沒有保證，倒不如讓老師多教授應試技巧。</p>
</div>

<div style="border-left: 4px solid #ff9800; padding-left: 15px; margin: 10px 0;">
<strong style="color: #ef6c00;">允行</strong> <span style="color: #666; font-size: 12px;">18:12</span>
<p>學校功課量本來就很多，還要應付閱讀分享？課堂分享會？浪費時間！</p>
</div>

<div style="border-left: 4px solid #4caf50; padding-left: 15px; margin: 10px 0;">
<strong style="color: #2e7d32;">家寶</strong> <span style="color: #666; font-size: 12px;">18:53</span>
<p>閱讀幫助我們提升思維能力及拓闊視野，何樂而不為？閱讀課又能為同學提供閱讀空間！其實閱讀並非難事，只是事在人為。</p>
</div>
</div>`
        },
        {
            "題目": "杏壇中學將於本學年推行「健康生活 快樂精神」計劃，同學在討論區各自表達了不同意見。試以杏壇中學健康大使洪一心的名義，撰寫一篇演講辭，在早會向全體同學說明該計劃如何有助同學的精神健康，並鼓勵同學支持。（全文不得多於550字，標點符號計算在內）",
            "資料一": `<div style="text-align: center; margin: 20px 0; padding: 20px; background-color: #f3e5f5; border-radius: 10px;">
<h2 style="color: #4a148c; font-size: 24px; margin: 10px 0;">杏壇中學健康校園小組</h2>
<h1 style="color: #7b1fa2; font-size: 28px; margin: 10px 0;">「健康生活 快樂精神」</h1>
<p style="color: #6a1b9a; font-size: 18px; margin-top: 15px;">為改善同學的精神健康，本校將於本學年推行「健康生活 快樂精神」計劃，讓全校同學參與。</p>
</div>

<p>詳情如下：</p>

<table style="border-collapse: collapse; width: 100%; margin: 20px 0;">
<tr style="background-color: #f3e5f5;">
<td style="border: 2px solid #9c27b0; padding: 12px; font-weight: bold;">措施</td>
<td style="border: 2px solid #9c27b0; padding: 12px; font-weight: bold;">內容</td>
</tr>
<tr>
<td style="border: 2px solid #9c27b0; padding: 12px;">1. 運動益身心</td>
<td style="border: 2px solid #9c27b0; padding: 12px;">每週增加兩節體育課，同學進行自選運動項目。</td>
</tr>
<tr style="background-color: #fce4ec;">
<td style="border: 2px solid #9c27b0; padding: 12px;">2. 感恩分享站</td>
<td style="border: 2px solid #9c27b0; padding: 12px;">收集感恩心意卡，於午膳時間經校園電台朗讀。</td>
</tr>
</table>`,
            "資料二": `<h3 style="color: #4a148c; margin-bottom: 15px;">杏壇中學討論區對話節錄</h3>
<p>主題：快樂精神計劃，你支持嗎？</p>

<div style="background-color: #f5f5f5; padding: 15px; border-radius: 8px; margin: 10px 0;">
<div style="border-left: 4px solid #ff9800; padding-left: 15px; margin: 10px 0;">
<strong style="color: #ef6c00;">楊彥行</strong>
<p>體育課？學校是要我們身體健康，還是精神健康呢？不如想想其他對症下藥的方法吧？</p>
</div>

<div style="border-left: 4px solid #4caf50; padding-left: 15px; margin: 10px 0;">
<strong style="color: #2e7d32;">孫淑兒</strong>
<p>這個計劃有助改善我們的生活習慣以及態度，值得支持！</p>
</div>

<div style="border-left: 4px solid #f44336; padding-left: 15px; margin: 10px 0;">
<strong style="color: #c62828;">曾逸天</strong>
<p>有恩可感也不能減少生命中的苦難啊！「感恩分享會」實在是多此一舉！</p>
</div>
</div>`
        }
    ],
    "書信": [
        {
            "題目": "「失明長者安老協會」現正招募中學生服務大使。試以萃文中學中五學生曾玲瓏的身份，撰寫一封自薦信，說明個人具備服務失明長者的兩個條件，並舉相關經驗以作證明。（須運用以下資料作答，全文不得多於550字，標點符號計算在內。）",
            "資料一": `<div style="text-align: center; margin: 20px 0; padding: 20px; background-color: #e3f2fd; border-radius: 10px;">
<h2 style="color: #1565c0; font-size: 24px; margin: 10px 0;">失明長者安老協會</h2>
<h1 style="color: #0d47a1; font-size: 28px; margin: 10px 0;">中學生服務大使招募</h1>
<p style="color: #1976d2; font-size: 18px; margin-top: 15px;">歡迎有愛心的中學生加入我們的服務行列，為失明長者提供關懷與支援</p>
</div>`,
            "資料二": `<h3 style="color: #1565c0; margin-bottom: 15px;">曾玲瓏的課外活動簡歷</h3>

<table style="border-collapse: collapse; width: 100%; margin: 20px 0;">
<tr style="background-color: #e3f2fd;">
<td style="border: 2px solid #2196f3; padding: 12px; font-weight: bold; text-align: center;"></td>
<td style="border: 2px solid #2196f3; padding: 12px; font-weight: bold; text-align: center;">中一</td>
<td style="border: 2px solid #2196f3; padding: 12px; font-weight: bold; text-align: center;">中二</td>
<td style="border: 2px solid #2196f3; padding: 12px; font-weight: bold; text-align: center;">中三</td>
</tr>
<tr>
<td style="border: 2px solid #2196f3; padding: 12px; font-weight: bold; background-color: #bbdefb;">服務</td>
<td style="border: 2px solid #2196f3; padding: 12px;">‧圖書館管理員</td>
<td style="border: 2px solid #2196f3; padding: 12px;">‧社會服務團：長者服務組組員<br>‧參加「與長者溝通」培訓班</td>
<td style="border: 2px solid #2196f3; padding: 12px;">‧社會服務團：長者服務組組長</td>
</tr>
<tr style="background-color: #f9f9f9;">
<td style="border: 2px solid #2196f3; padding: 12px; font-weight: bold; background-color: #bbdefb;">文娛</td>
<td style="border: 2px solid #2196f3; padding: 12px;">‧校際廣播劇比賽團體冠軍</td>
<td style="border: 2px solid #2196f3; padding: 12px;">‧香城電台中學生「聲演好書」比賽亞軍</td>
<td style="border: 2px solid #2196f3; padding: 12px;">‧校際朗誦節二人對話亞軍<br>‧參加配音訓練班</td>
</tr>
<tr>
<td style="border: 2px solid #2196f3; padding: 12px; font-weight: bold; background-color: #bbdefb;">學術</td>
<td style="border: 2px solid #2196f3; padding: 12px;"></td>
<td style="border: 2px solid #2196f3; padding: 12px;">‧聯校文史常識問答比賽亞軍</td>
<td style="border: 2px solid #2196f3; padding: 12px;">‧校際閱讀報告比賽優異獎</td>
</tr>
</table>`
        }
    ],
    "工作報告": [
        {
            "題目": "試以風雅中學中文學會主席許心潔的身份，撰寫工作報告，呈交黎曉輝校長，說明中文週活動未能達至活動目的的原因，以總結活動經驗。（須運用以上資料寫作，全文不得多於550字，標點符號計算在內。）",
            "資料一": `<div style="background-color: #fff3e0; padding: 15px; border-radius: 8px; margin: 20px 0;">
<h3 style="color Ascendant-color: #e65100; margin-bottom: 10px;">便條內容</h3>
<p><strong>心潔：</strong></p>
<p>中文週活動已結束，請盡快撰寫工作報告給校長。報告中需要誠實反映活動的不足之處，以及分析原因。這樣有助於日後改善。</p>
<p><strong>林博文老師</strong><br>中文學會顧問</p>
</div>`,
            "資料二": `<h3 style="color: #e65100; margin-bottom: 15px;">中文週活動檢討會議錄音（節錄）</h3>
<p>會議重點摘錄</p>
<ul style="list-style-type: disc; padding-left: 20px;">
<li><strong>參與度問題</strong>：各項活動的學生參與率偏低，未能達到預期效果</li>
<li><strong>宣傳不足</strong>：活動宣傳時間過短，同學對活動內容認識不足</li>
<li><strong>時間安排</strong>：活動時間與其他學科考試撞期，影響同學參與意願</li>
<li><strong>資源配置</strong>：部分活動預算不足，設備租借出現問題</li>
</ul>`
        },
        {
            "題目": "香城中學時事學會於三月舉行了「時事週」。試以時事學會會長王啟太的身份，撰寫一篇工作報告給學會顧問陳一新老師，說明「時事週」的成功及不足之處。",
            "資料一": `<div style="text-align: center; margin: 20px 0; padding: 20px; background-color: #e0f7fa; border-radius: 10px;">
<h2 style="color: #006064; font-size: 24px; margin: 10px 0;">香城中學時事學會「時事週」</h2>
<h1 style="color: #00838f; font-size: 28px; margin: 10px 0;">關心社會大小事 由你我做起</h1>
<p style="color: #00695c; font-size: 18px; margin-top: 15px;">為了提升同學對社會時事的認識和關注，時事學會將於3月18日至22日舉辦「時事週」，希望同學踴躍參與。活動詳情如下：</p>
</div>

<table style="border-collapse: collapse; width: 100%; margin: 20px 0;">
<tr style="background-color: #e0f7fa;">
<td style="border: 2px solid #00acc1; padding: 12px; font-weight: bold;">活動</td>
<td style="border: 2px solid #00acc1; padding: 12px; font-weight: bold;">內容</td>
</tr>
<tr>
<td style="border: 2px solid #00acc1; padding: 12px;">「時事知多少」講座</td>
<td style="border: 2px solid #00acc1; padding: 12px;">講員從多角度分析香城人口老化的問題。</td>
</tr>
<tr style="background-color: #f9f9f9;">
<td style="border: 2px solid #00acc1; padding: 12px;">十大本地新聞選舉</td>
<td style="border: 2px solid #00acc1; padding: 12px;">同學投票選出十大本地新聞，並在早會時間增設新聞評論環節，同學可報名參加，暢所欲言。</td>
</tr>
</table>`,
            "資料二": `<h3 style="color: #006064; margin-bottom: 15px;">「時事週」意見調查（節錄）</h3>
<p>整理日期：2024年3月28日</p>
<p>受訪參加者的意見：</p>

<ul style="list-style-type: disc; padding-left: 20px;">
<li><strong>意見一</strong><br>本年活動使我獲益良多。十大本地新聞選舉讓我們有機會就熱門時事議題發表意見，同學的評論都很有見地。</li>
<li><strong>意見二</strong><br>「時事知多少」講座內容涵蓋的議題不多，建議探討更多社會議題。</li>
</ul>`
        },
        {
            "題目": "禮賢書院於9月10日安排領袖生參與「揚帆出海 發揮潛能」海上教室活動。試以禮賢書院領袖生總隊長方智和的名義，撰寫一份工作報告，呈交梁文杰校長，說明該活動如何有助同學提升領袖才能，並感謝校方的栽培。（全文不得多於550字，標點符號計算在內。）",
            "資料一": `<div style="text-align: center; margin: 20px 0; padding: 20px; background-color: #e8eaf6; border-radius: 10px;">
<h2 style="color: #283593; font-size: 24px; margin: 10px 0;">禮賢書院</h2>
<h1 style="color: #3f51b5; font-size: 28px; margin: 10px 0;">「揚帆出海 發揮潛能」海上教室活動通告</h1>
<p style="color: #3949ab; font-size: 18px; margin-top: 15px;">為培育學生成為優秀的領袖，本校將於9月10日參與「揚帆出海 發揮潛能」海上教室活動，讓本校領袖生接受訓練。詳情如下：</p>
</div>

<table style="border-collapse: collapse; width: 100%; margin: 20px 0;">
<tr style="background-color: #e8eaf6;">
<td style="border: 2px solid #5c6bc0; padding: 12px; font-weight: bold;">活動</td>
<td style="border: 2px solid #5c6bc0; padding: 12px; font-weight: bold;">內容詳情</td>
</tr>
<tr>
<td style="border: 2px solid #5c6bc0; padding: 12px;">駕駛帆船</td>
<td style="border: 2px solid #5c6bc0; padding: 12px;">同學分組駕駛帆船，學習操舵、升帆、換舷、下錨等，完成船長指令。</td>
</tr>
<tr style="background-color: #f9f9f9;">
<td style="border: 2px solid #5c6bc0; padding: 12px;">逃生演習</td>
<td style="border: 2px solid #5c6bc0; padding: 12px;">由導師指導同學穿上救生衣棄船逃生，突破自我。</td>
</tr>
</table>`,
            "資料二": `<h3 style="color: #283593; margin-bottom: 15px;">參與同學的活動意見（節錄）</h3>

<div style="background-color: #f5f5f5; padding: 15px; border-radius: 8px; margin: 10px 0;">
<div style="border-left: 4px solid #2196f3; padding-left: 15px; margin: 10px 0;">
<strong style="color: #1565c0;">林家寶（中四甲）</strong>
<p>參加前擔心活動太危險，怕自己沒有經驗，會發生意外，但其實是我杞人憂天而已。</p>
</div>

<div style="border-left: 4px solid #4caf50; padding-left: 15px; margin: 10px 0;">
<strong style="color: #2e7d32;">曾修端（中五乙）</strong>
<p>活動令我獲益良多。領袖不是完美的，優秀的領袖生正是從各種挑戰和失敗中成長的。</p>
</div>

<div style="border-left: 4px solid #ff9800; padding-left: 15px; margin: 10px 0;">
<strong style="color: #ef6c00;">陳念慈（中四乙）</strong>
<p>我和其他同學都覺得活動要日曬雨淋，很辛苦。不過也是值得的。</p>
</div>

<div style="border-left: 4px solid #9c27b0; padding-left: 15px; margin: 10px 0;">
<strong style="color: #6a1b9a;">方智和（中五甲）</strong>
<p>謝謝，我會歸納大家的意見，撰寫活動報告，在9月底前呈交給梁校長，匯報活動成果。</p>
</div>
</div>`
        }
    ],
    "評論文章": [
        {
            "題目": "試以香城中學文化學會主席張家寶的名義，撰寫一篇刊登於學生報的評論文章，就香城文化節的目標，提出看法。（全文不得多於550字，標點符號計算在內。）",
            "資料一": `<div style="margin: 20px 0; padding: 20px; background-color: #efebe9; border-radius: 10px;">
<h2 style="color: #5d4037; font-size: 24px; margin: 10px 0;">香城中學網頁</h2>
<h3 style="color: #6d4c41; font-size: 20px; margin: 10px 0;">中國語文科</h3>
<h1 style="color: #4e342e; font-size: 28px; margin: 10px 0;">香城文化節</h1>

<p><strong>背景</strong></p>
<p style="color: #5d4037; margin: 10px 0;">香城是一個現代化城市，也擁有獨特的歷史背景。幾個世紀以來，孕育了香城特有的傳統文化。然而隨著社會發展，許多地道的傳統節日已今非昔比，其源流及習俗已被遺忘；同時，一些傳統手工藝，也因時代發展而日漸式微，入行的年輕人越來越少，傳統手藝面臨失傳的危機。</p>
<p style="color: #5d4037; margin: 10px 0;">有見及此，本校中國語文科擬於下學期舉辦香城文化節，供全校同學參加。</p>

<table style="border-collapse: collapse; width: 100%; margin: 20px 0;">
<tr style="background-color: #d7ccc8;">
<td style="border: 2px solid #8d5524; padding: 12px; font-weight: bold;">香城文化節</td>
<td style="border: 2px solid #8d5524; padding: 12px; font-weight: bold;">目標</td>
<td style="border: 2px solid #8d5524; padding: 12px; font-weight: bold;">內容</td>
</tr>
<tr>
<td style="border: 2px solid #8d5524; padding: 12px;">推廣傳統節日</td>
<td style="border: 2px solid #8d5524; padding: 12px;">推廣傳統節日</td>
<td style="border: 2px solid #8d5524; padding: 12px;">以展板介紹香城的道地節日，包括節日起源、傳統習俗等。</td>
</tr>
<tr style="background-color: #f9f9f9;">
<td style="border: 2px solid #8d5524; padding: 12px;">探知傳統文化背後的人物故事</td>
<td style="border: 2px solid #8d5524; padding: 12px;">讓市民與昔日香城鄉村生活連繫。</td>
<td style="border: 2px solid #8d5524; padding: 12px;">邀請從事傳統手工藝行業的老師傅，分享入行經歷及與行業相關的趣事。</td>
</tr>
</table>
</div>`,
            "資料二": `<h3 style="color: #5d4037; margin-bottom: 15px;">香城中學文化學會問卷調查結果（節錄）</h3>
<p>調查重點發現</p>
<ul style="list-style-type: disc; padding-left: 20px;">
<li><strong>文化認知度</strong>：82%學生對香城傳統文化了解不足</li>
<li><strong>參與意願</strong>：67%學生表示有興趣參加文化節活動</li>
<li><strong>期望內容</strong>：學生最感興趣的是傳統手工藝體驗</li>
<li><strong>時間安排</strong>：建議安排在學期中段，避免考試期間</li>
</ul>`
        },
        {
            "題目": "試以「活化善行小學關注組」主席林青青名義，撰寫一篇刊登於香城南區區報的評論文章，就南區區議會「活化善行小學方案」的目標，提出看法。（全文不得多於550字，標點符號計算在內。）",
            "資料一": `<div style="margin: 20px 0; padding: 20px; background-color: #e0f2f1; border-radius: 10px;">
<h2 style="color: #00695c; font-size: 24px; margin: 10px 0;">香城南區區議會</h2>
<h1 style="color: #00897b; font-size: 28px; margin: 10px 0;">活化善行小學方案</h1>

<p><strong>背景</strong></p>
<p style="color: #00695c; margin: 10px 0;">樂漁村位處香城南區，是區內已有二百多年歷史的臨海村落。善行小學是該村的地標，鄰近避風塘，在近百年前由村民籌辦，為該村及附近的漁民子弟提供上學讀書機會，後來更成為香城首間由私塾轉為官立的學校。</p>
<p style="color: #00695c; margin: 10px 0;">小學停辦已近十年，校舍至今仍然廢置，故南區區議會於本年初向香城政府提出「活化善行小學方案」，建議把小學活化為「民間生活館」，開放予公眾參觀及參與活動。</p>

<table style="border-collapse: collapse; width: 100%; margin: 20px 0;">
<tr style="background-color: #b2dfdb;">
<td style="border: 2px solid #26a69a; padding: 12px; font-weight: bold;">「活化善行小學方案」</td>
<td style="border: 2px solid #26a69a; padding: 12px; font-weight: bold;">目標</td>
<td style="border: 2px solid #26a69a; padding: 12px; font-weight: bold;">內容</td>
</tr>
<tr>
<td style="border: 2px solid #26a69a; padding: 12px;">活化計劃</td>
<td style="border: 2px solid #26a69a; padding: 12px;">使下一代認識香城早期教育的特色。</td>
<td style="border: 2px solid #26a69a; padding: 12px;">設展示廊，介紹善行小學校史及香城早期教育發展。</td>
</tr>
<tr style="background-color: #f9f9f9;">
<td style="border: 2px solid #26a69a; padding: 12px;">活化計劃</td>
<td style="border: 2px solid #26a69a; padding: 12px;">讓市民與昔日香城鄉村生活連繫。</td>
<td style="border: 2px solid #26a69a; padding: 12px;">設生活體驗中心，用以舉辦農耕生活體驗活動。</td>
</tr>
</table>
</div>`,
            "資料二": `<h3 style="color: #00695c; margin-bottom: 15px;">「活化善行小學關注組」問卷調查結果（節錄）</h3>
<p>調查重點發現</p>
<ul style="list-style-type: disc; padding-left: 20px;">
<li><strong>地區支持度</strong>：78%居民支持活化計劃</li>
<li><strong>關注重點</strong>：希望保留小學原有建築特色</li>
<li><strong>期望用途</strong>：優先考慮教育展示功能</li>
<li><strong>交通配套</strong>：建議增設公共交通路線</li>
<li><strong>營運模式</strong>：傾向非牟利機構管理</li>
</ul>`
        }
    ]
};



// 寫作試題庫資料
const writingQuestionBank = {
  
  "敘事":[
      {
         "題目":"「這件物件很是輕巧，卻讓我明白『但求無愧於心』的道理。」根據以上描述，試以你的經歷和體會，寫作一篇文章。",
         "題解":"一件輕巧的物件背後藏著讓作者學會做事要問心無愧的故事。物件可能很普通，但它連結的事件讓作者體會到誠實面對自己的重要性。",
         "方向":"學生可描述物件的外觀和來歷，說明它如何與某個抉擇時刻相關聯，並寫出自己如何實踐「無愧於心」的過程和感受。"
      },
      {
         "題目":"試以「為免連累他人，我只好放棄一直以來的執着」為首句，續寫這篇文章。",
         "題解":"開頭表明主角為保護他人而放下堅持。這種放棄可能是出於責任感或關心，但內心仍有掙扎。",
         "方向":"學生需續寫故事，交代原本執着的事物是什麼、為什麼會連累他人，以及放棄時的矛盾心情，最後寫出從中學到的體會。"
      },
      {
         "題目":"「李叔叔是我的鄰居，他平時總是不近人情，但經過一件事後，我才明白到他背後的苦衷。」根據以上一段描述，記述事件經過，並抒發你的體會。",
         "題解":"李叔叔表面冷漠，實則有難言之隱。透過具體事件，主角發現他行為背後的真正原因。",
         "方向":"學生應描述事件細節（如李叔叔的異常行為、主角的發現過程），寫出誤解到理解的轉變，並抒發對「不要輕易評斷他人」的感悟。"
      },
      {
         "題目":"試以「雖然沒有結果，但我卻不會後悔。」為首句，續寫這篇文章。",
         "題解":"開篇點明即使努力未達目標，主角仍覺值得。這種無悔可能源於過程中的收穫或自我成長。",
         "方向":"學生需續寫故事，說明追求的目標是什麼、如何付出努力、為何失敗卻不後悔，最後強調過程中的得著。"
      },
      {
         "題目":"以下是你在社交網站的帖文：「這條街道雖然老舊，但卻充滿人情味。」試撰文一篇，記述你在這條街道上的見聞，並抒發你的體會。",
         "題解":"老舊街道蘊藏溫暖的人際互動，如鄰里互助或小店溫情，這些小事構成獨特的生活氣息。",
         "方向":"學生可描寫街道景象（如攤販、老店），透過具體事例（如店主送暖、鄰居關照）展現人情味，並寫出對現代社會的反思。"
      },
      {
         "題目":"試撰寫文章一篇，並以「從此以後，我終於放下成見。」為末句收結全文。",
         "題解":"文章結尾表達主角消除對某人或事的偏見。這種轉變通常源於親身體驗打破原有印象。",
         "方向":"學生需先鋪陳成見的由來（如誤會或偏聽），再描述關鍵事件如何改變想法，最後以指定句子總結放下成見的釋然。"
      },
      {
         "題目":"試以「一個被遺忘的角落」為題，寫作文章一篇。",
         "題解":"角落可能是實體空間（如舊書店角落）或抽象存在（如記憶中的兒時遊戲場），它雖被忽略卻有特殊意義。",
         "方向":"學生可描寫角落的樣貌與被遺忘的原因，透過重訪或回憶帶出它承載的情感，並抒發對「珍惜微小事物」的體會。"
      },
      {
         "題目":"「今天，我不能參賽，只能坐在觀眾席上，但當時的所見所聞卻給予我嶄新的體會。」試以這段文字為文章的第一段，續寫下去。",
         "題解":"因故缺席比賽的主角，透過旁觀獲得意外收穫。觀眾視角可能讓主角更理解團隊精神或比賽真諦。",
         "方向":"學生需續寫觀賽過程，重點描述所見場景（如選手的堅持、觀眾的反應）如何帶來新領悟，並對比自身原來的想法。"
      },
      {
         "題目":"試撰寫文章一篇，並以「從今以後，我不會再輕言放棄。」為末句收結全文。",
         "題解":"文章結尾展現主角決心堅持到底。這種轉變通常源於一次「堅持成功」或「放棄後悔」的經驗。",
         "方向":"學生應先鋪陳過去易放棄的習慣，再詳細描寫某次堅持到底的經歷（如練習技能、克服困難），最後以指定句子收結。"
      },
      {
         "題目":"試以「我曾經努力嘗試，但最終仍是事與願違」為首句，續寫這篇文章。",
         "題解":"開篇坦承努力卻失敗的結果。儘管未達目標，過程中可能有意外收穫或自我突破。",
         "方向":"學生需續寫故事，說明嘗試的目標、付出的具體努力、失敗原因，並強調從中學到的價值（如發現新方向）。"
      },
      {
         "題目":"試以「經過這件事，我才懂得拋開無謂的自尊心。」為首句，續寫這篇文章。",
         "題解":"開頭點出事件讓主角學會放下過度自尊。這種轉變常源於自尊心導致吃虧後的醒悟。",
         "方向":"學生應續寫事件經過（如因固執面子錯失機會），描述拋開自尊後的正面變化，並寫出「適時低頭」的體會。"
      },
      {
         "題目":"試以「一件發人深省的事」為題，作文一篇，記述這件事情的經過和你的感悟。",
         "題解":"這件事引發深刻思考，可能涉及人性抉擇、價值觀衝擊或生活啟示，規模雖小卻影響深遠。",
         "方向":"學生需完整敘述事件（如目擊爭執、親歷誤會），重點刻畫關鍵細節如何引發反思，最後寫出對自身行為的改變。"
      },
      {
         "題目":"「唐老師是我最敬愛的老師，他不喜歡說大道理，從他平日待人接物，我體會到中國文化可貴的一面。」根據以上一段描述，試記述唐老師的言行，抒發你對他的感情。",
         "題解":"唐老師以身教代替言教，在日常小事中展現傳統美德（如尊重長輩、誠信守諾）。",
         "方向":"學生應列舉具體事例（如老師如何處理學生衝突），說明這些行為如何體現文化價值，並表達對老師的敬佩與感謝。"
      },
      {
         "題目":"「我曾參與一次活動，當中的經歷令我覺醒過來，明白到『己所不欲，勿施於人』這道理。」根據以上描述，試以你的經歷和體會，寫作一篇文章。",
         "題解":"活動中的某個事件讓主角親身感受「將心比心」的重要，可能是自己無心之失傷人後的醒悟。",
         "方向":"學生需描述活動過程（如團體遊戲、服務學習），聚焦自己如何從「施予者」變成「接受者」，從而理解推己及人的真義。"
      },
      {
         "題目":"「今天發生了一件事情，當時我曾經想力陳己見，最後選擇了沉默。我認為沉默是必要的。」以上是文章的開首，試以「必要的沉默」為題，續寫這篇文章。",
         "題解":"開篇點出在某些情境下，沉默比發言更恰當。這種選擇可能為了避免衝突或照顧他人感受。",
         "方向":"學生需續寫事件背景（如爭論場合），分析當下選擇沉默的原因（如時機不宜），並說明沉默帶來的正面結果。"
      },
      {
         "題目":"「今天我沒有帶手提電話外出，因而有不一樣的經歷和體會。」試從第二段開始，以「沒有手提電話的一天」為題，續寫這篇日記。",
         "題解":"暫離手機讓主角重新觀察周遭，發現被忽略的生活細節（如街頭互動、自然景物）。",
         "方向":"學生應續寫當天經歷，對比有手機時的習慣（如低頭滑螢幕），描述脫離手機後的新體驗（如與陌生人交談），並反思科技影響。"
      },
      {
         "題目":"試以「熱鬧過後，我卻感到失落。」為首句，續寫這篇文章。",
         "題解":"開篇點出歡樂場合結束後的孤獨感。這種落差可能源於曲終人散的冷清或熱鬧掩蓋的空虛。",
         "方向":"學生需續寫熱鬧場景（如慶生會、畢業典禮），描述人潮散去後的寂靜對比，並寫出對「珍惜當下」或「自我獨處」的體悟。"
      },
      {
         "題目":"試撰寫文章一篇，並以「自此之後，我終於解開了心結。」為末句收結全文。",
         "題解":"文章結尾表達主角釋懷長期心結。解結可能透過坦誠對話、時間沉澱或新視角理解往事。",
         "方向":"學生應先鋪陳心結的根源（如誤會、遺憾），再描述解結的關鍵事件，最後以指定句子收結，強調釋懷後的輕鬆。"
      },
      {
         "題目":"舊地重遊，看到眼前景象，難免興起一番感受，試以「重遊舊地所見有感」為題，寫作文章一篇。",
         "題解":"重返熟悉地方，發現景物變化或人事已非，觸發對時間流逝或成長的代價的感慨。",
         "方向":"學生可對比記憶中的舊貌與眼前新貌（如店鋪消失、建築改建），透過具體變化帶出物是人非的感觸，並抒發對過往的懷念。"
      },
      {
         "題目":"試以：「這一句話，我會記上一輩子。」為首句，續寫這篇文章。",
         "題解":"開篇強調某句話的深遠影響。這句話可能來自親友師長，在低谷時給予力量或轉變觀念。",
         "方向":"學生需續寫這句話的出現情境（如失敗時被鼓勵），說明它如何改變自己的態度或行動，並表達長期銘記的原因。"
      },
      {
         "題目":"在我認識的人當中，他最能體現「嚴以律己，寬以待人」的美德。試寫作文章一篇，描述這位人物的言行。",
         "題解":"此人對自己要求嚴格（如守時守信），對他人卻寬容體諒（如不計較過失），展現高尚品格。",
         "方向":"學生應舉具體事例（如他如何處理自己的錯誤與別人的失誤），對比其對己對人的差異，並表達對這種美德的敬佩。"
      },
      {
         "題目":"「經過這件事，我才明白到一心是我的知己，是真正了解我的人」，試撰文一篇，記述事件經過，並抒發體會。",
         "題解":"某個關鍵事件讓主角確認一心的知己身份。知己的特質可能在困境中顯現（如默默支持、理解難處）。",
         "方向":"學生需描述事件（如被誤解或失敗時），重點刻畫一心如何展現理解與支持，從而帶出「真朋友」的定義。"
      },
      {
         "題目":"我是一套校服，今日要和主人分離，回想過去我們一起生活，別有一番體會。以上是文章的開首，試以「校服的自述」為題，續寫這篇文章。",
         "題解":"校服以第一人稱回憶與學生的朝夕相處，見證其成長點滴（如課堂、比賽），離別時充滿不捨。",
         "方向":"學生應從校服視角描述校園生活片段（如被墨水弄髒、雨天共用傘），透過日常小事帶出對青春歲月的懷念。"
      },
      {
         "題目":"試以「一次令我百感交集的聚餐」為題，寫作文章一篇。",
         "題解":"聚餐中交織複雜情緒（如喜悅與感傷），可能因久別重逢、化解心結或面臨離別。",
         "方向":"學生可描寫聚餐場景（如家族團聚、同學會），透過對話與互動展現情緒變化（如歡笑中暗含淚光），並抒發人生無常的感悟。"
      },
      {
         "題目":"「偶然，我抬頭一看，發現嫩葉長出來了。原來我們忽略了不少日常生活中的美好。」以上描述中「原來我們忽略了不少日常生活中的美好」，引發了你怎樣的聯想或思考？試結合生活，寫作文章一篇。",
         "題解":"嫩葉象徵被忽視的微小美好（如家人問候、街角花草），提醒我們放慢腳步感受生活。",
         "方向":"學生可從自然景象聯想到生活事例（如母親煮早餐的日常），對比「忽略」與「發現」的差異，並強調用心觀察的重要。"
      },
      {
         "題目":"試以「我最想尋回的一件玩具」為題，寫作文章一篇。",
         "題解":"玩具承載童年回憶與情感（如爺爺所贈、代表友誼），遺失後成為心中缺憾。",
         "方向":"學生應描述玩具的外觀與來歷，說明它背後的珍貴回憶（如玩伴時光），並抒發對純真歲月的懷念。"
      },
      {
         "題目":"試以「藏在泥土中的寶物」為題，寫作文章一篇。",
         "題解":"寶物可能是實體物品（如時光膠囊）或抽象價值（如被埋沒的努力），挖掘過程象徵發現隱藏的美好。",
         "方向":"學生可寫實際挖掘經歷（如園藝發現舊物），或比喻性故事（如重新認識某人的優點），強調「深入探索」的意義。"
      }
   ],
   "開放":[
      {
         "題目":"試以「旁觀」為題，寫作文章一篇。",
         "題解":"旁觀指置身事外觀察事件。圖像可能呈現旁觀者的視角，引發對「主動參與」與「被動觀察」差異的思考。",
         "方向":"學生可從圖像聯想到生活情境（如街頭事件、網絡爭論），分析旁觀的利弊（如保持客觀但可能冷漠），並提出個人觀點。"
      },
      {
         "題目":"日常生活中，有各式各樣的舞台。試就個人的想像或思考，以「舞台」為題，寫作文章一篇。",
         "題解":"舞台不只是表演場所，也比喻人生場景（如課堂、職場）。每個人都在特定舞台上展現自我。",
         "方向":"學生可描述具體舞台（如比賽場地），或抽象比喻（家庭是溫暖舞台），探討舞台如何塑造角色與責任，並寫出對「尋找自己舞台」的體會。"
      },
      {
         "題目":"樹木依賴「根」來吸收養分，支撐自己，人也有自己的「根」。試就個人想像或思考，以「根」為題，寫作文章一篇。",
         "題解":"人的根可能是家庭、文化或成長地，它提供歸屬感與力量來源，影響身份認同。",
         "方向":"學生可從自然之根聯想到自身根基（如祖母的故事、家鄉味道），說明「根」如何形塑自己，並抒發對根源的珍視。"
      },
      {
         "題目":"在日常生活中，有各種各樣的計算，如衡量事情的好壞得失和暗中謀劃事情。試就個人的想像或思考，以「計算」為題，寫作文章一篇。",
         "題解":"計算包含實際運算（如數學題）與生活抉擇（如時間分配）。過度計算可能失去人情味。",
         "方向":"學生可舉生活實例（如買東西比價、朋友計較付出），探討計算的合理性與局限，並提出「真誠比算計更重要」的觀點。"
      },
      {
         "題目":"試以「山頂」為題，寫作一篇文章。",
         "題解":"山頂象徵目標達成或視野開闊。登頂過程需付出努力，但風景值得一切艱辛。",
         "方向":"學生可寫實際登山經歷，或比喻人生挑戰（如考試、追夢），描述堅持到頂的過程與俯瞰全局的體悟。"
      },
      {
         "題目":"「種子」雖是平常事物，卻可以引起聯想，或牽動思緒，又或啟發思考。試以「種子」為題，就個人體會寫作文章一篇。",
         "題解":"種子代表希望與潛能，小小一顆能長成大樹。它提醒我們重視微小開端與耐心培育。",
         "方向":"學生可寫種植經驗，或引申為夢想萌芽（如學畫畫的起點），強調「用心栽培終有成果」的道理。"
      },
      {
         "題目":"人生中必然有過大大小小的疤痕；有些仍看得見、觸得到，但已不痛不癢；有些雖然看不見、觸不到，卻刻骨銘心。試以「疤痕」為題，就個人思考或體會，寫作文章一篇。",
         "題解":"疤痕是受傷癒合的痕跡，分有形（身體傷疤）與無形（心理創傷）。它記錄過去但不一定帶來痛苦。",
         "方向":"學生可描述疤痕故事（如跌倒留疤、被背叛的陰影），寫出傷痛如何隨時間淡化，或疤痕如何成為成長印記。"
      },
      {
         "題目":"在人生路上，面對各種困境，我們都能泰然處之嗎？試以「泰然處之」為題，寫作文章一篇。",
         "題解":"泰然處之指冷靜面對困難。但保持平靜並不容易，需練習與智慧。",
         "方向":"學生可舉自身經歷（如考試失利），分析保持泰然的好處（如清晰思考）與方法（如深呼吸），並承認「無法總是平靜」的真實性。"
      },
      {
         "題目":"有人因為堅持而走得更遠，有人因為有他人的陪伴而走得更遠，有人因為某個機遇而走得更遠。甚麽事物能使你走得更遠？試在「__________能使我走得更遠」補上一詞，並以此為題，寫作文章一篇。請把文題寫在原稿紙的第一行。",
         "題解":"填空詞代表推動個人前進的關鍵力量（如夢想、友情）。這股力量助人克服瓶頸，突破自我。",
         "方向":"學生需先補全題目，再說明選擇該詞的原因（如家庭支持度過低潮），並以具體事例描述它如何幫助自己「走得更遠」。"
      },
      {
         "題目":"等候巴士、等候朋友、等候考試結果。人生中，人們少不免等候。試以「等候」為題，就個人思考或體會，寫作文章一篇。",
         "題解":"等候是日常經驗，可能帶來焦躁或期待。如何度過等待時光反映生活態度。",
         "方向":"學生可寫不同等候情境（如醫院候診、等放榜），描述當下的心情變化（如不安到平靜），並提出「耐心觀察」或「利用等待時間」的觀點。"
      },
      {
         "題目":"有些「回憶」使人不堪回首，有些「回憶」使人回味無窮。試以「回憶」為題，就個人體會寫作文章一篇。",
         "題解":"回憶有苦有甜，痛苦記憶讓人成長，美好記憶溫暖人心。它們共同組成生命故事。",
         "方向":"學生可對比兩類回憶（如失敗的尷尬與旅行的歡樂），說明回憶如何影響當下選擇，並強調「接納所有回憶」的態度。"
      },
      {
         "題目":"在日常生活中，我們常因習慣、信仰、價值觀等不同而與他人產生矛盾。試以「矛盾」為題，就個人思考或體會，寫作文章一篇。",
         "題解":"矛盾源於差異，如長輩與年輕人觀念衝突。化解矛盾需理解與包容。",
         "方向":"學生可舉實例（如與父母爭執娛樂時間），分析矛盾根源，並探討「尊重差異」或「尋找共通點」的解決之道。"
      },
      {
         "題目":"「一個寒冷的冬天，幾隻刺蝟擠在一起取暖。由於牠們身上長滿了短刺，彼此戳痛了對方，所以不得不散開。可是，寒冷的天氣又驅使牠們擠在一起，同樣的事情重複發生，牠們終於明白；不要太近，也不要太遠，最好彼此保持一定的距離。」這個故事的道理仍然貫穿在我們的現實生活中，試就此寫一篇文章。",
         "題解":"刺蝟比喻人際關係的距離藝術。過近易傷彼此，過遠則失去溫暖，適度空間才能長久相處。",
         "方向":"學生可聯想生活情境（如朋友干涉隱私、家人過度關心），說明如何拿捏「親密」與「界線」，並提出保持適當距離的建議。"
      },
      {
         "題目":"「孩子不是等待被填滿的瓶子，而是盼望化作燃燒的火焰。」試就個人對這句話的體會，以「成長」為題，寫作一篇文章。",
         "題解":"比喻強調孩子有主動學習的熱情，而非被動接收知識。成長需激發內在動力。",
         "方向":"學生可對比填鴨式教育與自主學習經驗（如探索興趣），說明「火焰」如何助己突破限制，並反思教育應點燃熱情而非灌輸。"
      },
      {
         "題目":"試以「陽光與陰影」為題，寫作一篇文章。",
         "題解":"圖像可能展現光與影的共存關係。陽光象徵希望，陰影代表挫折，兩者皆為人生常態。",
         "方向":"學生可從圖像聯想到生活（如成功伴隨壓力），描述如何學習接納陰影（如失敗），並相信陽光總會再現的積極態度。"
      },
      {
         "題目":"有人在活動當中找到快樂，有人在大自然之中找到快樂，有人在某個時刻、場景之中找到快樂……，你在什麼之中找到快樂呢？試為「我在________之中找到快樂」補上一詞，並以此為題，寫作文章一篇。請把文題寫在答題簿的第一行。",
         "題解":"填空詞代表個人快樂來源（如閱讀、助人）。快樂常在簡單事物中，需用心感受。",
         "方向":"學生需先補全題目，再描述該事物如何帶來快樂（如畫畫時的專注感），並透過具體情境（如完成一幅畫）展現喜悅。"
      },
      {
         "題目":"「足印」雖是平常事物，卻可以引起聯想，或牽動思緒，又或啟發思考。試以「足印」為題，就個人體會寫作文章一篇。",
         "題解":"足印象徵走過的痕跡與影響。每個足印記錄成長步伐，也可能為他人指引方向。",
         "方向":"學生可寫沙灘留腳印的經驗，或比喻人生選擇（如升學決定），反思足印如何代表責任，並期許留下正向足跡。"
      },
      {
         "題目":"在日常生活之中，有各種各樣的禁區。試就個人的想像或思考，以「禁區」為題，寫作文章一篇。",
         "題解":"禁區可能是實際限制（如施工圍欄）或心理障礙（如不敢表達意見）。突破禁區需勇氣。",
         "方向":"學生可舉例討論禁區的存在意義（如保護安全），但過度設限可能阻礙成長，並提出「理性面對禁區」的觀點。"
      },
      {
         "題目":"以下段落節錄自詩歌《想想別人》：當你與人鬥爭時想想別人，別忘了那些想要和平的人。當你回家，回你自己的家時，想想別人，別忘了那些住在帳篷裏的人。當你想到那些遙遠的人們，想想你自己，然後說：「我希望自己是黑暗中的蠟燭。」試就你對這首詩歌的體會或聯想，以「想想別人」為題，寫作文章一篇。",
         "題解":"詩歌呼籲我們在關注自身時，也體諒他人處境（如弱勢者）。將心比心能讓世界更溫暖。",
         "方向":"學生可聯想生活實例（如抱怨飯菜時想農夫辛勞），描述「想想別人」如何改變行為（如減少浪費），並強調同理心的重要。"
      },
      {
         "題目":"在人生路上，面對各種處境，我們都能以微笑以對嗎？試以「微笑以對」為題，寫作文章一篇。",
         "題解":"微笑是面對困境的態度，但強顏歡笑可能壓抑真實感受。真誠的微笑需要內在力量。",
         "方向":"學生可舉例說明微笑的積極作用（如化解尷尬），也承認其局限性（如重大悲傷），提出「適時微笑」與「接納情緒」的平衡觀點。"
      },
      {
         "題目":"在生活中，人們有時會隱藏自己的秘密、情感、想法等等。試以「隱藏」為題，就個人思考或體會，寫作文一篇。",
         "題解":"隱藏可能為了保護自己或他人（如隱瞞病情），但過度隱藏會造成隔閡。",
         "方向":"學生可分析隱藏的利弊（如避免衝突但累積壓力），透過事例（如對朋友隱藏不滿）探討何時該坦誠、何時需保留。"
      },
      {
         "題目":"試以「得不償失」為題，寫一篇文章。",
         "題解":"得不償失指付出代價大於收穫（如熬夜賺錢卻傷身）。這種失衡常源於錯誤判斷或貪心。",
         "方向":"學生可舉個人或社會例子（如過度補習失去健康），分析導致「失大於得」的原因，並提出「衡量取捨」的解決之道。"
      },
      {
         "題目":"人生總有大大小小的選擇，無論選擇的結果如何，只要選擇時問心無愧，便已足夠。試以「無愧的選擇」為題，寫作文章一篇。",
         "題解":"無愧的選擇指做決定時對得起良心（如誠實考試）。結果未必完美，但過程心安理得。",
         "方向":"學生可描述面臨抉擇的情境（如幫助他人可能吃虧），說明如何堅持原則，並強調「良心比結果更重要」的價值觀。"
      },
      {
         "題目":"在白布鞋的污跡上繪畫花朵，活化破舊建為時尚藝術館，在緊湊的旅程上遇上暴風雨可享受片刻悠閒。世事無完美，能為事物或心境增添新的色彩，則事事皆美。試以「為不完美添色彩」為題，寫作文章一篇。",
         "題解":"不完美是生活常態（如物品瑕疵、計劃生變），但用創意或新視角轉化，能發現另類美好。",
         "方向":"學生可舉例（如雨天改為室內活動），描述如何主動為缺陷「添色彩」（如自製禮物代替貴重品），強調接納與創新的力量。"
      }
   ],
   "議論":[
      {
         "題目":"所謂「天行有常，立身有本。」意思是大自然運行有既定的規律，人立身處世有一定的原則。試談談你對「立身有本」的看法。",
         "題解":"「立身有本」指人應以固定原則（如誠信、仁愛）作為處世根基，類似自然規律的恆常性；題目要求探討此原則在個人或社會層面的價值與挑戰。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生可從個人層面（如：堅守本心面對誘惑）、社會層面（如：公義原則維護和諧）或哲學層面（如：天人合一思想）論證「本」的重要性。可引用歷史人物（如：文天祥守節）或現代事例說明，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣「立身有本」的實踐與意義發揮，言之成理即可。"
      },
      {
         "題目":"以下是你在社交網站的帖文：經過這件事，我才明白到接受比施予更需要勇氣。試撰文一篇，記述事件經過，並抒發你的體會。",
         "題解":"「接受」指接收他人幫助，常被視為被動行為；「施予」指給予幫助；題目探討為何接受需要更多勇氣，涉及自尊克服與依賴焦慮的心理挑戰。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生須選取個人經歷或社會現象為例（如：學業失敗接受援助），說明接受如何需要勇氣（如：暴露脆弱、面對社會眼光）。可對比施予與接受的心理差異，或從文化角度（如：東方面子觀念）分析，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣「接受比施予更需要勇氣」的體會發揮，言之成理即可。"
      },
      {
         "題目":"電視正播放着奧林匹克運會的開幕儀式。允行說：「這個開幕典禮何時才完？太浪費時間了！我更喜歡觀看各項賽事。」爸爸說：「開幕儀式對每一位參與者都十分重要，我是不會錯過的！」各人對「儀式」有不同看法。有人認為「人生在世，必須講究儀式。」你同意嗎？試撰文一篇，論述你的看法。",
         "題解":"「儀式」指具有象徵意義的正式活動（如：開幕式、成年禮），「講究儀式」強調其形式價值；題目要求探討儀式在現代社會的必要性與潛在問題。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生可同意或反對，從情感凝聚（如：儀式強化歸屬感）、文化傳承（如：傳統節慶）或批判角度（如：儀式流於空洞浪費）論證。可舉例奧運儀式、宗教典禮或日常習慣，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣「儀式」的價值與爭議發揮，言之成理即可。"
      },
      {
         "題目":"古人說：「君子不以人廢言。」意思是：君子不會因為某人的德行不好而不採納他的善意規勸。在現今社會，你是否同意「君子不以人廢言」？試談談你的看法。",
         "題解":"「以人廢言」指因說話者德行否定其言論；「君子不以人廢言」強調言論本身應獨立評價；題目探討此原則在當代的適用性與道德困境。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生可同意或反對，從知識領域（如：採納爭議人物的科學貢獻）、道德領域（如：拒絕偽善者說教）或社會案例（如：政治人物言論）分析。可引用歷史典故（如：曹操採納謀士建言）或心理學理論，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣「人」與「言」的分離性發揮，言之成理即可。"
      },
      {
         "題目":"有人說：「在現今社會中，我們難以活出真我。」你同意嗎？談談你的看法。",
         "題解":"「真我」指未被社會規範扭曲的本真狀態；「難以活出」暗示現代壓力（如：消費主義、社群媒體）對個人真實性的壓迫；題目要求辯證此困境的存在與解決。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生可同意或反對，從個人層面（如：職場人設）、社會層面（如：同溫層效應）或哲學角度（如：沙特存在主義）論證。可舉例網路文化或自身經歷，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣「真我」在現代社會的可行性發揮，言之成理即可。"
      },
      {
         "題目":"俗語說「有競爭才有進步」，也有人說「競爭無用」。試寫作文章一篇，談談你對「競爭無用」的看法。",
         "題解":"「競爭無用」指競爭在某些情境無助進步，甚至有害；題目要求探討競爭的雙面性，區分其適用領域（如：教育vs.藝術）。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生須選取立場，從負面影響（如：惡性競爭導致內捲）、替代方案（如：合作取代競爭）或領域差異（如：體育競技有益，創意工作無需）論證。可舉歷史事件（如：工業革命競爭）或心理學研究，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣競爭的效用與局限發揮，言之成理即可。"
      },
      {
         "題目":"有人認為「挫敗更有利孩子成長。」你同意嗎？試撰文一篇，論述你的看法。",
         "題解":"「挫敗」指適度失敗或挑戰；「更有利成長」強調其培養韌性與學習的作用；題目辯證挫敗在兒童發展中的價值與風險。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生可同意或反對，從教育理論（如：抗逆力培養）、實例分析（如：運動比賽失敗）或批判角度（如：過度挫敗致創傷）說明。可引用研究（如：心理免疫系統）或自身觀察，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣挫敗對成長的影響發揮，言之成理即可。"
      },
      {
         "題目":"試以「談玩物喪志」或「談玩物養志」為題，寫作文章一篇。",
         "題解":"「玩物喪志」用來形容沉溺於某樣事物，因而荒廢了應做的事。「玩物」本指玩賞的器物，「喪志」就是失去志氣的意思，而「養志」的意思正好與「喪志」相反，有培養志氣的意思。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生須選其一為立論基礎，嘗試說明「玩物」為人們帶來的影響是好是壞。學生可從個人成長的角度，說明玩物如何使自己得益，或可從歷史角度，舉例說明哪些人曾經「玩物喪志」，從而說明「玩物」的壞處。學生亦可列舉典故說理，或就個人體會說明，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣「玩物喪志」或「玩物養志」發揮，言之成理即可。"
      },
      {
         "題目":"一心的家人在討論人的本性。一心說：「人無有不善，水無有不下。」一心的姐姐說：「人之性惡，其善者偽也。」一心的弟弟說：「性無善無不善也。」各人對人的本性都有自己的看法。試以「本性之我見」為題，寫作文章一篇。",
         "題解":"「本性」指人性根本特質，題中三種觀點代表性善（孟子）、性惡（荀子）、無善無惡（告子）；題目要求探討人性本質及其在行為中的展現。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生可擇一或綜合論證，從哲學理論（如：儒家vs.西方人性論）、歷史案例（如：英雄與罪犯）或現代科學（如：神經科學研究）分析。可舉社會現象或個人經驗，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣人性本質的爭議發揮，言之成理即可。"
      },
      {
         "題目":"古語有云「天下皆知取之為取，而莫知與之為取。」意思是世人都知道索取可以獲得，而不知道給予也可以獲得。試談談你對這句話的看法。",
         "題解":"「與之為取」指給予也能帶來收穫（如：情感滿足、互惠關係）；題目辯證索取與給予的價值，強調後者常被忽略的積極面。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生可從個人層面（如：助人後的幸福感）、社會層面（如：慈善事業的影響）或經濟角度（如：禮物經濟）論證。可舉例志工服務或文化傳統（如：紅包習俗），學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣「給予即獲得」的哲理發揮，言之成理即可。"
      },
      {
         "題目":"試以「談嚴苛」或「談寬容」為題，寫作文章一篇。",
         "題解":"「嚴苛」指嚴格或高標準要求；「寬容」指包容與接納；題目要求探討二者在教育、人際或社會中的利弊與平衡。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生須選其一為立論基礎，嘗試說明其影響。可從管教情境（如：父母嚴苛vs.寬容）、歷史案例（如：法律嚴刑）或心理效果（如：寬容促進和解）論證。可舉自身經歷或社會事件，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣「嚴苛」或「寬容」的實踐發揮，言之成理即可。"
      },
      {
         "題目":"一心：「我一生努力工作，希望在事業上取得成功，光宗耀祖。」允行：「我不在乎別人的眼光，只在乎活得自在。」各人對人生有不同的追求。有人認為：「與其追求成功，不如追求幸福。」你同意嗎？試撰寫文章一篇，論述你的看法。",
         "題解":"「成功」多指外部成就（如：財富、地位）；「幸福」側重主觀滿足與自在；題目辯證二者優先級，探討人生目標的本質。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生可同意或反對，從價值觀比較（如：社會壓力vs.個人快樂）、實例分析（如：企業家與藝術家的選擇）或哲學框架（如：功利主義vs.存在主義）說明。可引用研究（如：幸福指數）或文化差異，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣成功與幸福的關係發揮，言之成理即可。"
      },
      {
         "題目":"「不做第一，也不做最後。」試談談你對這種處世態度的看法。",
         "題解":"此態度指中庸避險，避免極端（領先或落後）；題目探討其在現代社會的智慧與局限，涉及風險管理與創新壓抑。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生可從優點（如：減少衝突）、缺點（如：阻礙突破）或情境應用（如：職場vs.創意領域）論證。可舉歷史人物（如：道家思想）或自身觀察，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣中庸處世的合理性發揮，言之成理即可。"
      },
      {
         "題目":"有人說憤怒是壞事，有人說憤怒是好事，有人說處理憤怒的情緒需要智慧⋯⋯試以「談憤怒」為題寫作文章一篇，談談你對憤怒的看法。",
         "題解":"「憤怒」具雙重性，可為負面情緒（破壞關係）或正面動力（推動改革）；題目要求分析其本質與管理之道。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生可擇一或多角度論證，從生理基礎（如：腎上腺素作用）、心理影響（如：壓抑危害）或社會運動（如：民權抗爭）說明。可舉個人經驗或歷史事件，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣憤怒的價值與處理發揮，言之成理即可。"
      },
      {
         "題目":"試以「談知己」或「談敵人」為題，寫作文章一篇。",
         "題解":"「知己」指精神共鳴的夥伴；「敵人」可指實際對手或抽象逆境；題目探討二者在個人成長中的角色與轉化可能。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生須選其一為立論基礎，嘗試說明其意義。可從人際關係（如：知己提供支持）、挑戰價值（如：敵人促使進步）或哲學隱喻（如：內心敵人）論證。可舉文學典故（如：管鮑之交）或自身經歷，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣「知己」或「敵人」的影響發揮，言之成理即可。"
      },
      {
         "題目":"俗語說「萬般皆下品，唯有讀書高」，也有人說「讀書無用」。試寫作文章一篇，談談你對“讀書無用”的看法。",
         "題解":"「讀書無用」質疑傳統教育價值，強調實用技能或經驗勝於書本知識；題目辯證讀書在當代的意義與局限。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生可從批判角度（如：學用落差）、辯護角度（如：讀書培養思維）或平衡觀點（如：區分「死讀」與「活讀」）論證。可舉社會現象（如：高學歷低就業）或歷史人物（如：自學成功者），學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣讀書的實用性發揮，言之成理即可。"
      },
      {
         "題目":"農曆新年，一心收到親戚送來的禮物。一心說：「每年都送來不合用的東西，不送也罷。」一心的姐姐說：「禮多人不怪。」一心的弟弟說：「千里送鵝毛，禮輕情意重。」各人對送禮都有自己的看法。試以「送禮之我見」為題，寫作文章一篇。",
         "題解":"「送禮」涉及實用性（一心）、形式性（姐姐）與情感性（弟弟）的衝突；題目探討送禮的本質與社會功能。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生可擇一或綜合論證，從文化傳統（如：禮儀規範）、心理需求（如：表達關懷）或批判視角（如：物質化扭曲）說明。可舉節慶習俗或自身經驗，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣送禮的意義發揮，言之成理即可。"
      },
      {
         "題目":"有人認為：「富足的物質條件有利孩子成長。」你同意嗎？試撰文一篇，論述你的看法。",
         "題解":"「富足物質條件」指超出基本需求的資源；題目辯證其對兒童發展的影響，區分益處（如：機會增加）與風險（如：動機減弱）。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生可同意或反對，從發展心理學（如：韌性培養）、社會案例（如：貧富差距研究）或教育實務（如：資源分配）論證。可舉實證數據或觀察，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣物質條件與成長的關係發揮，言之成理即可。"
      },
      {
         "題目":"模仿在生活中處處可見。當紅的偶像、著名的藝術品、成功的策略……，均可為模仿對象。有人認為：「模仿缺乏個性。」你同意嗎？試撰文一篇，論述你的看法。",
         "題解":"「模仿」指學習或複製他人；「缺乏個性」指控其壓抑原創性；題目探討模仿作為過程的價值與創新限制。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生可從必要階段（如：藝術家臨摹）、創造性轉化（如：模仿後創新）或批判角度（如：抄襲問題）論證。可舉歷史人物（如：畢卡索吸收非洲藝術）或科技領域，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣模仿與個性的平衡發揮，言之成理即可。"
      },
      {
         "題目":"向華：「遵守諾言是具誠信的表現。」幼羚：「我卻認為，有時候，放棄諾言也是負責任的行為。」試寫作文章一篇，談談你對以上兩個觀點的看法。",
         "題解":"「遵守諾言」強調誠信絕對性；「放棄諾言」指情境性破諾（如：為更大責任）；題目辯證承諾的倫理與彈性。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生可比較二者，從道德原則（如：誠信重要性）、實例分析（如：救命而爽約）或判準建立（如：動機評估）說明。可舉個人衝突或歷史事件，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣諾言的實踐與例外發揮，言之成理即可。"
      },
      {
         "題目":"有容：「行事要量力而為，否則沒有好結果。」修端：「要踏出舒適圈，才可以突破能力的界限。」試寫作文章一篇，談談你對以上觀點的看法。",
         "題解":"「量力而為」指風險控制；「踏出舒適圈」強調潛能開發；題目探討二者在個人成長中的張力與整合。",
         "方向":"題目提及的觀點為寫作方向的舉隅，學生可辯證平衡，從學習理論（如：成長區模型）、實例應用（如：運動訓練）或極端風險（如：盲目冒險）論證。可舉自身經歷或名人故事，學生的論述角度可以千變萬化，只要文章的立意、取材能緊扣能力發展的策略發揮，言之成理即可。"
      }
   ]
};










 // 試題庫資料
        const questionBank = {
            "version": "1.0",
            "created_date": "2025-01-12",
            "description": "DSE中文問答題六大題型試題庫",
            "question_types": {

 "選擇": {
                "description": "選擇題型，要求考生從多個選項中選擇正確答案。",
                "examples": [
                    {
                        "question": "試根據〈論仁、論孝、論君子〉，判斷以下陳述。<br>(1) 孔子認為當父母犯錯時，子女應直接地指出他們的過錯。<br>(2) 孔子認為子女供養父母時，不存恭敬的心，便應感到羞恥。",
                        "options": [
                            "(1) A正確 (2) A正確",
                            "(1) A正確 (2) B錯誤", 
                            "(1) B錯誤 (2) A正確",
                            "(1) B錯誤 (2) B錯誤"
                        ],
                        "year": "2025",
                        "answer": "C",
                        "answer_text": "(1) B錯誤 (2) A正確",
                        "steps": "根據〈論仁、論孝、論君子〉的內容判斷：<br>(1) 孔子主張子女應『幾諫』，即委婉規勸，而非直接指出，故為錯誤；<br>(2) 孔子強調『不敬，何以別乎』，認為無敬意與犬馬之養無異，故為正確。"
                    },
                    {
                        "question": "「克己復禮為仁」一句中，「克己復禮」是甚麼意思？",
                        "options": [
                            "生活節儉，便能合於禮",
                            "克服自身的弱點，使言行都合於禮", 
                            "克制私慾，使言行都合於禮",
                            "不合禮法者，一概不看、不聽、不說、不做"
                        ],
                        "year": "2025",
                        "answer": "C",
                        "answer_text": "克制私慾，使言行都合於禮",
                        "steps": "分析『克己復禮』的含義：『克己』指克制自己的私慾，『復禮』指使行為符合禮法，C選項最準確地概括此意。"
                    },
                    {
                        "question": "綜合全篇，以下哪些對仁者的描述是正確的？<br>(1) 仁者能長期處於窮困或安樂的環境之中。<br>(2) 仁者明白實行仁德的好處，於是實行仁德。<br>(3) 仁者能時刻堅持仁德。<br>(4) 仁者能克制私欲。",
                        "options": [
                            "(1)、(2)",
                            "(1)、(3)、(4)",
                            "(2)、(3)、(4)",
                            "以上皆是"
                        ],
                        "year": "2025",
                        "answer": "D",
                        "answer_text": "以上皆是",
                        "steps": "根據文本：(1) 『不可以久處約，不可以長處樂』反向理解，仁者能適應環境；(2) 『知者利仁』表明仁者知仁之益；(3) 『無終食之間違仁』顯示堅持仁德；(4) 『克己復禮』指克制私慾，故全對。"
                    },
                    {
                        "question": "作者以狸狌比喻哪一類人？",
                        "options": [
                            "善於用大的人",
                            "自作聰明，好表現自己的人",
                            "不能明辨是非黑白的人",
                            "懷才不遇的人"
                        ],
                        "year": "2025",
                        "answer": "B",
                        "answer_text": "自作聰明，好表現自己的人",
                        "steps": "根據《逍遙遊》，狸狌『東西跳梁』，最終『死於罔罟』，象徵自以為聰明卻自陷困境的人，B最貼切。"
                    },
                    {
                        "question": "「今夫斄牛，其大若垂天之雲；此能為大矣，而不能執鼠」中運用了甚麼修辭手法？<br>(1) 對偶 <br>(2) 比喻 <br>(3) 誇張 <br>(4) 對比",
                        "options": [
                            "(1)、(4)",
                            "(2)、(3)",
                            "(1)、(2)、(4)",
                            "(2)、(3)、(4)"
                        ],
                        "year": "2025",
                        "answer": "B",
                        "answer_text": "(2)、(3)",
                        "steps": "分析引文：『其大若垂天之雲』用比喻和誇張形容斄牛之大，無對偶或對比，故選B。"
                    },
                    {
                        "question": "作者記敘『宋人有善為不龜手之藥』的故事，有甚麼作用？",
                        "options": [
                            "凸顯宋人的形象",
                            "諷刺宋人以漂洗棉絮為業",
                            "帶出世人拙於用大",
                            "說明善於用大的重要"
                        ],
                        "year": "2025",
                        "answer": "C",
                        "answer_text": "帶出世人拙於用大",
                        "steps": "故事展示藥方從小用轉為大用，與惠子『無用而掊之』對比，突顯世人不懂大用之弊，選C。"
                    },
                    {
                        "question": "莊子論及『無用之用』，其意思是甚麼？",
                        "options": [
                            "雖似無所可用，卻因其無用而免遭禍害。",
                            "沒有用途的東西，假以時日亦有其用處。",
                            "雖似有所可用，卻因其有用而遭受禍害。",
                            "沒有用途的東西，經過磨練亦有其用處。"
                        ],
                        "year": "2025",
                        "answer": "A",
                        "answer_text": "雖似無所可用，卻因其無用而免遭禍害。",
                        "steps": "根據《逍遙遊》，『樗』因無用而不被砍伐，得享天年，A最符合此意。"
                    },
                    {
                        "question": "莊子認為『樗』有何用途？<br>(1) 可供人休憩 <br>(2) 可種在廣漠曠野 <br>(3) 可讓其他生物侵蝕 <br>(4) 可被人砍伐",
                        "options": [
                            "(1)、(2)",
                            "(1)、(3)",
                            "(1)、(2)、(4)",
                            "(2)、(3)、(4)"
                        ],
                        "year": "2025",
                        "answer": "A",
                        "answer_text": "(1)、(2)",
                        "steps": "文本指『樗』可『逍遙乎寢臥其下』及種於『廣莫之野』，(1)(2)正確，(3)(4)無據。"
                    },
                    {
                        "question": "以下哪些是荀子提倡的學習態度？<br>(1) 不斷累積 <br>(2) 不恥下問 <br>(3) 持之以恆 <br>(4) 專心一致",
                        "options": [
                            "(2)、(4)",
                            "(1)、(2)、(3)",
                            "(1)、(3)、(4)",
                            "以上皆是"
                        ],
                        "year": "2025",
                        "answer": "C",
                        "answer_text": "(1)、(3)、(4)",
                        "steps": "根據《勸學》：(1) 『積土成山』強調累積；(2) 無明確提及；(3) 『鍥而不舍』指持之以恆；(4) 『用心一也』指專心，選C。"
                    },
                    {
                        "question": "以下哪一項不符合本文的文意？",
                        "options": [
                            "以『木受繩則直，金就礪則利』為喻，論證學習可以使人變得聰明，行為不會有過錯。",
                            "以『登高而招』、『順風而呼』為喻，論證學習要憑藉有利的條件。",
                            "以『積土成山』、『積水成淵』為喻，論證學習要善於積累。",
                            "以『騏驥一躍』、『駑馬十駕』為喻，論證學習必須專一。"
                        ],
                        "year": "2025",
                        "answer": "D",
                        "answer_text": "以『騏驥一躍』、『駑馬十駕』為喻，論證學習必須專一。",
                        "steps": "文本用此喻強調堅持而非專一，D不符合文意，其他選項均正確。"
                    },
                    {
                        "question": "荀子以青和冰為喻，旨在說明甚麼道理？",
                        "options": [
                            "君子天生便是才德兼備，普通人無可比擬。",
                            "君子天生就比普通人突出，再加上學習便成為有才華的人。",
                            "君子本來亦無突出之處，只是經過學習才可發揮其才華。",
                            "君子本來亦無突出之處，只是經過別人的提醒才可發揮其才華。"
                        ],
                        "year": "2025",
                        "answer": "C",
                        "answer_text": "君子本來亦無突出之處，只是經過學習才可發揮其才華。",
                        "steps": "『青出於藍』、『冰寒於水』指學習提升本質，C最符合。"
                    },
                    {
                        "question": "文中段二不是用了以下哪項比喻來論述學習比天賦重要？",
                        "options": [
                            "登高而招",
                            "順風而呼",
                            "假輿馬",
                            "跂而望"
                        ],
                        "year": "2025",
                        "answer": "D",
                        "answer_text": "跂而望",
                        "steps": "D用以比喻思考不如學習，其他比喻強調借助外物，D不符主題。"
                    },
                    {
                        "question": "以下哪一項不是文中提及的治學態度和方法？",
                        "options": [
                            "學習應按個人的興趣與專長",
                            "學習需要不斷累積知識",
                            "學習需要專心一致",
                            "學習需要努力不懈"
                        ],
                        "year": "2025",
                        "answer": "A",
                        "answer_text": "學習應按個人的興趣與專長",
                        "steps": "《勸學》未提興趣與專長，其他均有提及，選A。"
                    },
                    {
                        "question": "作者在文中『金就礪則利』與下列哪一項的意思相近？",
                        "options": [
                            "真金不怕洪爐火",
                            "三人行必有我師",
                            "玉不琢不成器",
                            "遇強越強"
                        ],
                        "year": "2025",
                        "answer": "C",
                        "answer_text": "玉不琢不成器",
                        "steps": "『金就礪則利』指磨礪提升，與C『琢而成器』相近。"
                    }
                ]
            },

                "複述": {
      "description": "按題目要求結合文本內容作出忠實重述或語譯",
      "examples": [
        {
          "question": "《魚我所欲也》一文，孟子從正反兩方面論述「義」比「生」更為重要。試加以說明。（3分）",
          "year": "2022範文",
          "answer": "孟子從人的「好」和「惡」正反論證「義」比「生」重要。他指出如果「生」是最重要的，人會為了生存而無所不為，但人們卻會為了「義」而有所不為；而如果「死」是人們最厭惡的事情，那麼為了避免死亡，人便會無所不為，但是人們卻會為了「義」而不辭死，可見「義」比「生」更為重要。",
          "steps": "指出孟子以哪兩方面構成正反論證，並複述與正反論證相關的文本。"
        },
        {
          "question": "在白公作亂一事，申鳴面對什麼困境？（2分）",
          "year": "2021文言",
          "answer": "忠孝兩難全，白公以申鳴父親作人質威脅申鳴叛國，若救父而叛國，則屬於不忠；若不遵從，父親卻會因此喪命，如此就是「不孝」。",
          "steps": "先概括地指出其困境，再引文本，交代當時的情況，繼而分析申鳴有哪兩點難處。"
        },
        {
          "question": "申鳴面對困境又如何取捨？（2分）附：20. 在白公作亂一事，申鳴面對什麼困境？（2分）",
          "year": "2021文言",
          "answer": "他選擇了忠，而捨棄了孝。即為了不背叛國家，而放棄父親。",
          "steps": "先指出其選擇，再具體地解釋其選擇意味著甚麼。"
        },
        {
          "question": "就「賢士君子」的遭遇，作者提出什麼建議？試以自己的文句略加說明。（2分）",
          "year": "2020文言",
          "answer": "努力做好自己能勝任的工作，然後等待別人任用自己。",
          "steps": "文本語譯相關部份的文本"
        },
        {
          "question": "孔子會怎樣回應以上批評？試就有關章節或研習所得略加說明。（3分）附：3.(ii) 孔子說要做到「無違」和「不違」才是孝，但是有人批評在實踐時可能會有矛盾。試指出在什麼情況下兩者可能會有矛盾。（2分）",
          "year": "2019範文",
          "answer": "孔子會認為兩者實踐時沒有矛盾。「不違」父母的意願，乃是重孝的表現，而「無違」禮，乃是重義的表現。假如父母所為不合禮法，為人子女能委婉地規勸父母，且「勞而不怨」，要恭敬有禮，父母不遵從時，也不會埋怨。如此則可既不直接違反父母意願，又合乎禮法。",
          "steps": "先指出孔子會怎樣回應，再引用孔子的說話，分析他就這個矛盾的想法。"
        },
        {
          "question": "就《始得西山宴遊記》一文所述，作者在西山之巔所見的景物有何特別之處？試以自己的文句指出一項。（2分） 為什麼有關景物可使他從「恆惴慄」的心情中釋放出來？試略加說明。（3分）景物特別之處：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿說明：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿",
          "year": "2019範文",
          "answer": "西山四周的高山和盤地都變得十分渺小，就恍如蟻丘和小土窪一樣。因為作者從該些景物中得到體悟。作者本來在被貶官之後，時常憂讒畏譏，因而深感懼憚和不安；可是遊西山之後，他看見西山高崇巍然，特立不群，不與培塿山丘為類，故此他了解到若重視一己之得失，不過是世俗的境念，其胸懷和思想的卑微，如四周的小山一樣渺小。由此，作者體悟到執著於個人得失的不智，明白只有體悟大道，才能豁然開朗。",
          "steps": "直接語譯文本內容，解釋其景物的特別之處，再指出作者的心情得以釋放的原因，再作鋪墊，指出作者本來因何而「恆惴慄」，以及作者在西山看到甚麼景物，繼而解釋作者之所見為他帶來了甚麼新體悟，而該些體悟與作者的心情我以釋放又有何關係。"
        },
        {
          "question": "巷燕因為哪一件事才想起海鷗的話？試以自己的文句略加說明。（3分）",
          "year": "2019文言",
          "answer": "巷燕弄髒了巷人的熱湯，巷人為此感到憤怒，於是趕走燕子。",
          "steps": "文本語譯相關部份的文本"
        },
        {
          "question": "在《勸學》一文中，作者說「學不可以已」。試以自己的文句說明不斷學習的好處。（2分）",
          "year": "2018範文",
          "answer": "學習能提高自己的修養和品格，並使心智澄明，行為不會有過失。",
          "steps": "文本語譯相關部份的文本"
        },
        {
          "question": "在《出師表》一文中，諸葛亮認為重用郭攸之、向寵等人，會為「宮中」和「營中」帶來什麼好處？試以自己的文句分別說明。（4分）宮中：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿營中：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿",
          "year": "2018範文",
          "answer": "宮中：若宮中大小事務都咨詢他們，定能補其缺失，令政策更為完善。營中：能使軍隊上下和睦，優劣的人才也可以各得其所，並各展所長。",
          "steps": "文本語譯相關部份的文本"
        },
        {
          "question": "有些人不相信命運，他們有什麼理據？試以自己的文句說明。（2分）",
          "year": "2018文言",
          "answer": "他們認為能否富貴的關鍵取決於自身，它全憑個人的才幹和智慧，與命運沒有關係。",
          "steps": "文本語譯相關部份的文本"
        },
        {
          "question": "孔子被困於陳蔡之間，他有何表現？試舉一例說明。（3分）",
          "year": "2014文言",
          "answer": "孔子泰然自若，繼續講誦詩書和彈琴唱歌。",
          "steps": "文本語譯相關部份的文本"
        }
      ]
    },
                 "分析": {
      "description": "分析原因、關係、主題、道理、人際互動、情感等，解釋背後邏輯",
      "examples": [
        {
          "question": "作者（《聲聲慢》作者李清照）看到鴻雁後勾起甚麼愁緒？為甚麼？試加以說明。（4分）",
          "year": "2022範文",
          "answer": "勾起了詞人故國之思及身世飄零之嘆。首先，中原為外族所攻陷，清照流落南方，無法返回故鄉。而北雁南飛，仿佛是清照舊時相識，因此鴻雁使作者憶想故國往日美好的時光，徒添悲傷和悵然。其次，又勾起了詞人思念之愁緒。鴻雁本用於傳送書信，但清照與丈夫陰陽相隔，他永遠都不能收到書信，故使詞人思念丈夫，悲慟不已。",
          "steps": "先指出勾起的情緒，再以詞人當時身處的背景作鋪墊，分析「看到鴻雁」與其情緒有何關係。回應＋鋪墊＋解釋先指出勾起的情緒，再指出鴻雁的功用，然後分析「看到鴻雁」與其情緒有何關係。"
        },
        {
          "question": "就第4段，為什麼作者說讀好書、沉思、欣賞藝術等活動可以喚醒「精神性的自我」？試就個人的體會說明。（4分）",
          "year": "2022白話",
          "answer": "因為藝術能令人脫離現實和功利性思維。在現實生活中，人需要經常面對現實的問題，例如養家活兒，因此會變得功利，會考慮事情的結果和效益。這個時候，「精神性的自我」是沉睡的。不過，藝術的本質是美，不帶現實和功利的考慮，例如讀杜甫的《北征》能感受到其憂國憂民的高尚情操，讀李白的《夢遊天姥吟留別》能欣賞其恣肆浪漫，馳騁想像，這些都能使人對生命有更深刻的精神體會，這便是精神自我的醒覺。",
          "steps": "先指出藝術的功能，再指出「精神性的自我」在現實生活中為何是沉睡的，其後再舉出藝術的例子，分析該些例子有何「美」【解釋（第1步）】，繼而解釋該些「美」如何喚醒精神性的自我。【解釋（第2步）】"
        },
        {
          "question": "文言第一則，楚王遺失了弓，卻對下屬說不需要找回來，為什麼孔子仍說楚王不夠大公無私呢？試加以說明。(2分)",
          "year": "2022文言",
          "answer": "因為楚人未能一視同仁，仍會以國籍劃分他人。",
          "steps": "指出「不夠大公無私」的原因，再輔以具體的解釋。"
        },
        {
          "question": "有論者說「藏天下於天下」與「魚相忘於江湖」的寓意有相通之處。試就此說明，莊子為何認為只有「藏天下於天下」才不會遺失東西。（4分）",
          "year": "2022文言",
          "answer": "二者寓意相通之處在於應打破一切相對概念，以道為體。「藏天下於天下」指人應視萬物為道之一體，不以他物為己有，破除物我劃分，而「魚相忘於江湖」則指人應跳出自身的固有思維，不受當前窒息的困境影響通盤的思考，才能脫困並逍遙自由。可見，二者都旨在強調「我」執對人的思維的限制。而莊子認為只有「藏天下於天下」才不會遺失東西，是因為將天下藏於己是不可能的，無論我們將東西如何收藏穩固，亦經不起自然的力量，一場地震足以令我們遺失所有。反之，「遺失」是與「擁有」相對的概念，假如人能破除一切相對概念，不曾視天下為一己所「擁有」，便不可能「遺失」。",
          "steps": "先指出兩者寓意相通之處，再解釋「藏天下於天下」的寓意，以及解釋「魚相忘於江湖」的寓意，突出二者的同處。鋪墊＋鋪墊＋解釋先指出做不到「藏天下於天下」為何必然會「遺失」，再指出「藏天下於天下」背後破除概對概念的思想，其後藉此解釋如此才不會遺失東西的原因。"
        },
        {
          "question": "作者聽到友人的話後「愧乎其言」。你認為作者「愧」的原因何在？試抒己見。（4分）",
          "year": "2020文言",
          "answer": "首先，作者因自己分析問題時見小不見大而「愧」。作者只見友人不惜好筆，用於紀錄錢貨買賣等小事，為筆感不幸，卻未有留意「賢士君子」同樣被君子糟蹋。筆易得，而賢士君子難得；筆於國於民無所用，賢士君子卻能經邦治國。作者只見小事而蔽於大事，故「愧」。此外，作者為自己無力改變現象而愧。所謂「不在其位，不謀其政」，賢士君子不為世所用，而遭中傷或拋棄，只有君主才有能改改變現象，而作者只是一介文人，斷無用人之權，故他因痛惜感歎自己無力改變現象而愧。",
          "steps": "先指出作者慚愧的第一個原因，再引用文本，解釋作者如何見小而蔽於大。其後，再指出作者慚愧的第二個原因，並引用文本，指出賢士君子所面的困境，最後解釋作者如何因無力改變現象而愧。"
        },
        {
          "question": "就《始得西山宴遊記》一文所述，作者在西山之巔所見的景物有何特別之處？試以自己的文句指出一項。（2分） 為什麼有關景物可使他從「恆惴慄」的心情中釋放出來？試略加說明。（3分）景物特別之處：＿＿＿＿＿＿＿＿＿＿＿＿＿＿說明：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿",
          "year": "2019範文",
          "answer": "西山四周的高山和盤地都變得十分渺小，就恍如蟻丘和小土窪一樣。因為作者從該些景物中得到體悟。作者本來在被貶官之後，時常憂讒畏譏，因而深感懼憚和不安；可是遊西山之後，他看見西山高崇巍然，特立不群，不與培塿山丘為類，故此他了解到若重視一己之得失，不過是世俗的境念，其胸懷和思想的卑微，如四周的小山一樣渺小。由此，作者體悟到執著於個人得失的不智，明白只有體悟大道，才能豁然開朗。",
          "steps": "回應直接語譯文本內容，解釋其景物的特別之處，再指出作者的心情得以釋放的原因，然後作鋪墊，指出作者本來因何而「恆惴慄」，以及作者在西山看到甚麼景物，繼而解釋作者之所見為他帶來了甚麼新體悟，而該些體悟與作者的心情我以釋放又有何關係。"
        },
        {
          "question": "在第4段，為什麼作者說上帝要懲罰人類，有時候會產生一個道德家？試分析說明。（4分）",
          "year": "2019白話",
          "answer": "原因在於，道德家驕傲自大，以真理自居，因此他們往往會過份自我中心，為了完成其心目中的「偉大的理想」，甚至會以殘忍和罪惡的手段迫使他人服從，所以道德家的誕生和出現，會為人類帶來嚴重程度不亞瘟疫或戰爭的禍害，故作者說上帝懲罰人類，往往會產生一個道德家。",
          "steps": "先作鋪墊，指出道德家的特點，然後再解釋基於以上特點，他們會作出甚麼行為，最後則指出該些行為會帶來甚麼後果，藉此論述產生道德家與懲罰人類之間的關係。"
        },
        {
          "question": "「表」為臣下向君主進言的文體，內容多為事理的陳述和分析，惟《出師表》一文帶有明顯的個人感情。諸葛亮為什麼這樣寫？試舉一例說明。（4分）",
          "year": "2018範文",
          "answer": "其原因在於，感激先帝知遇之恩。諸葛亮敘述先帝當年三顧草廬，不嫌自己出身卑賤，請自己出山相助，甚至與自己商討國家大事，託付復興重責。所謂「士為知己者死」，諸葛亮出征前憶及前塵往事，因而在表中流露了真情。其次，諸葛亮目的在於明志。後主生性多疑，故容易受小人擺弄，誤會諸葛亮北征實有異心。故此，諸葛亮表述個人心志，謂自己本不求聞達，出仕只是為報答劉備知遇之因，且說明北伐中原，復興漢室，不過是奉先帝之遺詔，能令後主有感於先帝恩情，並體諒其志向，因而釋除疑慮，令北伐無後顧之憂。",
          "steps": "先指出諸葛亮為何要在《出師表》一文帶有明顯的個人感情，再引用有關文本，分析原因。"
        },
        {
          "question": "對「他」而言，為什麼「回家的路雖長總不比人生路漫長」？試就「他」孤單落寞的心情分析說明。（4分）",
          "year": "2018白話",
          "answer": "因為人生路比回家路更寂寞。「他」沒有出席婚禮，南下乘火車折返，雖然寂寞，但「回家的路」始終也有盡頭，旅程中的孤獨只在當下；反之，「他」的弟妹長大成家，老伴求去，其兒子亦結婚了，他把自己留在了自己的孤獨世界，因此他面對的人生路是無盡漫長的孤獨和寂寞，是無計可消除的。可見，回家的路不比人生路的漫長的原因在於，前者的孤寂可消除，而後者不可消除。",
          "steps": "先指出「回家的路雖長總不比人生路漫長」的原因，再引例分析回家的路為何長，然後再引例分析人生的路為何比回家的路更漫長。"
        },
        {
          "question": "在散步將要回程的時候，「他」對路人說「這是我的媳婦」。「他」說話的時候為什麼神情靦腆？試綜合全文分析說明。（4分）",
          "year": "2018白話",
          "answer": "因為他性格外冷內熱，不擅長表達自己的感受。「他」答應與媳婦散步，嘗試改變，打破自己與親人的隔膜，但由於過往對媳婦表現較冷漠，「他」不懂得開口表明自己重視媳婦，故借路人坦露心跡，然而開口後又不知道對方會怎麼想，因此感到難為情，所以說話時神情靦腆。",
          "steps": "先作鋪墊，指出「他」的性格，然後再敘述他的行為，並分析其行為背後的原因，最後指出該「他」做完該行為後的尷尬及憂慮。"
        },
        {
          "question": "本篇名為《孤獨的理由》，除了「孤獨是人生的宿命和基調」之外，「他」之所以孤獨，最主要的理由是什麼？試綜合全文分析說明。（4分）",
          "year": "2018白話",
          "answer": "「他」之所以孤獨，主要是因為失落了人生角色。年輕時，他為弟妹而放棄了自己的前途，為了家人，可以犧牲自己，家人的將來就是他人生中最明確的目標；到了不需要照顧家人的時候，他將人生的重點放在事業上，奈何以失敗告終。此外，又由於多年來與親人的關係較疏離，因此又無法融入兒子所建立的家庭，在新家庭中找不到自己的定位。由此可見，他在事業和新家庭中都找不到自己的方向，缺少了與外界連繫和溝通的角色，因此他將自己孤立起來，而孤獨就在分秒中累積，他人不能進入他的世界，了解他的心境，導致他活在孤獨之中。",
          "steps": "先指出其孤獨的主要理由，然後再引用文本，敘述「他」如何失落了人生的角色，最後解釋他失落角色與孤獨的關係。"
        },
        {
          "question": "承上題，按泥土的象徵意義，試說明「（我們）有了失去泥土的悲哀」的原因。（4分）",
          "year": "2016白話",
          "answer": "「失去泥土」象徵著「失去孕育故鄉情懷的條件」，作者之所以「失去泥土」，原因有兩個：其一，作者住在城市的大廈裡，已經遠離了故鄉的泥土，故難以植根；其二，作者生活在中國最富裕的年代，從來沒有經歷過戰爭，所以即使人在他鄉，亦難以建立對故鄉濃厚的情意。",
          "steps": "先指出「失去泥土」象徵甚麼，再指出作者「失去孕育故鄉情懷的條件」的原因。"
        },
        {
          "question": "你認為作者的父親期望兒子在家中種植番薯的原因是什麼？試綜合全文，加以說明。（4分）",
          "year": "2016白話",
          "answer": "作者的父親希望兒子能夠藉著種植番薯，銘記自己的鄉土。其父親在南洋作戰時，番薯的香氣使他憶想起故鄉，並因此覺得受到激勵，努力地生存。而戰後重返家鄉，又在家種了許多番薯。可見，在作者父親心目中，番薯是故鄉的象徵。而父親期望兒子在家中種植番薯，是因為他想將這份故鄉情懷一代又一代延續下去，使下一代不忘自己的故土。",
          "steps": "先指出其父親希望兒子在家中種植番薯的原因，再引述相關的文本，指出父親、故鄉及番薯之間的關係，最後分析期望兒子種植番薯與故鄉情懷有何連繫。"
        },
        {
          "question": "第3段寫大師聽到徒弟的話後「不禁微微一笑」，作者認為這可見名心之難除。為什麼？試略加說明。（3分）",
          "year": "2015白話",
          "answer": "大師為得道和尚，理應看破紅塵，不為名利心所縈繞，然而他卻因徒弟奉承而感到沾沾自喜，可見即使是大和尚，也有「好名」的念頭，修道的大和尚，猶且免不了好名，一般人更難做到，故名心之難除由此可見一斑。",
          "steps": "先作鋪墊，指出大師本應如何，然後分析其受到奉承之後實際的心情和反應，解釋由此如何得見名心之難除。"
        },
        {
          "question": "在第7段，作者引用第四年級某生同時讀「掮客術」及「宗教」一例，有何作用？（3分）又作者寫到「實在妙」，你認為「妙」的原因是什麼？試略加說明。（3分）   例子的作用：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿   「妙」的原因：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿",
          "year": "2015白話",
          "answer": "其作用在於突顯計時計分治學的弊病，乃在於使學生只知填滿時數、獲取學分，而不以真正問學為目標，故此不容易感受到讀書的樂趣及學有所成。認為「妙」的原因在於反諷。「掮客術」旨在教導他人取得最大的經濟效益，而「宗教」則導人向善，教人安身立命，兩門學問可謂大相徑庭。「妙」本是褒義詞，似乎在讚賞他，但作者卻褒詞貶用，藉此諷刺他違背真正的求學精神，即不以追求學問和修養為目標，只為充塞修課時數，而隨意選讀旨趣風馬牛不相及的學科。",
          "steps": "先指出其作用，然後具體解釋其作用何在。回應＋鋪墊＋鋪墊＋解釋先指出認為「妙」的原因何在，再作鋪墊，分別指出「掮客術」及「宗教」兩門學科的宗旨，其後再作一層鋪墊，指出「妙」字為褒詞貶用，最後透過解釋如何用「妙」作諷刺。"
        },
        {
          "question": "文末作者引翟公之言「一死一生，乃知交情」抒發對世情的感慨。試綜合全文，說明作者為何有此感慨。（6分）",
          "year": "2015白話",
          "answer": "作者有此感慨，原因在於讚歎杜一元和常允恭的友誼能跨越生死。所謂「一死一生，乃知交情」，是指人生在世，與心意相合的朋友生死相許不困難；然而死後，情誼淡薄，普通朋友往往未能顧念生前情誼，故人死後，才能盡見真交情。例如譚敬先本與常允恭交好，但在常氏去世後，即不顧念昔日情誼，不願意照顧常母。可見，「一死」能驗證其昔日「一生」交情之淺。反之，杜環的父親杜一元與常母之子常允恭雖然交好，但常母往杜家時，兩位兒子已逝世，情誼理應斷絕，但杜環卻因父親與允恭有交情，便一意奉養常母，即便家境貧困，亦在所不辭。由此得見，「一死」能驗證其昔日「一生」交情之深。藉此，作者生出「一死一生，乃知交情」的感慨，原因在於慨嘆世人多如譚敬先，並稱頌杜一元和常允恭的情誼實屬難能可貴。",
          "steps": "先指出作者感慨的原因，然後作鋪墊，指出「一死一生，乃知交情」的定義，繼而分別引譚敬先及杜環為例，藉此解釋作者之所以感慨的原因。"
        },
        {
          "question": "「健樂園」結業與曾先生的離去有很大關係，及後作者跟父親說起重遇曾先生一事，從曾先生的回應可見父親對曾先生的態度是怎樣的？試說明父親態度如此的原因。（6分）",
          "year": "2014白話",
          "answer": "父親態度淡然，原因之一是他已經預料到曾先生的下場。作者父親知道曾先生染有惡嗜賭的惡習，已預料到像他這類人，並不會有好下場。因此，曾先生風光不再，離開健樂園，生活潦倒，一切都在父親的意料之內，故此他得知健樂園及曾先生的下場，只覺平淡，而不覺詫異。",
          "steps": "先指出父親的態度，再引述文本內容，指出父親對曾先生的看法，然後分析該些看法與後來重遇曾先生後的態度有何關係。"
        },
        {
          "question": "作者為什麼不同意「今天，是你生命餘年中的第一日。」這句格言？試加以說明。（6分）",
          "year": "2013白話",
          "answer": "因為作者認為自己沒有足夠的時間去珍惜兒子。若說「今天，是你生命餘年中的第一天」，則旨在強調只要珍惜時間，每一日都是一個新的開始。然而，作者作為一個母親，心裡充滿著焦慮，想要愛護兒子，若說所有日子都可以是生命中的「第一天」，則不能突顯其對兒子愛之深。反之，若說「最後一天」，則能突顯作者作為人母的不安和沉重。由此可見，「第一天」一語過於樂觀，未能強調作者對兒子的愛意，故她並不同意。",
          "steps": "先指出作者不同意的原因，然後作鋪墊，解釋該句格言的含義，繼而分析作者想表達的感情，最後解釋「最後一日」如何切合及「第一日」如何不切合其想表達的感情。"
        },
        {
          "question": "承上兩題，晏子為什麼會有這兩種心情？試分別說明。（6分）  道別後：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿   回來後：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿",
          "year": "2013白話",
          "answer": "道別後：晏子感到失望，是因為晏子曾經濟北郭騷奉母之急，但他在落泊出走時向北郭騷道別，北郭騷卻表現冷淡，晏子認為他表現如此與自己失勢有關，故他覺得北郭騷忘恩負義，對他的人格卑下感到失望。回來後：晏子感到自責，是因為他得悉北郭騷為了替他洗白冤情而犧牲了自己的性命，因此他怪責自己沒有信任願意為他赴湯蹈火的北郭騷，早前反而將北郭騷看待成趨炎附勢之徒。",
          "steps": "引用文本，交代晏子曾為北郭騷做過甚麼，繼而指出北郭騷的表現，藉此解釋晏子為何因該表現而感到失望。引用文本，交代晏子得悉真相，繼而分析此事與他感到自責的關係。"
        },
        {
          "question": "第11段記述呂進文跨過羅湖橋進入祖國大地時，哭了，也笑了。為什麼他有「這哭笑之間的感情」？試略加說明。（6分）",
          "year": "2012白話",
          "answer": "首先，他哭的原因在於感慨。因為中國的動亂，他過往被迫遷到香港，飄泊異鄉，並做著一些底層工作，重投祖國大地的懷抱時，他興許憶想起自己多年來鬱鬱寡歡，未能實踐自己的理想，故為自己的志向未酬而落淚；而他笑的原因，則在於感動。如今他將信念付諸行動，重踏熟悉的祖國大地，並終於有機會實現自己的夢想，因此他憧憬著將來，為自己能向理想踏出重要的一步而感到高興，因而笑。",
          "steps": "先指出哭的原因，再引用文本，敘述他的經歷，然後分析該些經歷與他落淚的關係何在。回應＋文本＋解釋先指出笑的原因，再引用文本，敘述他的經歷，然後分析該些經歷與他笑的關係何在。"
        },
        {
          "question": "作者為什麼以「橋」為篇名？試從橋樑的象徵意義略加說明。（6分）",
          "year": "2012白話",
          "answer": "因為以「橋」命名能帶出本文的中心思想。首先，「橋」能連接和聯繫兩地，而本文的中心思想在於突顯作者和呂進文與祖國民族有不可分離的情感。文中不少篇幅都呈現了以上感情，例如作者敘述自己對平橋的念念不忘，又敘述了呂進文飄泊香港，卻無時無刻都有著「重歸之念」。「橋」有強烈的象徵意義，能象徵著人與祖國的聯繫，即使離鄉別井，但仍然心繫祖國，透過橋，可溝通民族不可分離的情感，故可以小見大，隱含出本文的中心主題，因此作者以此為篇名。",
          "steps": "先指出以「橋」命名的原因，再作鋪墊，指出橋的象徵意義，然後引用文本，交代本文的內容如何呈現中心思想和感情，最後則解釋從上述例子與以「橋」命名的關係何在。"
        },
        {
          "question": "綜合第4段內容，「我」對人生有何看法？試根據報紙報道的內容說明。（3分）",
          "year": "2021白話",
          "answer": "「我」認為人生是瑣碎無聊的。報道離不開夫婦新婚、瀆職和訃聞，等，這些都不離不開結婚、工作和死亡，可謂千篇一律。作者認為這些新聞都無法解悶，可見他覺得人生是庸俗且無聊的。",
          "steps": "先指出「我」對人生的態度，其後再引用報道內容，解釋從這些新聞如何得見作者的態度。"
        },
        {
          "question": "作者從愛蜜莉·狄瑾蓀的詩歌領悟到怎樣把個人心中的驕傲、孤獨與自戀放下。試根據詩歌的內容說明。（4分）",
          "year": "2021白話",
          "answer": "首先，作者從詩歌中露珠，領會到生命是渺小的。露珠之易晞，一如人生匆促，由此作者體悟到驕傲、孤獨和自戀都是沒有意義的，因為生命一旦結束，這些執著都將化為烏有。此外，作者又從露珠領悟到我執並無意義。詩歌中的露珠雖渺小，卻能滋潤一葉小草，圓滿和無私地映照大千世界，這使作者明白關懷世界的人事有何價值，因而能放下個人的我執，包括驕傲、孤獨和自戀。",
          "steps": "先作鋪墊，交代露珠為作者帶來甚麼體悟，再引用文本，具體說明露珠的特點，並解釋該特點引發的體悟如何令作者放下驕傲、孤獨和自戀。"
        },
        {
          "question": "8. 承上題，綜合上述經歷，作者對於競奔爭勝有什麼體悟？試略加說明。（4分）",
          "year": "2017白話",
          "answer": "首先，作者體悟到安於自己步伐的重要。作者提及跑步時要不受旁人的快慢節奏影響，要安於自己的速度。由此，作者明白到不必與其他人爭勝，向著自己的目標進發即可。其次，作者又體悟到超越勝敗的重要。他敘及幾個男孩從他身邊呼嘯而過，但人與人的力量和目標都不相同，勝負不容易論定。由此，作者明白於競奔中，爭勝並不是最重要的，重要的是怡然自得，好好享受當中的過程。",
          "steps": "先指出作者有何體悟，再引用與體悟相關的文本，具體解釋它如何導致作者有所體悟。"
        },
        {
          "question": "曾先生嗜辣，從中悟出什麼處世態度？（2分）曾先生的行事如何體現這種處世態度？試舉一例說明。（3分）  處世態度：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿   舉例說明：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿",
          "year": "2014白話",
          "answer": "他悟出自重的處世態度。例如餐廳雖然有酒，但曾先生從不貪婪，他不會似趙胖子他們時常白喝餐廳的酒，反而只會喝自己帶來的酒，可見他從不與他人同流合污，對自己的道德有所要求。",
          "steps": "回應指出其處世態度文本複述相關文本"
        },
        {
          "question": "在第6段，作者強調自己感到「遺憾」。承第9.(ii)題，試說明父親的「姿態」跟作者感到遺憾的關係。(4分)",
          "year": "2020白話",
          "answer": "首先，父親本身沉默寡言，導致做子女害怕親近他，對他有所畏懼，不敢有所發問，造成了兩代的隔閡。由於作者對父親的感情並不了解，所以沒有將他思念姥姥的一席話放在心上，即使父親逝世後他開始理解，亦為時已晚；其次，父親倏忽離世，沒有留下任何遺言，即使是在夢中出現都父親，都仍然緘默不語，所以連最後理解父親的機會都失去了，令錯失再也無法彌補，因此作者感到遺憾。",
          "steps": "先作鋪墊，指出父親的性格，然後再分析他的性格導致自己有何心態，最後解釋自己的心態與遺憾如何構成關係。鋪墊＋解釋先作鋪墊，指出父親離世後沒有留下遺言，以及在夢中亦沒有留下片言隻語，然後再解釋以上兩點與構成遺憾的關係。"
        },
        {
          "question": "本篇題為「夢中的父親」，卻在最後一段寫到母親種種，這是否偏離主題？試說明你的看法。（4分）",
          "year": "2020白話",
          "answer": "這並沒有偏離主題。本文的主題在於，敘述作者沒有好好關懷和了解父親，因而感到後悔，帶出及時盡孝的重要。而作者在最後一後寫及母親開始變得蒼老，既有父親在世的經歷作為前車之鑑，所以這次作者不希望自己再重蹈覆轍，要好好孝順母親。可見，雖然作者寫到母親，與「夢中的父親」關係不直接，但本段卻呼應了文章的主題，起強調的作用，使及時盡孝的主題更為突出，故此並沒有偏離主題。",
          "steps": "先指出這種寫法沒有偏離主題，再作鋪墊，指出本文的主題是甚麼，然後引用文本，概述複述作者在末段敘述了哪些關於母親的內容，然後解釋這些內容如何與主題產生關係。"
        },
        {
          "question": "作者（《六國論》作者蘇洵）以「抱薪救火」說明什麼道理？試以自己的文句說明。（3分）",
          "year": "2020範文",
          "answer": "作者以「抱薪救火」喻「以地事秦」的弊害。若抱著柴去救火，柴木未燒盡時，火亦不會熄滅，以此比喻六國若以事秦，只會無限助長秦國的野心。只要土地未全部割讓出去，秦國的野心便不會消滅，最後只會自取滅亡。",
          "steps": "先指出所說明的道理，然後再引用文本，交代作者以何為喻，最後則引用文本，指出作者藉上述比喻說明了甚麼。"
        },
        {
          "question": "承上題，君子的「不憂」與古仁人的「憂」對象各有不同，試任擇其一，說明對你的啟發。（3分）",
          "year": "2020範文",
          "answer": "孔子說君子不憂，其對象是指自己。君子內省不疚，會經常三思吾身，反省自己在行事上有沒有過失，一旦發現過錯，亦不會畏憚改正，努力向善，因此不會憂慮。這啟發了我，使我明白了釋除憂慮的方法。在日常生活中，有許多事情都是我們無法控制的，例如努力溫習後，成績卻不如預期等。但是，孔子說君子「不憂」，使我明白人可以為自己努力，所謂「我欲仁斯仁至矣」，為仁履義，是我們想實行便能實行的事情。因此，若我們將重點放在行善上，則不愧於天地，不會再受結果和其他人的批評影響，而感到憂慮和不快。",
          "steps": "先作鋪墊，解釋何謂君子不憂，然後再回應，直接指出對自己的啟發，再引用日常生活例子，解釋該句話如何啟發自己。"
        },
        {
          "question": "這則故事有何寓意？試以自己的文句略加說明。（3分）",
          "year": "2019文言",
          "answer": "這則故事提及海鷗無待於外物，不受人的愛憎所影響，能遠離人事，寓意為破除一切相對的觀念，才可在精神上逍遙自在。",
          "steps": "先作鋪墊，指出這則故事交代了甚麼內容，再藉此指出其寓意所在。"
        },
        {
          "question": "鏡神以「秦皇焚書」一例，說明什麼道理？試略加說明（4分）",
          "year": "2017文言",
          "answer": "秦始皇焚書，然而天下之書燒而不盡，根本是徒勞無勞。鏡神藉此說明，無心公毀鏡就像秦皇焚書，並沒有任何意義，因為天下間能夠反映形相容貌的事物殊多，即使毀掉鏡子，無心公的蓬頭垢面仍然會被映照出來。",
          "steps": "先作鋪堆，指出秦始皇焚書是沒有任何此義的，再作回應，直接指出鏡神引例想說明的道理，然後再透過比對毀鏡與焚書的相似，解釋其道理。"
        },
        {
          "question": "在第3段，作者列舉「石片」、「星星」、「地球」、「魚」和「鳥」五種事物，說明什麼道理？（3分） 試另擬一個可說明這道理的例子，並略加解釋。（3分）   道理：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿   例子：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿",
          "year": "2015白話",
          "answer": "事物各有自身的本性，只有在合適或特定的環境才能呈現其本色。例如一位擅長彈鋼琴但不擅長讀書的孩子，若在重視學術成績的家庭環境，他就將失去自信，無法發揮自己的音樂才能；反之，若置之在尊重個性的家庭環境，他就能發揮所長，透過鋼琴演奏發光發亮。",
          "steps": "回應指出其道理所在。例子（近於文本）＋解釋＋解釋先舉出一個例子，再解釋若將孩子放在不合適的環境有何後果，再解釋若將孩子放在合適的環境又有何後果。"
        },
        {
          "question": "綜合全文，聰明人有何聰明之處？（4分）作者對他又有何批評？（4分）試分析說明。聰明之處：_____________________________作者的批評：____________________________",
          "year": "2019白話",
          "answer": "(i) 其聰明之處在於圓滑機巧。當奴才向他訴苦時，他深明奴才的本性不會有勇氣反抗，對不合理的政權只是逆來順受，因此他只作空泛的安慰，對奴才表示同情，但卻沒有實質的濟助。同時，他亦不會對統治者有任何批評，只是靜觀時局變化。由此可見，其聰明之處在於，懂得運用語言技巧，達到明哲保身和置身事外的目的。既不開罪奴才，亦不得罪統治者，無論事件發展如何，他都不會惹禍上身。(ii) 作者認為聰明人是冷漠無情的。綜觀全文，雖然作者對聰明人沒有直接批評，但讀畢故事後，讀者卻能感受到作者刻意將聰明人刻劃成形象不討好的角色，當奴才向他訴苦時，他總是虛偽地表現自己似乎要掉淚，及以「你總會好起來」作空泛的回應，這些都反映了聰明人對奴才的遭遇是漠不關心的，他只考慮個人利益。這些負面的形象是作者著力刻劃的，因此從其致力刻劃其態度冷淡，可見作者認為聰明人是冷漠無情的人。",
          "steps": "先指出其聰明之處在於圓滑，再引用文本，陳述他如何安慰奴才，然後又引用文本，陳述他不批評統治者，最後解釋為何這種取態是一種聰明的做法。回應＋鋪墊＋文本＋解釋先指出作者對聰明人的批評是甚麼，然後作鋪墊，交代作者刻劃人物的方式與批評的關係，其後再引用文本，具體解釋這些形象的刻劃與反映了甚麼批評。"
        },
        {
          "question": "作者（《青玉案》作者辛棄疾）抒述了什麼情懷？他又怎樣抒述這種情懷？試綜合全文分析說明。（4分）",
          "year": "2018範文",
          "answer": "作者寓寫了自己的心境和抱負，不慕世俗的名利。作者在詞中寫及元宵燈市熱鬧的景象，有耀眼的煙花，亦有達官貴人的寶馬香女，仕女佩帶華麗的頭飾，笑語盈盈。在這一片昇平繁華的景象，作者卻不為所動，在燈火闌珊處，回首凝望心上人。藉此，作者抒述了自己絕不同流合污，孤芳自賞的情懷。",
          "steps": "先指出作者抒述的情懷是甚麼，然後再引用文本，指出作者在詞中描寫了甚麼景象及自己的行動，由此再帶出作者如何透過以上景象抒述自己的情懷。"
        },
        {
          "question": "作者「拋在腦後」一詞加上引號，有什麼作用？試根據文意略加說明。 （3分）",
          "year": "2017白話",
          "answer": "加上引號之後，能引起雙關的作用。一方面，它表示跑步時，風將頭髮吹到腦後，另一方面，亦可表示跑步能使人暫時忘卻煩惱，拋在腦後不去思想。",
          "steps": "先指出其作用，再解釋其表面的意義，以及其隱含的意義。"
        },
        {
          "question": "作者在文中藉敘述父親的身影，抒發了甚麼感情？",
          "year": "2016白話",
          "answer": "作者敘及自己在一片蔓生的葦芒花中難以察覺父親的身影，能突顯出葦芒花與父親的頭髮一樣灰白，從而抒發出自己未能察覺父親衰老的愧疚之情。",
          "steps": "作鋪墊，交代作者在葦芒花辨別不到父親的身影，再解釋由此可以突顯甚麼，從而指出藉此可以抒發甚麼感情。"
        },
        {
          "question": "在第7段，作者引用第四年級某生同時讀「掮客術」及「宗教」一例，有何作用？（3分）又作者寫到「實在妙」，你認為「妙」的原來是什麼？試略加說明。（3分）   例子的作用：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿   「妙」的原因：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿",
          "year": "2015白話",
          "answer": "其作用在於突顯計時計分治學的弊病，乃在於使學生只知填滿時數、獲取學分，而不以真正問學為目標，故此不容易感受到讀書的樂趣及學有所成。認為「妙」的原因在於反諷。「掮客術」旨在教導他人取得最大的經濟效益，而「宗教」則導人向善，教人安身立命，兩門學問可謂大相徑庭。「妙」本是褒義詞，似乎在讚賞他，但作者卻褒詞貶用，藉此諷刺他違背真正的求學精神，即不以追求學問和修養為目標，只為充塞修課時數，而隨意選讀旨趣風馬牛不相及的學科。",
          "steps": "先指出其作用，然後具體解釋其作用何在。回應＋鋪墊＋鋪墊＋解釋先指出認為「妙」的原因何在，再作鋪墊，分別指出「掮客術」及「宗教」兩門學科的宗旨，其後再作一層鋪墊，指出「妙」字為褒詞貶用，最後透過解釋如何用「妙」作諷刺。"
        },
        {
          "question": "承上題，作者記敘常伯章的行為，對於刻畫杜環的形象有什麼作用？試略加說明。（4分）",
          "year": "2015白話",
          "answer": "起了反襯作用。文中敘述了常母是常伯章的生母，血肉相連，但常伯章在得知生母消息之後，卻反應冷淡，甚至在常母年老時拋棄他，置之不顧；反之，杜環與常母非親非故，只因父親曾結交其長子，卻照顧她至死。作者藉刻劃常伯章的無情和冷漠，反襯了杜環重情義之難能可貴。",
          "steps": "先指出其作用，再作鋪墊，指出文中敘述了常伯章的哪些行為，然後再作一層鋪墊，再指出文中敘述了杜環的哪些行為，最後解釋以上兩者如何構成反襯。"
        },
        {
          "question": "第7段末句「倚欄望遠，頗有『我欲乘風歸去』之慨。」在結構上起了什麼作用？試略加說明。（3分）",
          "year": "2012白話",
          "answer": "起了承上啟下的作用。「倚欄遠望」呼應上文描寫香港大海的景物，指自己遠望上面所寫之景，可謂承上；而「頗有『我欲乘風歸去』之慨」一句，則暗示自己有重回祖國發展的理想，故謂啟下。",
          "steps": "先指出其結構作用，再融入文本，解釋它如何承上；然後再融入文本，解釋它如何啟下。"
        },
        {
          "question": "在文章開首，作者通過語言描寫，刻畫了父親因作者住在「無土」的房子而生的失望。除了語言描寫外，作者還通過哪方面的描寫刻畫父親的失望？試舉一例略加說明。（1分，2分）__________描寫（答案須是兩個字）例子：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿",
          "year": "2016白話",
          "answer": "神態描寫例如作者寫父親走的時候「落寞的說」，且刻劃了父親說話時的表情，突顯他的失望。",
          "steps": "回應直接指出是何種描寫手法文本概述與該種描寫手法的相關文本內容"
        },
        {
          "question": "作者以趙胖子突顯曾先生與別不同，這是什麼描寫手法？（2分）作者如何運用這種手法以趙胖子突顯曾先生與別不同？試舉一例說明。（3分）  描寫手法：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿   舉例說明：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿",
          "year": "2014白話",
          "answer": "描寫手法：反襯舉例說明：趙胖子白喝餐廳的酒而不付錢，貪小便宜；反之，曾先生只喝自己帶的酒，從不喝餐廳的酒，由此可以突顯曾先生的不貪心和自重。",
          "steps": "回應直接回應是哪種手法文本＋解釋引用文本，複述其他人與曾先生的行為，並分析如何反襯。"
        },
        {
          "question": "試說明作者怎樣運用這種寫作手法作扣連。（4分）",
          "year": "2013白話",
          "answer": "作者從方向盤聯想到《離騷》中馬車的玉駄。政客信誓旦旦，言之鑿鑿，以壯語許下諾言後，又改變了立場，不兌現先前的諾言，轉變之急就扭轉方向盤。作者從方向盤，聯想到《離騷》中千乘萬騎、並駕齊驅的玉駄。二者的相似之處在於激昂，政客違反誓言的急促與理直氣壯，在形象上與浩蕩轉彎的玉駄相似，故令作者產生聯想，扣連兩者。",
          "steps": "回應＋文本＋文本＋解釋先指出作者如何聯想，再引用文本，分別概述與第一個物象相關的內容以及與第二個物相關的內容，然後分析兩者相似的地方何在。"
        },
        {
          "question": "試說明《說誓》一文的主旨。（5分）",
          "year": "2013白話",
          "answer": "作者引用了古今中外的事例，諷刺現代人輕易立誓又輕易違反誓言，並給予忠告，勸告人們不要輕易相信誓言，且應該謹言慎行，不應隨便發誓。",
          "steps": "（不適用）"
        },
        {
          "question": "作者著意描寫香港的天橋，除了可具體突顯香港是個繁華的都市外，還有什麼目的？試略加說明。（3分）",
          "year": "2012白話",
          "answer": "目的在於借香港的繁華和文明，對比家鄉的純樸自然，暗示異鄉雖然物質豐盛和建設完善，但仍不及故鄉有情。",
          "steps": "先作鋪墊，指出這樣描寫如何構成對比，再指出該對比的作用。"
        },
        {
          "question": "「番薯的香味」在文中寄託了甚麼情思？",
          "year": "2016白話",
          "answer": "在南洋參戰：番薯的香味牽起父親對故鄉的情思，它寄託了父親對故鄉的思念，這種情懷是支撐著參戰的父親繼續努力生存下去的動力。戰後在家鄉父親在家種滿了番薯，一方面為預防戰爭時逃難而準備，另一方面則寄託了父親心繫故鄉，不忘鄉土。",
          "steps": "先作鋪墊，交代文本陳述了父親與番薯哪些內容，再解釋該些內容呈現了甚麼意義。"
        }
      ]
    },
         "印證": {
      "description": "結合文本／實例驗證觀點，或以故事、現實現象說明理論價值或意義",
      "examples": [
        {
          "question": "現今社會過於重視利益而引發不少問題，孟子提倡保育「本心」，重視人的「價值」，對現今社會有何提醒？試舉一個與教育相關的現象為例說明。（4分）",
          "year": "2022範文",
          "answer": "孟子提倡保育本心，提醒了人們教育應該「求其放心」，而不應導人功利。現今社會的學生以追求成績為讀書的唯一目標，不少家長和學校亦視成績比道德更重要。但在缺乏道德培養之下，學生容易在意個人的得失，為了達到目標，或會不擇手段，損人利己。而孟子提倡要保育「本心」，提醒了我們學習和教育的初衷，是提高人的道德修養，使更多人能夠成為君子，去關心社會，去修身立德。所謂「行有餘力，則以學文」，孟子提醒了人們不應過份重視利益，應重拾「本心」，透過教育使學生反省自身的行為及人生的意義。",
          "steps": "先指出孟子對現今社會有何提醒，然後作鋪墊，指出現今社會的教育有何問題，繼而解釋孟子提倡保育「本心」與解決現今社會教育問題有何關係。"
        },
        {
          "question": "第二篇末段，「揚棄」一詞兼具「發揚優點」和「拋棄缺點」的意思。就此說明第一篇中，「你」如何揚棄「我」和「他」，而成就更高的自我。（4分）",
          "year": "2022白話",
          "answer": "「你」能夠用超脫及體貼的眼光，去理解「我」在人生更本質的需要及關切、鼓勵我，因為「你」能夠使「我」在面對困境時對自己有自信，而這種自信能使人在做事前不會畏首畏尾，專注於自己所長，故能發揚「我」的優點；此外，「你」比「我」站得更高和看得更遠，它是更高的自我，因此它能節制「我」的本性，使「我」能夠能冷靜和客觀處事及反省自己，故能使「我」揚棄自己的缺點。",
          "steps": "先作鋪墊，指出與「你」能發揚「我」優點相關的文本內容，再根據其特點分析「你」如何能發揚「我」的優點；然後再引與「你」能使「我」拋棄缺點相關的文本內容，再根據其特點分析「你」如何能使我拋棄缺點。"
        },
        {
          "question": "《逍遙遊》（節錄）一文，莊子如何以樗樹為喻抒發對人生的感悟？試綜合有關內容說明。（4分）",
          "year": "2021範文",
          "answer": "《逍遙遊》一文中，樗樹的樹幹粗大，不合繩墨，而且樹枝彎曲，不中規矩。因此，本匠認為它「無用」而不砍伐它。不過莊子卻認為正因為它「無用」，才沒有人去砍伐它，使它得夠得享天年，這才是真正的「有用」。藉此，莊子想帶出我們不應受固有的世俗觀念影響，反而應該破除一切相對的概念，這樣才能活得逍遙自在。",
          "steps": "先作鋪墊，具體引出《逍遙遊》中與樗樹相關的文本內容，然後再解釋莊子想藉此抒發甚麼人生的感悟。"
        },
        {
          "question": "作者（《念奴嬌》作者蘇軾）藉「大江東去」抒發對人生的感慨。試就江水的意象說明。(3分)",
          "year": "2021範文",
          "answer": "作者在赤壁遠眺滾滾東逝的江水，江水能比喻永恆的時間，縱然周瑜曾經在赤壁大破曹軍，一時意氣風發，建不世之事業，但如今都不見任何痕跡，惟有江水流動不息。藉此，作者以江水的永恆長久，對比人生的虛幻短暫，抒述了功名之不可恃及人生如夢的感慨。",
          "steps": "先作鋪墊，闡明江水一喻有何含義，再解釋作者眺望江水的所思所想，然後指出作者藉「大江東去」抒發了甚麼感情。"
        },
        {
          "question": "作者（《念奴嬌》作者蘇軾）在詞的末句藉「江月」抒發對人生的感悟。試就月亮的意象說明。（3分）",
          "year": "2021範文",
          "answer": "作者從「江月」聯想到世事雖然如白雲蒼狗，變幻不定，但「江月」卻是永恆長存，即使時盈時虧，但終究照亮世間。由此，作者抒述人生在世不應執著成敗得失，反應以道心觀照世界，以人世之「變」為「不變」，如此才能活得逍遙自在。",
          "steps": "解釋作者看到江月的所思所想，然後指出作者藉江月抒發了甚麼感情。"
        },
        {
          "question": "承上題，文章又如何透過對比突顯上述批評？試加以說明。(4分)附：10.(ii) 綜合第4段內容，「我」對人生有何看法？試根據報紙報道的內容說明。（3分）悲觀、冷漠、傲慢",
          "year": "2021白話",
          "answer": "作者以小姑娘的重情對比「我」的冷漠和無情。文中，小姑娘打開車窗拋出橘子，反映了姑娘雖然年紀小小，便要離鄉別井，但心中仍然惦記著來送行的弟弟，可見她重情義；反之，作者卻因姑娘外貌的俗氣和服裝的邋遢歧視她，更在她打不開車窗時幸災樂禍。可見，文中以小姑娘的重情義，與作者自身的冷漠構成了對比，藉此突顯出自己的不仁，加強了自我批評的力度。",
          "steps": "先指出作者以哪者與作者的冷漠構成對比，再引用與姑娘重情相關的文本及與作者冷漠相關的文本，解釋透過這個對比如何突顯出上述批評。"
        },
        {
          "question": "申鳴以孝聞名於楚國。試在首段中舉出一例，並說明為什麼從這件事可見他重孝。（3分）",
          "year": "2021文言",
          "answer": "申鳴本來無意於入仕，只是一心留在父親身邊，希望侍奉他。但由於父親希望申鳴當官，能讓自己生活無憂，於是申鳴決定出任楚相。由這件事可以看出，申鳴願意放棄了自己的想法，做決定時以父親的意願和福祉為先，故可見其孝義。",
          "steps": "直接舉出一個能突顯申鳴孝義的例子，以回應題目；再從以上例子分析這件事情與如何體現出他重孝的形象。"
        },
        {
          "question": "孔子說要做到「無違」和「不違」才是孝，但是有人批評在實踐時可能會有矛盾。試指出在什麼情況下兩者可能會有矛盾。（2分）",
          "year": "2019範文",
          "answer": "假如父母的意願不合禮法，使子女陷於說謊或為公廢私的兩難，便有可能構成矛盾。",
          "steps": "指出該情況，再分析該情況如何構成矛盾。"
        },
        {
          "question": "《命解》一文說處事須「循其方，由其道」。若根據這個原則，應怎樣評價孫叔敖的行為？試分析說明。(4分)",
          "year": "2018文言",
          "answer": "根據《命解》的原則，應對孫叔敖的行為予以贊同。所謂「循其方，由其道」是指只要行為符合道德，不必在意命運的有或無。孫叔敖看見兩頭蛇，以為自己將死，可是他仍然擔心有人受害，於是殺掉兩頭蛇。由此可見，孫叔敖雖然相信命運，但沒有過於以命運為行事標準，反而貫徹和依遵道義，為別人的安危感到擔憂，從而殺死兩頭蛇。可見，他所為符合《命解》「循其方，由其道」的原則，故據上述原則，應對他的行為予以認同。",
          "steps": "先指出應作如何評價，再作鋪墊，指出「循其方，由其道」的意義，再作鋪墊，引述孫叔敖的行為，從而分析他的行為與題目所述的原則如何契合。"
        },
        {
          "question": "在第14段，作者寫到「這就是跑道：繁榮中有一種孤獨」。試綜合全文，說明句中的「繁榮」和「孤獨」分別指什麼。（6分）繁榮：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿孤獨：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿",
          "year": "2017白話",
          "answer": "繁榮：繁榮是指場上氛圍的熱鬧。在跑道場上有不少競爭者，例如有一家大小以及較力的男孩子，他們甚至會彼此鼓勵，讚賞陌生的跑手的耐力，或為其打氣及互相扶持。「繁榮」正指人數之多、氣氛之喧鬧及人情的濃厚。孤獨：孤獨是指跑道上無可依附。作者提及在跑道上，跑手看似是競爭者，但其實目標都不盡相同，能打敗或超越的只有自己，又指出跑道外的旁觀者插不上手，不能替跑手完成旅程。由此可見，跑道是孤獨的，跑手只能向著自己的目標進發，他人一概不可能干涉。",
          "steps": "先指出繁榮是指甚麼，再引用相關文本，交代在跑道上跑步的特點，再解釋該些特點如何見出繁榮。回應＋文本＋解釋先指出孤獨是指甚麼，再引用相關文本，交代在跑道上跑步的特點，再解釋該些特點如何見出孤獨。"
        },
        {
          "question": "季子禮的行事如何體現「人各以得行其志為適」？試舉一例加以說明。 （4分）",
          "year": "2016文言",
          "answer": "首先，「人各以行其志為適」是指各人按照自己的性情和志趣來行事，於是感到適意和舒暢。文中記敘季子禮於陡峭的山中建廬，雖然其他人認為此廬只足以遮風擋雨，根本不值得舉債而修飾，但季子禮卻稱之為「真吾廬」，視之為安身之所。可見，季子禮不受其他人的意見動搖，只依從自己內心的喜好行事，他因此感到自足，亦體現了「人各以行我其志為適」一句的含義。",
          "steps": "先指出「人各以行其志為適」的意義，然後再引述文本，敘述季子禮的行為及他人的看法，接著解釋為何以上事例能體現「人各以得行其志為適」。"
        },
        {
          "question": "在第3段，作者列舉「石片」、「星星」、「地球」、「魚」和「鳥」五種事物，說明什麼道理？（3分） 試另擬一個可說明這道理的例子，並略加解釋。（3分）   道理：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿   例子：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿",
          "year": "2015白話",
          "answer": "事物各有自身的本性，只有在合適或特定的環境才能呈現其本色。例如一位擅長彈鋼琴但不擅長讀書的孩子，若在重視學術成績的家庭環境，他就將失去自信，無法發揮自己的音樂才能；反之，若置之在尊重個性的家庭環境，他就能發揮所長，透過鋼琴演奏發光發亮。",
          "steps": "回應指出其道理所在。例子（近於文本）＋解釋＋解釋先舉出一個例子，再解釋若將孩子放在不合適的環境有何後果，再解釋若將孩子放在合適的環境又有何後果。"
        },
        {
          "question": "試從文中舉一個事例說明北郭騷「於利不苟取」。（3分）",
          "year": "2013白話",
          "answer": "北郭騷以奉養母親的原因求助於晏子，但由於無功不受祿，他只願意接受糧食，而謝絕了金錢，可見北郭騷沒有見利忘義，不貪婪，不苟取利益。",
          "steps": "引述與「於利不苟取」相關的文本，然後解釋以上例子如何契合「於利不苟取」。"
        }
      ]
    },
    "闡明": {
      "description": "闡明詩句／語句／結尾句等內在、深層意義，綜合全文提煉內核思想",
      "examples": [
        {
          "question": "在第4段，詩歌的末句說「半人半神走了，神就來了」，這句詩有何寓意？試綜合詩歌的內容說明。（4分）",
          "year": "2022白話",
          "answer": "「半人半神」中的「半神」是指能為愛情而放下名利，「半人」則指對愛情仍然存有執著，以為愛情是可以被擁有的。至於「神」，則指思想和人格上完全獨立自主，亦尊重對方的獨立自主，故能放下我執，即使愛人另結新歡，亦不去束縛對方。綜以上所得，這句詩的寓意在於勸告人們追求更高的境界，放下對身外人事的執著，才能成就精神層次更高的自己。",
          "steps": "先作鋪墊，指出「半神」及「半人」的含義，再作鋪墊，指出「神」的含義，然後綜合以上所得，解釋該句詩的深層寓意。"
        },
        {
          "question": "第二篇與第一篇內容的扣連十分緊密，第二篇的作者以下列文字收結全文，有何深意？試加以說明。(4分)我想，如果是幼稚的我站在一個命運必經的轉彎路口、列車隆隆駛過，我又該用什麼情懷，去接住姊姊從她的故事裏拋來的蜜柑呢？",
          "year": "2021白話",
          "answer": "其深意在於深化讀者對文章的體悟。首先，作者在這段文字上面轉述了與露珠相關的詩歌，由此，作者體悟到事物雖然渺小，但卻蘊藏著複雜的情感與價值，這一點使讀者放下了我執。而作者以上述文字收結，能進一步深化這種體悟。上述文字對自己發起疑問，想像自己若是那些送行的弟弟，接過感受姊姊竭力打開車窗拋來的橘子會有何感受，這可以引導讀者設身處地，一同思考和感受，藉此可牽起讀者對窮鄉姊弟的同情，從而呼應了上文的體悟，即再平凡渺小的人事，也會令人體會到複雜的感情和價值，領略人性的美善。可見，以上述文字收結，能夠呼應第二篇文章的主題和中心思想，使讀者從設想中，親身體悟到作者所帶出的道理。",
          "steps": "先指出作者有何深意，再作鋪墊，指出作者在上述文字前面帶出了甚麼體悟，然後又作鋪墊，指出上述文字提出了甚麼疑問。接著，需要解釋上述文字與第二篇的體悟有何關係，最後解釋這樣的呼應有何效果。"
        },
        {
          "question": "「第九味」指的是什麼？試綜合全文加以析述。（6分）",
          "year": "2014白話",
          "answer": "所謂「第九味」，是指一種無味之味。曾先生曾經貴為餐廳的大廚，地位尊崇，但後來卻淪落為小店廚子，生活潦倒，作者在第十段中，提及父親因為曾先生的起伏際遇，因而感慨平凡人自有平凡的樂趣，自有其甘醇的香味。由此可見，第九味是指嚐盡世間的甜酸苦辣之後，那種甘於淡泊和尋常的真味，亦即無味自有其味。除此之外，在第十二段中，作者又複述過曾先生的說話，指出真正入味之人，不在乎吃，大和尚能從一杯水中喝出大道理。由此亦可見，第九味並不是一種切實具體的味道，我們可理解為從平淡中體會人生真趣和道理的境界，亦即從無味中尋出味。",
          "steps": "先直接指出第九味所指的是無味之味，然後引用相關的文本，解釋該些文本內容如何證明第九味就是無味之味。接著，再引用一項文本內容，解釋該些內容如何證明第九味是無味之味。"
        }
      ]
    },
    "意見": {
      "description": "表達個人意見、探討文章立場值不值得欣賞、類比自身體會",
      "examples": [
        {
          "question": "有論者認為「盡孝論心不論行」，不應只憑結果判斷，故此申鳴未有違反孝的精神。你同意該論者的看法嗎？試加以說明。（4分）",
          "year": "2021文言",
          "answer": "我同意。首先，「盡孝論心不論行」是指考慮孝心多於行為所引致的結果，而申鳴其實只是為勢所迫，如救父則對國家君主不忠，置社稷安危於不顧，為一己之私而致使生靈塗炭，其實亦是陷父親於不義，若以結果判斷，亦屬不孝。可見，申鳴只是兩害取其輕，因此不當以結果論斷申鳴是否孝義。。再者，申鳴在放棄父親之後，亦感到愧疚而自盡，亦已見其孝義之心。孔子亦謂不敬之孝無別於犬馬之養，可見心中是否存有孝敬，才是判別之關鍵，而申鳴愧疚自盡，已足證明他心存孝義之心，故未有違反孝義精神。",
          "steps": "先表明立意，再作鋪墊，指出「盡孝論心不論行」的意思，然後解釋不應以結果論斷的原因，再引用文本，指出申鳴的愧疚與沒有違反孝精神的關係。"
        },
        {
          "question": "就諷刺文章而言，你較欣賞第一篇還是第二篇？試綜合全文，並就該篇的特點分析說明。（6分）",
          "year": "2019白話",
          "answer": "我較欣賞第一篇。首先，它諷刺的對象具有普遍性。面對不公平的剝削，一般人有三種取態：一是像「聰明人」，明哲保身，漠不關心；二是像「奴才」，選擇服從和不反抗；三是像「傻子」，選擇反抗，但卻被世人認為是愚蠢的，更見荒謬。一篇文章，一個故事，但同時能夠諷刺兩種不同形象的的對象，起一石二鳥之效，可見作者筆力之利害。其次，這篇文章以寓言形式書寫，能引起讀者深思。故事取材自日常生活，敘述奴才遭統治者剝削，這是許多人在生活中都會遇到的境況。面對熟悉的背景，讀者能夠代入其中，思考自己會作哪一種選擇。可見，文章能引起讀者反思面對不公平時冷漠無情和不反抗兩種取態的問題所在，大大深化了諷刺效果。",
          "steps": "先表明立場，然後解釋自己選該立場的原因，再引用文本，解釋從該些內容如何得見該文章在諷刺上的優點。然後再解釋自己選該立場的另一原因，再引用文本，解釋從該些內容如何得見該文章在諷刺上的優點。"
        },
        {
          "question": "本文以「跑道」為題，體悟卻不局限於跑道上。根據文中「跑道」的特點，就你個人對本文的體會，「跑道」可以比喻什麼？試說明你的看法。（4分）",
          "year": "2017白話",
          "answer": "「跑道」可比喻為人生的歷程。首先，作者指出跑手在跑場上會感受到「繁榮中有一種孤獨」，其實人生亦然。在人生中，我們會結識到朋友，他們會鼓勵和關懷我們，這就等如跑道上的繁榮。但同時，我們在人生中的孤獨的，正如畢業之後，同學們便會各奔前程，大家都有自己的將來及目標，每一個人都只能走自己的路，去砥礪自己，為自己的人生負責；此外，跑道的另一特點在於沒有規定的起點和終點，有些跑手的目標在一百米，有些可能在十公里。這一點亦與人生相像，人生的目標亦不必隨眾隨俗，每個人都有自己的性情和趣向，都有自己要努力的目標，或許有人想建立一個溫馨的家庭，或許有人想在事業上闖出一番成就。由此可見，跑道與人生都一樣，是繁榮中有一種孤獨，是沒有一致的目標，可見跑道可以比喻作人生。",
          "steps": "指出「跑道」可以比喻甚麼，然後作鋪墊，指出跑道的第一個特點，再分析它與人生歷程有何相似之處；然後再作鋪墊，指出跑道的第二個特點，再分析它與人生歷程有何相似之處。"
        },
        {
          "question": "作者認為「人各以得行其志為適」，你同意嗎？試舉生活例子，說明你的看法。（4分）",
          "year": "2016文言",
          "answer": "我同意這句說話。「人各以行其志為適」是指各人按照自己的性情和志趣來行事，於是感到適意和舒暢。例如孩子的興趣在於彈奏鋼琴，而不在讀書，若能讓孩子專注於發展音樂事業，他亦會感到自己的優點得以發揮，會努力向目標進發；反之，若不能「行其志」，要求他必須向學術方面發展，則會使他自信心受挫，亦會認為生活沒有意義。由此可見，每個人都有自己的優點、目標和理想，若能「行其志」，能做自己喜歡的事情，即使最後沒有成就，他們亦能在過程中感到愉悅；反之，他們便會因不能「行其志」而鬱鬱寡歡。",
          "steps": "先作鋪墊，指出「人各以行其志為適」的意思，然後舉出生活例子，從正反兩方面解釋「行其志」與「適」的關係。"
        },
        {
          "question": "「魯有父子訟者，康子曰：「殺之！」孔子曰：「未可殺也。夫民不知子父訟之不善者久矣，是則上過也；上有道，是人亡矣。」康子曰：「夫治民以孝為本，今殺一人以戮不孝，不亦可乎？」孔子曰：「不孝而誅之，是虐殺不辜也。三軍大敗，不可誅也；獄訟不治，不可刑也；上陳之教而先服之，則百姓從風矣，躬行不從而後俟之以刑，則民知罪矣。」承上第2與第3問。就學校教育學生而言，孔子和韓非子的看法何者較為理想？試略加說明。（6分）",
          "year": "2012文言",
          "answer": "我認為孔子的看法較為理想，因為它能令學生真正明白守法的本質。韓非子認為刑罰能夠管束人民，令他們因為畏懼受罰而不敢犯法。不過，法律有管束不到之處，亦有灰色地帶，人民若非自願守法，則會觸碰法律邊緣，在「守法」的前提下損害其他人的利益；反之，孔子主張教化，並以身作則，親身躬行。教化能夠使人民明辨是非，即使刑法管束不到，他們仍然會因為道義而是其是、非其非，而親身躬行則以德服人，能令他們心服口服，心甘情願守法。由此可見，孔子的想法較理想，因為他能使人民真正明白守法的意義所在。",
          "steps": "先指出何者的看法較理想，再解釋其原因，然後作鋪墊，引述韓非子的想法，再分析他的看法有何弊病；接著作鋪墊，引述孔子的想法，再分析他的看法有何優點。"
        }
      ]
    },
    "比較": {
      "description": "比較兩人、兩物、兩思想、兩作品異同，或將現象與現象作比對說明",
      "examples": [
        {
          "question": "在第2段，作者就「職業」是公認的人生依托，有些人卻稱之為「事業」。「職業」和「事業」有何不同？試以醫生為例說明兩者的分別。（3分）",
          "year": "2022白話",
          "answer": "「職業」是指循規蹈矩，將工作視為謀生工具，並以完成工作的基本職責和任務為目標。以醫生為例，即每日按時就診，為病人開藥，以賺取薪金或酬金生活；而「事業」是指在工作有遠大的志向，為實踐理想，能夠付上無限的熱誠。以醫生為例，即以救急扶危為己任，不論金錢的多少，注重拯救生命，甚或照顧病人的心理感受，有醫者的使命感。金",
          "steps": "先作鋪墊，指出「職業」的意義，再以醫生為例，解釋若醫生視工作為職業會有何表現；然後再作鋪墊，指出「事業」的意義，再以醫生為例，解釋若醫生視工作為事業又會有何表現。"
        },
        {
          "question": "文言第二則，為什麼作者說孔子還及不上老子，老子才是最大公無私的呢？試就孔子和老子的說話加以說明。（3分）",
          "year": "2022文言",
          "answer": "因為孔子所打破的只是人與人的界限，而老子打破的卻是人與物的界限，範圍更為廣大。孔子說要把楚人說話中的「荊」字刪去，表明了國籍不是重要的考量，對甚麼國家的人得弓，他並不在乎，可見他對所有人均一視同仁，但孔子仍然會區分人與物；而老子則說要將「人」字刪去，可見其天地萬物齊一的思想，不但打破了人和人之界限，更打破了物我界限，可見其大公無私的範疇更廣，境界更高。",
          "steps": "先透過比對二者的差異，指出其原因所在，再引文本中孔子的看法，分析其如何大公無私，然後引文本中老子的看法，透過分析與孔子看法的差異，指出其大公無私之境界如何高於孔子。"
        },
        {
          "question": "父親和作者的「疼」雖有不同原因，但卻有相同感覺，試略加說明。（4分）原因不同：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿感覺相同：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿",
          "year": "2020白話",
          "answer": "原因不同：父親因為生離而「疼」，而作者因為死別而「疼」。感覺相同：兩種「疼」都是不斷折磨人，令人無法喘息。",
          "steps": "回應指出原因不同之處回應指出感覺不同之處"
        },
        {
          "question": "《夢中的父親》中「那些和父親一樣的遊子」與王鼎鈞對故鄉的看法有沒有矛盾？試分析說明。（4分）",
          "year": "2020白話",
          "answer": "二者的看法有矛盾。那些遊子認為故鄉有固定之所，而王鼎鈞則認為故鄉並無固定之所。首先，《夢中的父親》那些遊子認為故鄉即指出生地，是一個具體的地點位置，只有唯一一個地方才能稱上是故鄉；而王鼎鈞則認為故鄉不是指涉一個特定的地點，因為久居異鄉即吾鄉，心所安處，異鄉亦可視作故鄉。其次，那些遊子認為故鄉是人生終點站，而王鼎鈞則不以為然。那些遊子覺得所有人都應該落葉歸根，在死後歸葬故鄉；但王鼎鈞則認為故鄉只是祖先流浪的最後一站，它是由異鄉演變而來的，所謂「此心安處即吾鄉」，因此故鄉未必是必須歸葬之所。",
          "steps": "先表明立場，再解釋有矛盾的原因，然後引述文本，解釋其看法，再引述另一文本，解釋其看法之差異；接著解釋有矛盾的另一原因，然後引述文本，解釋其看法，再引述另一文本，解釋其看法之差異。"
        },
        {
          "question": "《海鷗》一文寓意深遠，有論者指與孔子說「君子求諸己」或莊子「無用之用」的思想相通。試任擇其一，略述與本文是否有相通之處。（4分）",
          "year": "2019文言",
          "answer": "《海鷗》一文與莊子「無用之用」的思想相通處在於，打破一切相對的概念，才能逍遙自在。莊子提出「無用之用」，指出樗樹臃腫彎曲，不為木匠所取用，表面上無用，卻因此能全養天年，藉此指出「有用」和「無用」只是相對，「有用」是一種成見；而《海鷗》一文中，敘述燕子依人而處，人愛之，則保護燕子免受風雨侵擾；人憎之，則怒逐燕子。藉此帶出了愛憎亦是相對，會隨時間、環境和際遇等因素變化。可見，二文思想的相通之處，在於指出世間事物都是相對，只有超越相對主義的規限，像看通樗樹之有用，像海鷗無憎無愛，才能逍遙自在。",
          "steps": "指出二文相通之處，再引用《海鷗》的文本，分析它與破除相對概念的關係；然後再引用與莊子「無用之用」相關的文本，解釋它與破除相對概念的關係。最後，歸結二者的相通之處。"
        },
        {
          "question": "在第2段，作者以什麼事物比喻跑步的節奏？(1分)又這事物與跑步的節奏有什麼相似之處？試略加說明。（3分）比喻跑步節奏的事物是：＿＿＿（答案須是三個字）兩者相似之處：＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿",
          "year": "2018白話",
          "answer": "",
          "steps": ""
        },
        {
          "question": "假若把以下句子中的「繞出」改為「領略」，你認為表達效果會否更佳？試略加說明。（4分）心中充溢著對人事的不滿、對現世的埋怨時，我會從一圈圈的跑道中繞出屬於我的寧靜。（第11段）",
          "year": "2017白話",
          "answer": "不會。「繞出」比「領略」更為精煉。首先，用「繞出」屬於自己寧靜，已隱含了「領略」的意思。此外，「繞出」有圍著轉的意思，能夠與跑道的特點緊密扣連，更生動和更形象地刻劃出作者「繞」著跑道一圈圈奔跑時，變得寧願並梳理思緒的過程。若改為「領略」，則較為平鋪直敘，未能與「跑道」一題遙相呼應，失去了畫面感。",
          "steps": "先表明立場，再點出「不會更佳」的原因，然後解釋第一個原因，再作鋪墊，指出「繞出」的詞義，再根據其詞義分析「繞出」能夠產生甚麼表達效果。"
        },
        {
          "question": "鏡之工列十鏡於賈奩，發奩而視，其一皎如，其九霧如。或曰：「良苦之不侔甚矣。」工解頤謝曰：「非不能盡良也，蓋賈之意，唯售是念，今來市者，必歷鑒周睞，求與己宜。彼皎者不能隱芒杪之瑕，非美容不合，是用什一其數也。」予感之，作《昏鏡詞》。    引文中的鏡匠為符合買鏡者的心意，所製造的鏡子九塊朦朧而只有一塊清晰。引文及《全鏡文》均藉與鏡子有關的故事作諷刺，兩文所諷刺的人是否有共通之處？試略加說明。（4分）",
          "year": "2017文言",
          "answer": "二文所諷刺的對象有共通之處，兩者都是藉鏡子諷刺那些不能接受自己的缺點而自欺欺人的人。例如《昏鏡詞引》的買鏡者選擇朦朧的鏡子，是因為它可以掩蓋人的容貌的瑕疵；而《全鏡文》的無心公因從照鏡時發現自己容貌醜陋，於是遷怒於鏡子，而要毀鏡。其實，二人的問題都出於自身，與鏡子無關，因此他們所為都不過是掩耳盜鈴、自欺欺人的表現。",
          "steps": "先表明立場，再指出兩者諷刺的對象有何共通之處，然後引《昏鏡詞引》及《全鏡文》為例，分析二個人物如何自欺欺人，藉此帶出二文諷刺對象有相通之處。"
        },
        {
          "question": "作者以番薯喻人，也比喻父親。試綜合全文，指出番薯與父親的一個共同特點，並以父親的經歷或行事為例，加以說明。（4分）",
          "year": "2016白話",
          "answer": "二者共同的特點在於生命力強。番薯是一種粗生的植物，文中提及它即使在乾瘠的石頭地，都無需要下肥料和農藥，便可堅強和茁壯地生長，可見番茄的生命力頑強，粗生粗養；而其父親亦然，作者的父親到南洋打過幾年仗，只抱著三兩個番薯，便能在防空壕聽著戰爭的聲響，熬過艱苦的日子，並平安歸來。可見，作者父親能適應外在環境的變化，抵受艱苦，亦有頑強的生命力。",
          "steps": "先指出二者共同的特點，再引文本，解釋番薯如何具有頑強的生命力；然後再引另一文章的內容，解釋作者的父親又如何具有頑強的生命力。"
        },
        {
          "question": "作者在篇末寫到「女兒笑之，我亦笑之。」你認為兩人「笑」的原因有什麼不同？試略加說明。（3分）",
          "year": "2015白話",
          "answer": "女兒為石片重現光采而笑，而作者則為事物各適其適而笑。在文章中提及作者的女兒重回河灘，看到石片又再燦然亮麗，故以為沙礫重新活起來而笑；而作者則由石片明白到事物有自己的本性，只有將它們放在合適的環境，才能重現光采和活力，故為自己明白到重要的道理而笑。",
          "steps": "先指出二人的原因有何差別，再引用文本，解釋女兒緣何而笑；其後，再引用文本，解釋作者緣何而笑。"
        },
        {
          "question": "賈平凹《觀沙礫記》談及發揮才能的條件，林語堂《論趣》提出對教育方式的看法，你認為他們的看法有何相通之處？試略加說明。（6分）",
          "year": "2015白話",
          "answer": "二人相通之處在於要尊重人在性情趣向的差異，要順其性而行。例如賈平凹《觀沙礫記》提及石片停在河灘才有光采，就似魚不能不在水中，鳥不能不在雲際。可見，作者認為物各有性，只有放在合適的環境，才能使他們發揮自己的優點；而林語堂《論趣》則指出讀書必然要知趣，而人生必有癡，一定對趣有所偏好和癖嗜，由此得出讀書亦要考慮自己的性情興趣。可見，二文的作者的共通之處，在於尊重人的個性和趣向，不贊同機械和統一的教育模式。",
          "steps": "指出二者相通之處，再引文本，解釋其中一文的看法，然後再引文本，解釋另一篇文章的看法，最後歸納二者的相通處。"
        },
        {
          "question": "「鹹味」象徵哪種人？兩者有何相似之處？",
          "year": "2014白話",
          "answer": "鹹味尋常，就像平常人一樣普遍，到處皆可遇見。淡泊名利的人苦味較少人喜歡，不可兼日，就如淡泊名利，不是一般人所能承受。",
          "steps": "回應直接回應與甚麼人物相似解釋＋解釋先指出鹹味的特點，再指出這種特點與平常人有何相似。回應直接指出與甚麼人物相似解釋＋解釋先指出苦味的特點，再指出這種特點與平常人有何相似。"
        },
        {
          "question": "試根據孔子和弟子的對話，說明顏回較子路、子貢優勝之處。（6分）  <br>顏回較子路優勝之處：＿＿＿＿＿＿＿＿＿＿＿＿   <br>顏回較子貢優勝之處：＿＿＿＿＿＿＿＿＿＿＿",
          "year": "2014文言",
          "answer": "顏回較子路優勝之處：顏回對世情和大道的認識較為深刻，他早料到世俗不能容納夫子之道，因為其道宏大，自然非一般人能接受；而子路對世情和大道的認識則不夠深刻，他受世情影響判斷，懷疑堅持大道的方向是否正確。顏回較子貢優勝之處：顏回對夫子之道深信不疑，他認為孔子的主張不為君主所容納，不應視為夫子的恥辱，反而應視為治國者的恥辱；而子貢則信心不足，他認為夫子理想過於宏大，應降低自身的標準以迎合世俗。",
          "steps": "先指出顏回較子路的優勝之處，再解釋其想法；然後則指出子路不及顏回之處，再解釋其想法。回應＋解釋＋回應＋解釋先指出顏回較子貢的優勝之處，再解釋其想法；然後則指出子路不及顏回之處，再解釋其想法。"
        },
        {
          "question": "假若把第6段的末句改寫為下句以收結該段，對段旨的表達而言，是否更為理想？試略加說明。（6分）   <br>「今天早晨，我向你交出我可愛的小男孩，而你們將還我一個怎樣的呢？」",
          "year": "2013白話",
          "answer": "不會較理想。原句更能突顯出段旨的重點。首先，本段旨在抒發作者對兒子成長的擔憂，而原句以「我，一個母親」強調自己是一個母親，作者以母親的身分向子女的未來提出質問，比改寫後的句子更能突顯出母親對孩子成長的擔憂，呼應了段旨。此外，原句以感歎號為結，加強了對社會教育制度的質問和責難，從而突顯出自己的憂慮。假如以問號為結，則似乎只是提出一個較冷靜的疑問，情感不及原句強烈，故未能呼應段旨，突顯出作者憂慮之情的沉重。",
          "steps": "先表明立場，再解釋不會更為理想的原因，然後作鋪墊，帶出段旨所在，接著解釋原句「我，一個母親」的句式對表達段旨有何幫助及改寫後的句子為何達不到其效果。然後，再作鋪墊，指出原句與改寫後的句子另一個相異處，再解釋為何原句對表達段旨更理想。"
        },
        {
          "question": "戰國初,嚴仲子與韓相俠累有隙,仲子尋勇士刺俠累以報讎,聞聶政重信義,勇武過人,因殺人避禍,攜母隱於齊。遂赴齊拜訪,並備黃金百鎰為禮。政辭不受,暗許仲子為知己,惟老母在堂,故未敢以身報效。後,母辭世,始赴仲子處問其原委,遂孤身赴韓,刺俠累於相府。事成,自屠出腸而死。乙  儒家重「義」,簡言之,「義」即指超越個人的利害得失,以正當的方式去實踐仁。北郭騷和聶政均為他人捨棄生命，兩人的行事何者較合乎儒家的「義」？試比較說明。( 6分)",
          "year": "2013白話",
          "answer": "我認為北郭騷更符合儒家的「義」。首先，符合「義」的條件有二：一，超越自身的利害得失。北郭騷符合這條件，而聶政不符合。北郭騷為了齊國存亡而自盡，可謂以公忘私，為了實踐仁，置個人的生死和利害於不顧；反之，聶政雖然亦願意犧牲性命，但究其動機，不過是為報答嚴仲子，即出於一己私情，與仁無關。可見，北郭騷較符合「義」。二，以正當方式履仁。北郭騷符合這條件，而聶政不符合。北郭騷在捨生取義時，沒有傷及仕何無辜；反之，聶政與俠累本無積怨，他殺害無辜之舉並不能算「正當」。可見，北郭騷較符合「義」。",
          "steps": "表明立場，回應題目，再作鋪墊，指出符合「義」的條件，然後分析北郭騷如何符合「義」以及聶政如何不符合「義」；再作鋪墊，指出符合「義」的另一條件，然後分析北郭騷如何符合「義」以及聶政如何不符合「義」。"
        },
        {
          "question": "以下兩段文字分別描寫作者故鄉的平橋和香港的天橋，兩段文字描寫的手法有什麼不同？試略加說明。（4分）「我對橋有一種特別感情，這是童年時代培養起來的。家鄉是一個偏僻的小鎮，鎮郊有一個平橋塘，一潭碧水，橫架一座小木橋，每逢夏天，那兒就是我游泳嬉戲的地方。站在橋上，雙臂高舉，「撲通」一聲，跳入碧潭之中，常常游個半天，讓酷炙的太陽把潭水曬得燙了，才盡興地和小伴們跳躍地歸去。」（第1段）「香港有六十一條天橋，建築工程是浩大的，耗資港幣達七億元。天橋群貫通南北，為城市交通開闢了新的途徑。車如流水，行人如鯽，蔚為壯觀。我對橋有感情，因此常常偷閒去天橋漫步。我喜歡山道天橋，其中干諾道西一條天橋有支柱二十三條，長度達二萬多米。踏上工地一看。海港風光歷歷在目。另有一條在中環，長廊逶迤，寬闊而整潔，最堪留戀的是它面向大海，海風拂面，令人心曠神恰。海上有艨艟巨艦，有點點風帆；在浪濤飛濺、捲起千堆雪的遠處，則有海鷗飛翔，構成特有的海景。倚欄望遠，頗有「我欲乘風歸去」之慨。」（第7段）",
          "year": "2012白話",
          "answer": "前者為側面描寫，而後者為正面描寫。第一段沒有從正面下筆，寫家鄉的橋的形態和材質等，反而從側面下筆，敘寫作者自己與橋之間的回憶片段，以對往事的懷緬，側面烘托出橋的形象的美好；而後者則從正面下筆，分別交代橋的長度、結構和貫通方向等，都使讀者從文字直接了解橋的形象。",
          "steps": "先指出二者相異之處，再作鋪墊，指出作者沒有作正面描寫，然後引用文本，解釋作者如何側面描寫橋的形象，繼而再引文本，解釋作者如何正面描寫橋的形象。"
                        }
                    ]
                }
            }
        };

        // 全局變量
        var selectedQuestionTypes = new Set();
        var selectedTextId = null;

        // API 配置
        const API_URL = "https://chatapi.akash.network/api/v1/chat/completions";
        const MODEL = "DeepSeek-R1-0528";
        const API_KEY = "sk-O6GT79mshyCgqyaTaq60FA";

        // DOM 元素
        const generatorTypeRadios = document.querySelectorAll('input[name="generatorType"]');
        const generateBtn = document.getElementById('generateBtn');
        const progressModal = document.getElementById('progressModal');
        const resultContainer = document.getElementById('resultContainer');
        const mainContainer = document.getElementById('mainContainer');

        // 進度追踪變量
        let progressTimer = null;
        let startTime = null;
        let currentProgress = 0;

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            initializeEventListeners();
            updateConfigPanel();
            setupQuantityControls();
            generateTextLibrary();
        });

        function parseFormatting(text) {
            text = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            text = text.replace(/\*(.*?)\*/g, '<em>$1</em>');
            text = text.replace(/(?:^|\n)\s*-\s+(.*?)(?=\n|$)/g, '<li>$1</li>');
            text = text.replace(/(<li>.*<\/li>)+/g, '<ul>$&</ul>');
            text = text.replace(/(?:^|\n)\s*\d+\.\s+(.*?)(?=\n|$)/g, '<li>$1</li>');
            text = text.replace(/(<li>.*<\/li>)+/g, '<ol>$&</ol>');
            text = text.replace(/(?:^|\n)>\s*(.*?)(?=\n|$)/g, '<div class="indent">$1</div>');
            text = text.replace(/(?:^|\n)>>\s*(.*?)(?=\n|$)/g, '<blockquote>$1</blockquote>');
            text = text.replace(/\n/g, '<br>');
            return text;
        }

      function initializeEventListeners() {
    // 範疇選擇事件
    generatorTypeRadios.forEach(radio => {
        radio.addEventListener('change', updateConfigPanel);
    });

    // 主題選擇事件
    const topicSelect = document.getElementById('topicSelect');
    if (topicSelect) {
        topicSelect.addEventListener('change', () => {
            const customTopicGroup = document.getElementById('customTopicGroup');
            if (topicSelect.value === 'custom') {
                customTopicGroup.classList.remove('hidden');
            } else {
                customTopicGroup.classList.add('hidden');
            }
        });
    }

    // 數量滑桿同步（保持不變）
    const quantityRange = document.getElementById('quantityRange');
    const quantityInput = document.getElementById('quantity');
    if (quantityRange && quantityInput) {
        quantityRange.addEventListener('input', () => {
            quantityInput.value = quantityRange.value;
        });
    }

    // 生成按鈕事件（保持不變）
    generateBtn.addEventListener('click', handleGenerate);
}


        function setupQuantityControls() {
            // 設定所有數量控制
            const questionTypes = ['複述', '分析', '印證', '闡明', '意見', '比較'];
            questionTypes.forEach(type => {
                const input = document.getElementById(`quantity-${type}`);
                if (input) {
                    input.addEventListener('change', () => {
                        if (parseInt(input.value) < 1) input.value = 1;
                        if (parseInt(input.value) > 10) input.value = 10;
                    });
                }
            });
        }

        function generateTextLibrary() {
            const grid = document.getElementById('textLibraryGrid');
            grid.innerHTML = '';

            textLibrary.texts.forEach(text => {
                const item = document.createElement('div');
                item.className = 'text-item';
                item.onclick = () => selectText(text.id, item);
                
                item.innerHTML = `
                    <div class="text-item-title">${text.title}</div>
                    <div class="text-item-info">
                        <span>${text.author} · ${text.length}</span>
                        <span class="text-category">${text.category}</span>
                    </div>
                `;
                
                grid.appendChild(item);
            });
        }

     

        function selectText(textId, element) {
    if (selectedTextId === textId) {
        // 如果點擊已選中的範文，取消選擇
        element.classList.remove('selected');
        selectedTextId = null;
        document.getElementById('targetPassage').value = '';
    } else {
        // 清除之前的選中狀態
        document.querySelectorAll('.text-item').forEach(item => {
            item.classList.remove('selected');
        });
        // 選中新的範文
        element.classList.add('selected');
        selectedTextId = textId;
        const selectedText = textLibrary.texts.find(text => text.id === textId);
        if (selectedText) {
            document.getElementById('targetPassage').value = selectedText.content;
        }
    }
}

        function toggleQuestionType(toggleElement, questionType) {
            const isActive = toggleElement.classList.contains('active');
            const quantityControl = toggleElement.closest('.question-type-selection').querySelector('.quantity-control');
            
            if (isActive) {
                // 取消選中
                toggleElement.classList.remove('active');
                selectedQuestionTypes.delete(questionType);
                if (quantityControl) {
                    quantityControl.style.display = 'none';
                }
                
                // 隱藏自訂配置
                if (questionType === '自訂') {
                    document.getElementById('customReadingConfig').classList.add('hidden');
                }
            } else {
                // 選中
                toggleElement.classList.add('active');
                selectedQuestionTypes.add(questionType);
                if (quantityControl) {
                    quantityControl.style.display = 'flex';
                }
                
                // 顯示自訂配置
                if (questionType === '自訂') {
                    document.getElementById('customReadingConfig').classList.remove('hidden');
                }
            }
        }

        function adjustQuantity(questionType, delta) {
            const input = document.getElementById(`quantity-${questionType}`);
            if (input) {
                let currentValue = parseInt(input.value) || 1;
                currentValue += delta;
                if (currentValue < 1) currentValue = 1;
                if (currentValue > 10) currentValue = 10;
                input.value = currentValue;
            }
        }

        function adjustEssayQuantity(delta) {
            const input = document.getElementById('quantity');
            const slider = document.getElementById('quantityRange');
            if (input && slider) {
                let currentValue = parseInt(input.value) || 3;
                currentValue += delta;
                if (currentValue < 1) currentValue = 1;
                if (currentValue > 10) currentValue = 10;
                input.value = currentValue;
                slider.value = currentValue;
            }
        }

       function updateConfigPanel() {
    const selectedType = document.querySelector('input[name="generatorType"]:checked').value;
    
    // 隱藏所有配置面板
    document.getElementById('readingConfig').classList.add('hidden');
    document.getElementById('essayConfig').classList.add('hidden');
    document.getElementById('practicalConfig').classList.add('hidden');
    
    // 顯示對應的配置面板
    document.getElementById(selectedType + 'Config').classList.remove('hidden');

    // 更新選中狀態的視覺效果
    document.querySelectorAll('input[name="generatorType"]').forEach(radio => {
        const label = radio.nextElementSibling;
        if (radio.checked) {
            label.classList.add('selected');
        } else {
            label.classList.remove('selected');
        }
    });
}


        // 參考題目相關函數
        function addReferenceQA() {
            const list = document.getElementById('referenceQAList');
            const currentCount = list.querySelectorAll('.reference-qa').length;
            const newQA = document.createElement('div');
            newQA.className = 'reference-qa fade-in';
            newQA.innerHTML = `
                <div class="flex items-start space-x-4 bg-white p-8 rounded-2xl border-3 border-teal-200">
                    <span class="flex-shrink-0 w-12 h-12 bg-gradient-to-r from-teal-500 to-blue-500 text-white rounded-full flex items-center justify-center font-bold text-lg question-number">${currentCount + 1}</span>
                    <textarea class="flex-1 p-6 border-2 border-teal-200 rounded-xl focus:border-teal-400 focus:ring-0 transition-colors duration-300 resize-vertical" placeholder="在此輸入參考題目與答案"></textarea>
                </div>
            `;
            list.appendChild(newQA);
            updateReferenceNumbers();
        }

        function removeReferenceQA() {
            const list = document.getElementById('referenceQAList');
            const items = list.querySelectorAll('.reference-qa');
            if (items.length > 1) {
                items[items.length - 1].remove();
                updateReferenceNumbers();
            }
        }

        function clearReferenceQA() {
            const textareas = document.querySelectorAll('.reference-qa textarea');
            textareas.forEach(textarea => {
                textarea.value = '';
            });
        }

        function updateReferenceNumbers() {
            const items = document.querySelectorAll('.reference-qa');
            items.forEach((item, index) => {
                const numberSpan = item.querySelector('span');
                numberSpan.textContent = index + 1;
            });
        }

        // 從試題庫獲取參考範例
       function getQuestionBankExamples(questionType, count = 3) {
    if (!questionBank.question_types[questionType] || !questionBank.question_types[questionType].examples) {
        return [];
    }
    
    const examples = questionBank.question_types[questionType].examples;
    const selectedCount = Math.min(count, examples.length);
    const selectedExamples = [];
    const usedIndexes = new Set();
    
    while (selectedExamples.length < selectedCount) {
        const randomIndex = Math.floor(Math.random() * examples.length);
        if (!usedIndexes.has(randomIndex)) {
            usedIndexes.add(randomIndex);
            selectedExamples.push(examples[randomIndex]);
        }
    }
    
    // 為選擇題特別格式化
    if (questionType === '選擇') {
        return selectedExamples.map(example => {
            let formattedExample = `題目：${example.question}`;
            if (example.options && example.options.length > 0) {
                formattedExample += `\n選項：\n${example.options.join('\n')}`;
            }
            formattedExample += `\n答案：${example.answer_text || example.answer}`;
            formattedExample += `\n答題步驟：${example.steps}`;
            return formattedExample;
        });
    }
    
    return selectedExamples.map(example => 
        `題目：${example.question}\n答案：${example.answer}\n答題步驟：${example.steps}`
    );
}


        // 進度顯示函數
        function showProgress() {
            progressModal.classList.remove('hidden');
            startTime = Date.now();
            currentProgress = 0;
            updateProgressBar(currentProgress);
            
            progressTimer = setInterval(() => {
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                
                // 模擬進度更新
                if (currentProgress < 90) {
                    currentProgress += Math.random() * 2;
                    updateProgressBar(currentProgress);
                }
                
                // 更新預計剩餘時間
                if (currentProgress > 10) {
                    const estimated = (elapsed / currentProgress) * (100 - currentProgress);
                    document.getElementById('timeRemaining').textContent = Math.round(estimated) + '秒';
                }
            }, 1000);
        }

        function hideProgress() {
            progressModal.classList.add('hidden');
            if (progressTimer) {
                clearInterval(progressTimer);
                progressTimer = null;
            }
        }

        function updateProgressDisplay() {
            const steps = [
                '正在分析您的配置需求...',
                '正在連接AI智能引擎...',
                '正在生成專業題目內容...',
                '正在優化題目格式與排版...'
            ];
            
            const currentStepIndex = Math.floor(currentProgress / 25);
            const status = steps[Math.min(currentStepIndex, steps.length - 1)];
            
            document.getElementById('progressStatus').textContent = status;
            document.getElementById('currentStep').textContent = `${Math.min(currentStepIndex + 1, 4)}/4`;
        }

       function updateProgressBar(progress) {
    const progressBar = document.getElementById('progressBar');
    const progressPercent = document.getElementById('progressPercent');
    
    const clampedProgress = Math.min(100, Math.max(0, progress));
    
    // 更新進度條寬度
    progressBar.style.width = clampedProgress + '%';
    
    // 更新百分比
    progressPercent.textContent = Math.round(clampedProgress) + '%';
}

        // 主要生成函數
        async function handleGenerate() {
            const selectedType = document.querySelector('input[name="generatorType"]:checked').value;
            
            try {
                if (!validateInput(selectedType)) {
                    return;
                }
                
                showProgress();
                
                if (selectedType === 'reading') {
                    await generateReadingQuestions();
                } else if (selectedType === 'essay') {
                    await generateEssayQuestions();
                } else if (selectedType === 'practical') {
                    await generatePracticalQuestions();
                }
                
            } catch (error) {
                console.error('生成錯誤：', error);
                showError('生成過程中發生錯誤，請稍後重試');
                hideProgress();
            }
        }

       function validateInput(type) {
    if (type === 'reading') {
        // ... 保持原有邏輯
    } else if (type === 'essay') {
        if (selectedWritingTypes.size === 0) {
            showError('請至少選擇一種題型');
            return false;
        }
        
        if (selectedWritingTypes.has('自訂')) {
            const refQuestions = Array.from(document.querySelectorAll('.essay-reference textarea')).map(el => el.value.trim()).filter(val => val);
            if (refQuestions.length === 0) {
                showError('自訂模式下請輸入至少一個參考題目');
                return false;
            }
        }
    } else if (type === 'practical') {
        // ... 保持原有邏輯
    }
    
    return true;
}


        // 具體生成函數
       async function generateReadingQuestions() {
    const targetPassage = document.getElementById('targetPassage').value.trim();
    let allQuestions = [];
    
    for (const questionType of selectedQuestionTypes) {
        const quantityInput = document.getElementById(`quantity-${questionType}`);
        const quantity = parseInt(quantityInput.value);
        
        let refQAs = [];
        let specialInstructions = '';
        
        if (questionType === '自訂') {
            refQAs = Array.from(document.querySelectorAll('.reference-qa textarea'))
                .map(el => el.value.trim())
                .filter(val => val);
        } else {
            const examples = getQuestionBankExamples(questionType, quantity);
            refQAs = examples;
            
            if (questionType === '選擇') {
                specialInstructions = `
重要提醒：這是選擇題型，必須嚴格按照以下格式輸出：

題目[編號]：[題目內容]

選擇題選項容器：
A. [選項A內容]
B. [選項B內容]
C. [選項C內容]
D. [選項D內容]

答案[編號]：[正確選項字母] [正確選項完整內容]
步驟[編號]：[答題步驟說明]

每個選擇題必須包含：
1. 完整的題目內容
2. 4個選項（A、B、C、D），選項應該合理且有相當高的迷惑性
3. 正確答案（明確標明選項字母和內容）
4. 詳細的答題步驟
5. 4個選項（A、B、C、D）都必須是意思相近的句子，不可以是反義的句子

選項必須放在「選擇題選項容器」下方，確保格式正確。`;
            }
        }

        // 重試機制：最多重試3次直到生成成功
        let parsed = [];
        let retryCount = 0;
        const maxRetries = 3;
        
        while (retryCount < maxRetries) {
            try {
                const requestBody = {
                    model: MODEL,
                    messages: [
                        { role: "system", content: "你是一個閱讀卷題目生成器。" },
                        { role: "user", content: `請根據以下參考題目與答案，為擬題篇章生成${quantity}個相應的題目和答案：

參考題目與答案：
${refQAs.map((qa, index) => `題目${index + 1}與答案：${qa}`).join('\n')}

題型類別：${questionType}
${specialInstructions}

擬題篇章：
${targetPassage}

請為擬題篇章生成${quantity}個「${questionType}」題型的題目和答案。生成的題目應符合「${questionType}」題型的特點和要求。必須用繁體中文回應。

${questionType === '選擇' ? `
請嚴格按照以下格式輸出選擇題，絕對不能偏離：

題目1：[生成的題目1內容]

選擇題選項容器：
A. [選項A內容]
B. [選項B內容]
C. [選項C內容]
D. [選項D內容]

答案1：[正確選項字母] [正確選項完整內容]
步驟1：[答題步驟說明]

題目2：[生成的題目2內容]

選擇題選項容器：
A. [選項A內容]
B. [選項B內容]
C. [選項C內容]
D. [選項D內容]

答案2：[正確選項字母] [正確選項完整內容]
步驟2：[答題步驟說明]

（依此類推生成所有題目）
` : `
請以以下格式輸出生成的題目、答案和步驟：
題目1：[生成的題目1]
答案1：[生成的答案1]
步驟1：[生成的步驟1]
`}

生成的題目和答案應與參考題目和答案在形式和風格上相似，但內容和題材必須不同。生成的題目不得包含答案內容，答案不得與其他題目混淆。除非題目提及「摘錄」，否則生成的答案中不得直接引用原文文本依據，必須將其原文文本依據的語譯自然無痕地融入到答案之中。4分的題目，生成的答案字數必須強制控制在210字左右；5分的題目，生成的答案字數必須強制控制在230字左右；6分的題目，生成的答案字數必須強制控制在250字左右。由於是應試文章題目及答案，因此要避免過份具理論哲學性的字眼，必須減少概念模糊的術語，例如「情感載體」、「能動性」、「因果鏈條」、「辯證關係」、「時空的共創」，請用日常化用語。請確保生成的內容不為空白。若無法生成有效內容，則返回「未生成」。
` }
                    ],
                    max_tokens: 64000
                };

                const response = await callAPI(requestBody);
                parsed = questionType === '選擇' ? 
                    parseChoiceResponse(response, quantity) : 
                    parseReadingResponse(response, quantity);
                
                // 檢查是否有生成失敗的題目
                const hasFailure = parsed.some(item => 
                    item.question.includes('生成失敗') || 
                    item.answer.includes('生成失敗') || 
                    item.steps.includes('生成失敗') ||
                    item.question.includes('未生成') ||
                    item.answer.includes('未生成') ||
                    item.steps.includes('未生成') ||
                    !item.question.trim() ||
                    !item.answer.trim() ||
                    !item.steps.trim()
                );
                
                if (!hasFailure) {
                    // 生成成功，跳出重試循環
                    break;
                } else {
                    retryCount++;
                    console.log(`${questionType}題型第${retryCount}次重試`);
                    if (retryCount >= maxRetries) {
                        console.error(`${questionType}題型重試${maxRetries}次後仍然失敗`);
                    }
                }
            } catch (error) {
                retryCount++;
                console.error(`${questionType}題型生成錯誤，第${retryCount}次重試:`, error);
                if (retryCount >= maxRetries) {
                    // 最終失敗，使用錯誤信息
                    parsed = Array(quantity).fill().map((_, i) => ({
                        question: `題目${i+1}生成失敗，請檢查網路連接並重試`,
                        answer: `答案${i+1}生成失敗，請檢查網路連接並重試`,
                        steps: `步驟${i+1}生成失敗，請檢查網路連接並重試`
                    }));
                }
            }
        }
        
        // 為每個題目添加題型標籤
        parsed.forEach(item => {
            item.type = questionType;
        });
        
        allQuestions = allQuestions.concat(parsed);
    }
    
    displayReadingQuestions(allQuestions);
}


function parseChoiceResponse(response, count) {
    const cleanResponse = removeThinkingTags(response);
    const lines = cleanResponse.split('\n').filter(line => line.trim() !== '');
    
    const parsed = [];
    
    for (let i = 1; i <= count; i++) {
        let question = '';
        let options = [];
        let answer = '';
        let steps = '';
        
        let questionFound = false;
        let optionsFound = false;
        let answerFound = false;
        let stepsFound = false;
        
        for (let j = 0; j < lines.length; j++) {
            const line = lines[j].trim();
            
            // 解析題目
            if (line.startsWith(`題目${i}：`)) {
                question = line.replace(`題目${i}：`, '').trim();
                questionFound = true;
                continue;
            }
            
            // 解析選項容器
            if (line === '選擇題選項容器：' && questionFound && !optionsFound) {
                let k = j + 1;
                options = [];
                while (k < lines.length) {
                    const optionLine = lines[k].trim();
                    if (optionLine.match(/^[A-D]\.\s/)) {
                        options.push(optionLine);
                        k++;
                    } else {
                        break;
                    }
                }
                optionsFound = true;
                j = k - 1;
                continue;
            }
            
            // 解析答案
            if (line.startsWith(`答案${i}：`) && questionFound) {
                answer = line.replace(`答案${i}：`, '').trim();
                answerFound = true;
                continue;
            }
            
            // 解析步驟
            if (line.startsWith(`步驟${i}：`) && questionFound) {
                steps = line.replace(`步驟${i}：`, '').trim();
                stepsFound = true;
                continue;
            }
        }
        
        // 檢查生成是否完整，若有任何部分失敗則標記為生成失敗
        if (!questionFound || !question) {
            question = '生成失敗，請檢查輸入內容並重試';
        }
        if (!optionsFound || options.length === 0) {
            options = ['A. 生成失敗', 'B. 生成失敗', 'C. 生成失敗', 'D. 生成失敗'];
        }
        if (!answerFound || !answer) {
            answer = '生成失敗，請檢查輸入內容並重試';
        }
        if (!stepsFound || !steps) {
            steps = '生成失敗，請檢查輸入內容並重試';
        }
        
        // 構建完整的題目內容：題目 + 選項
        let fullQuestion = question;
        if (options.length > 0) {
            fullQuestion += '\n\n選項：\n' + options.join('\n');
        }
        
        parsed.push({ 
            question: fullQuestion, 
            answer, 
            steps 
        });
    }
    
    return parsed;
}




async function generateEssayQuestions() {
    let allQuestions = [];
    const customEssayType = document.querySelector('input[name="customEssayType"]:checked')?.value;
    
    for (const questionType of selectedWritingTypes) {
        let quantity;
        let refQuestions = [];
        let referenceLength = null;
        let promptInstructions = '';
        
        // 獲取已生成的題目
        const existingQuestions = getGeneratedQuestions(questionType);
        let existingKeywordsText = '';
        
        if (existingQuestions.length > 0) {
            const allExistingKeywords = existingQuestions.flatMap(q => q.keywords);
            existingKeywordsText = `\n\n重要提醒：以下是已經出過的題目主題關鍵詞，新生成的題目主題必須與這些完全不同（不能是近義詞或相關主題）：
已出過的主題關鍵詞：${allExistingKeywords.join('、')}
\n請確保新生成題目的主題與上述關鍵詞截然不同，不只是換個近義詞，而是要選擇完全不同的主題領域。`;
        }
        
        if (questionType === '自訂') {
            if (!customEssayType) {
                showError('請選擇自訂類型：敘事或議論');
                hideProgress();
                return;
            }
            refQuestions = Array.from(document.querySelectorAll('.essay-reference textarea'))
                .map(el => el.value.trim())
                .filter(val => val);
            if (refQuestions.length === 0) {
                let bankTypes = [];
                if (customEssayType === 'narrative') {
                    bankTypes = ['敘事', '開放'];
                } else if (customEssayType === 'argumentative') {
                    bankTypes = ['議論', '開放'];
                }
                bankTypes.forEach(type => {
                    const examples = getWritingQuestionBankExamples(type, Math.ceil(refQuestions.length / bankTypes.length));
                    refQuestions = refQuestions.concat(examples);
                });
            }
            quantity = refQuestions.length;
            const bankQuestions = writingQuestionBank[Object.keys(writingQuestionBank)[0]];
            const randomIndex = Math.floor(Math.random() * bankQuestions.length);
            referenceLength = bankQuestions[randomIndex].題目.length;
            promptInstructions = `請注意，AI擬題的字數不需要參考用家提供的參考題目，而是參考「${questionType}」類型的長文寫作題目。`;
        } else {
            const quantityInput = document.getElementById(`quantity-${questionType}`);
            quantity = parseInt(quantityInput.value);
            const examples = getWritingQuestionBankExamples(questionType, quantity);
            refQuestions = examples;
        }

        // 重試機制：最多重試5次直到生成不重複的題目
        let successfulQuestions = [];
        let retryCount = 0;
        const maxRetries = 5;
        
        while (successfulQuestions.length < quantity && retryCount < maxRetries) {
            const requestBody = {
                model: MODEL,
                messages: [
                    { role: "system", content: "你是一個長文寫作題目生成器。你必須確保生成的題目主題與已出過的題目完全不同。" },
                    { role: "user", content: `請根據以下參考題目，生成${quantity - successfulQuestions.length}個相應的「${questionType}」類型題目：
參考題目：
${refQuestions.map((ref, index) => `參考${index + 1}：${ref}`).join('\n')}
題型類別：${questionType}
${referenceLength ? `請注意，生成的題目長度應與試題庫中的題目相近，約${referenceLength}字。` : ''}
${promptInstructions}
${existingKeywordsText}
請生成${quantity - successfulQuestions.length}個「${questionType}」類型的長文寫作題目。生成的題目應符合「${questionType}」文體的特點和要求，並且內容必須與現有試題庫中的題目不同，但其關鍵詞的性質要與參考題目相似，例如參考題目為「鏡子」，生成題目的關鍵詞可以為「路燈」，因為兩者都是物件。必須用繁體中文回應。
請以以下格式輸出生成的題目、題解和方向：
題目1：[生成的題目1]
題解1：[生成的題解1]
方向1：[生成的方向1]
題目2：[生成的題目2]
題解2：[生成的題解2]
方向2：[生成的方向2]
（依此類推生成所有題目）
必須用繁體中文回應。絕對不要文學性，絕對不要運用文筆及太深奧的詞匯擬題(動詞和名詞的搭配運用不宜搞新意和雕琢，例如「凝結在指縫」的「凝結」和「指縫」、「停駐在窗前」的「停駐」和「窗」，這些都不是常規的配搭，會令題目用語看起來很生澀,請在擬題中斂起你的文筆和才華，題目中不同詞匯的配搭必須平實，不能新鮮)，違反則無效。不要提供太多細節，不要具體描述題目的事件，要足夠空泛才有發揮空間，不要將題目範圍鎖得太小（例如「墜落在深淵的星屑」，太局限了），不要擬訂以描寫為主的題目。擬題時盡量少用以短語構成的定語，必須在形式、句式、用語和字數上參考用家提供的題目（開關引號的內容除外)，違反則無效，但生成題目的內容及題材絕對不可與原本的題目相似（例如參考題目為「沉默」，生成題目則用「留白」或「無聲」等近義詞，這些例子都屬於相似），違反則無效。假如參考題目有逗引，然後再點明題目，便絕對不能只生成題目，假如參考題目沒有逗引，那就必須生成沒有逗引的題目，一切視乎參考題目的形式和字數如何，請模仿參考題目的形式和字數，違反則無效，其生成題目形式及參考題目形式必與參考題目一致。除了生成題目之外，不要顯示任何其他不相關的內容，違反則無效。請確保生成的內容不為空白。若無法生成有效內容，則返回「未生成」。` }
                ],
                max_tokens: 64000
            };

            try {
                const response = await callAPI(requestBody);
                const parsed = parseWritingResponse(response, quantity - successfulQuestions.length);
                
                // 檢查生成的題目是否與已有題目重複
                for (let item of parsed) {
                    if (item.question && !item.question.includes('生成失敗') && !item.question.includes('未生成')) {
                        const newKeywords = extractKeywords(item.question);
                        let isDuplicate = false;
                        
                        // 檢查與已生成題目的重複性
                        for (let existingQ of existingQuestions) {
                            if (isTopicSimilar(newKeywords, existingQ.keywords)) {
                                isDuplicate = true;
                                break;
                            }
                        }
                        
                        // 檢查與本次已成功生成題目的重複性
                        for (let successQ of successfulQuestions) {
                            const successKeywords = extractKeywords(successQ.question);
                            if (isTopicSimilar(newKeywords, successKeywords)) {
                                isDuplicate = true;
                                break;
                            }
                        }
                        
                        if (!isDuplicate) {
                            item.type = questionType;
                            successfulQuestions.push(item);
                            // 保存到 LOCAL STORAGE
                            saveGeneratedQuestion(questionType, item.question);
                        }
                    }
                    
                    if (successfulQuestions.length >= quantity) break;
                }
                
                if (successfulQuestions.length >= quantity) {
                    break;
                }
                
            } catch (error) {
                console.error(`第${retryCount + 1}次重試失敗:`, error);
            }
            
            retryCount++;
        }
        
        // 如果重試後仍不足數量，用錯誤信息補足
        while (successfulQuestions.length < quantity) {
            successfulQuestions.push({
                question: '生成失敗：無法生成不重複的題目，請清除題目記錄後重試',
                solution: '請點擊清除記錄按鈕後重新生成',
                direction: '建議清除已生成的題目記錄',
                type: questionType
            });
        }
        
        allQuestions = allQuestions.concat(successfulQuestions);
    }
    
    displayWritingQuestions(allQuestions);
}

// 解析長文寫作回應
function parseWritingResponse(response, count) {
    const cleanResponse = removeThinkingTags(response);
    const lines = cleanResponse.split('\n').filter(line => line.trim() !== '');
    
    const parsed = [];
    
    for (let i = 1; i <= count; i++) {
        let question = '生成失敗，請檢查輸入內容並重試';
        let solution = '生成失敗，請檢查輸入內容並重試';
        let direction = '生成失敗，請檢查輸入內容並重試';
        
        for (let j = 0; j < lines.length; j++) {
            const line = lines[j].trim();
            
            if (line.startsWith(`題目${i}：`)) {
                question = line.replace(`題目${i}：`, '').trim();
            }
            
            if (line.startsWith(`題解${i}：`)) {
                solution = line.replace(`題解${i}：`, '').trim();
            }

            if (line.startsWith(`方向${i}：`)) {
                direction = line.replace(`方向${i}：`, '').trim();
            }
        }
        
        parsed.push({ question, solution, direction });
    }
    
    return parsed;
}

// 顯示長文寫作結果
function displayWritingQuestions(allQuestions) {
    hideProgress();
    
    const questionsDisplay = document.getElementById('questionsDisplay');
    questionsDisplay.innerHTML = '';

    allQuestions.forEach((item, index) => {
        const questionCard = createWritingQuestionCard(
            `第${index + 1}題`,
            item.question,
            item.solution,
            item.direction,
            item.type || 'essay'
        );
        questionsDisplay.appendChild(questionCard);
    });

    showResult();
}

// 創建長文寫作題目卡片
function createWritingQuestionCard(title, content, solution, direction, type) {
    const card = document.createElement('div');
    card.className = 'question-card p-10 shadow-2xl slide-up mb-12';
    
    const typeColors = {
        '敘事': '#D4909F',
        '開放': '#B496EB', 
        '議論': '#722F3E',
        'essay': 'var(--primary-blue)'
    };
    
    const typeColor = typeColors[type] || 'var(--primary-blue)';
    
    let cardHTML = `
        <div class="flex items-center justify-between mb-8">
            <div class="question-title" style="background: linear-gradient(135deg, ${typeColor} 0%, ${typeColor}80 100%);">
                <i class="fas fa-pen-fancy mr-4"></i>
                ${title}
            </div>
            <span class="px-6 py-3 rounded-full text-base font-bold text-white" style="background: linear-gradient(135deg, ${typeColor} 0%, ${typeColor}CC 100%);">${type}</span>
        </div>
        <div class="bg-gradient-to-br from-gray-50 to-white rounded-2xl p-8 mb-8 border-2 border-gray-100">
            <div class="text-gray-800 leading-relaxed whitespace-pre-wrap text-lg font-medium">${content}</div>
        </div>
    `;

    if (solution && direction) {
        cardHTML += `
            <div class="border-t-4 pt-8" style="border-color: var(--divider-color);">
                <button onclick="toggleWritingAnswer(this, '${typeColor}')" class="flex items-center font-bold mb-6 transition-colors duration-300 text-xl hover:transform hover:scale-105" style="color: ${typeColor};">
                    <i class="fas fa-eye mr-4"></i>顯示題解及方向
                </button>
                <div class="answer-content hidden">
                    <div class="answer-section mb-6">
                        <h4 class="font-bold mb-6 flex items-center text-xl" style="color: var(--primary-green);">
                            <i class="fas fa-lightbulb mr-4"></i>題解
                        </h4>
                        <div class="leading-relaxed whitespace-pre-wrap text-gray-700 text-lg">${solution}</div>
                    </div>
                    <div class="steps-section">
                        <h4 class="font-bold mb-6 flex items-center text-xl" style="color: #7fb3d5;">
                            <i class="fas fa-compass mr-4"></i>方向
                        </h4>
                        <div class="leading-relaxed whitespace-pre-wrap text-gray-700 text-lg">${direction}</div>
                    </div>
                </div>
            </div>
        `;
    }

    card.innerHTML = cardHTML;
    return card;
}

// 切換長文寫作答案顯示
function toggleWritingAnswer(button, typeColor) {
    const answerContent = button.nextElementSibling;
    
    if (answerContent.classList.contains('hidden')) {
        answerContent.classList.remove('hidden');
        button.innerHTML = '<i class="fas fa-eye-slash mr-4"></i>隱藏題解及方向';
        button.style.color = typeColor;
        answerContent.style.maxHeight = answerContent.scrollHeight + 'px';
    } else {
        answerContent.classList.add('hidden');
        button.innerHTML = '<i class="fas fa-eye mr-4"></i>顯示題解及方向';
        button.style.color = typeColor;
        answerContent.style.maxHeight = '0';
    }
}


     async function generatePracticalQuestions() {
    const selectedTopic = document.getElementById('topicSelect').value;
    let topicInstruction;
    if (selectedTopic === 'custom') {
        const customTopic = document.getElementById('customTopic').value.trim();
        if (!customTopic) {
            showError('請輸入自訂主題');
            hideProgress();
            return;
        }
        topicInstruction = `請以「${customTopic}」為主題。`;
    } else if (selectedTopic === 'random') {
        topicInstruction = '請隨機選擇一個主題，且該主題必須與以下列出的所有主題（運動、生涯規劃、責任、教育、文化、社會、歷史、地理、藝術、體育、法律、健康、心理、家庭、友誼、愛情、就業、經濟、生態、能源、資源、安全、網路、媒體、資訊、道德、誠信、公平、自由、權利、義務、隱私、禮儀、榜樣、創新、創業、消費、儲蓄、民族、語言、宗教、傳統、現代、城鄉、社區、公益、慈善、災害、醫療、疾病、飲食、旅遊、建築、娛樂、音樂、電影、文學、人口、性別、年齡、職業、學業、考試、升學、校園、師生、同學、課外、社團、競賽、志願、壓力、自律、時間、興趣、習慣、遊戲、睡眠、氣候、汙染、閱讀）不同，例如可以選擇「科技發展」、「全球化」等其他主題。';
    } else {
        topicInstruction = `請以「${selectedTopic}」為主題。`;
    }

    if (selectedPracticalTypes.size === 0) {
        showError('請至少選擇一種體裁');
        hideProgress();
        return;
    }

    let allQuestions = [];

    for (const practicalType of selectedPracticalTypes) {
        const quantityInput = document.getElementById(`quantity-${practicalType}`);
        const quantity = parseInt(quantityInput.value);

        let refQuestion = '';
        let refMaterial1 = '';
        let refMaterial2 = '';
        let formatReference = '';

        if (practicalType === '自訂') {
            refQuestion = document.getElementById('customRefQuestion').value.trim();
            refMaterial1 = document.getElementById('customRefMaterial1').value.trim();
            refMaterial2 = document.getElementById('customRefMaterial2').value.trim();
            if (!refQuestion || !refMaterial1 || !refMaterial2) {
                showError('自訂模式下請完整輸入參考題目及資料');
                hideProgress();
                return;
            }
            // 選取一個隨機的實用文範例作為格式參考
            const randomType = Object.keys(practicalQuestionBank)[Math.floor(Math.random() * Object.keys(practicalQuestionBank).length)];
            const examples = getPracticalQuestionBankExamples(randomType, 1);
            if (examples.length > 0) {
                formatReference = `請參考以下格式：
題目格式：${examples[0].題目}
資料一格式：${examples[0].資料一}
資料二格式：${examples[0].資料二}`;
            }
        } else {
            const examples = getPracticalQuestionBankExamples(practicalType, 1);
            if (examples.length > 0) {
                const example = examples[0];
                refQuestion = example.題目;
                refMaterial1 = example.資料一;
                refMaterial2 = example.資料二;
            }
        }

        for (let i = 0; i < quantity; i++) {
            const requestBody = {
                model: MODEL,
                messages: [
                    { role: "system", content: "你是一個實用文題目生成器。" },
                    { role: "user", content: `請根據以下參考內容生成相應的實用文題目和資料：
參考題目：
${refQuestion}
參考資料一：
${refMaterial1}
參考資料二：
${refMaterial2}
${formatReference}
${topicInstruction}請生成一個新的題目和兩個資料，模仿參考內容的風格和形式，但內容和題材必須不同。生成的題目應與參考題目在形式和字數上相似，但內容和題材必須不同。生成的資料一應與參考資料一在形式和風格上相似，但內容和題材必須不同；生成的資料二應與參考資料二在形式和風格上相似，但內容和題材必須不同。資料中若包含表格，需使用HTML格式生成，表格樣式需與參考資料一致。請確保生成的內容不為空白。若無法生成有效內容，則返回「未生成」。
請以以下格式輸出生成的題目和資料：
題目：[生成的題目]
資料一：[生成的資料一]
資料二：[生成的資料二]` }
                ],
                max_tokens: 64000
            };

            const response = await callAPI(requestBody);
            const parsed = parsePracticalResponse(response);
            parsed.type = practicalType;
            allQuestions.push(parsed);
        }
    }

    displayPracticalQuestions(allQuestions);
}


        // API 調用函數
        async function callAPI(requestBody) {
            // 模擬進度更新
            updateProgressBar(20);
            
            const response = await fetch(API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${API_KEY}`
                },
                body: JSON.stringify(requestBody)
            });

            updateProgressBar(60);

            if (!response.ok) {
                throw new Error(`API請求失敗，狀態碼：${response.status}`);
            }

            const data = await response.json();
            updateProgressBar(90);
            
            let generatedContent = data.choices[0].message.content;
            generatedContent = removeThinkingTags(generatedContent);
            
            updateProgressBar(100);
            
            return generatedContent;
        }

        // 輔助函數
        function removeThinkingTags(content) {
            if (typeof content !== 'string') {
                return content;
            }
            return content.replace(/<think>[\s\S]*?<\/think>/gi, '').trim();
        }

        function parseReadingResponse(response, count) {
            const cleanResponse = removeThinkingTags(response);
            const lines = cleanResponse.split('\n').filter(line => line.trim() !== '');
            
            const parsed = [];
            
            for (let i = 1; i <= count; i++) {
                let question = '生成失敗，請檢查輸入內容並重試';
                let answer = '生成失敗，請檢查輸入內容並重試';
                let steps = '生成失敗，請檢查輸入內容並重試';
                
                for (let j = 0; j < lines.length; j++) {
                    const line = lines[j].trim();
                    
                    if (line.startsWith(`題目${i}：`)) {
                        question = line.replace(`題目${i}：`, '').trim();
                        if (!question && j + 1 < lines.length) {
                            const nextLine = lines[j + 1].trim();
                            if (!nextLine.startsWith('答案') && !nextLine.startsWith('題目') && !nextLine.startsWith('步驟')) {
                                question = nextLine;
                            }
                        }
                    }
                    
                    if (line.startsWith(`答案${i}：`)) {
                        answer = line.replace(`答案${i}：`, '').trim();
                        if ((!answer || answer.length < 10) && j + 1 < lines.length) {
                            let answerContent = answer;
                            let k = j + 1;
                            while (k < lines.length) {
                                const nextLine = lines[k].trim();
                                if (nextLine.startsWith('題目') || nextLine.startsWith('答案') || nextLine.startsWith('步驟')) {
                                    break;
                                }
                                if (nextLine) {
                                    answerContent += (answerContent ? '\n' : '') + nextLine;
                                }
                                k++;
                            }
                            if (answerContent) {
                                answer = answerContent.trim();
                            }
                        }
                    }

                    if (line.startsWith(`步驟${i}：`)) {
                        steps = line.replace(`步驟${i}：`, '').trim();
                        if ((!steps || steps.length < 5) && j + 1 < lines.length) {
                            let stepsContent = steps;
                            let k = j + 1;
                            while (k < lines.length) {
                                const nextLine = lines[k].trim();
                                if (nextLine.startsWith('題目') || nextLine.startsWith('答案') || nextLine.startsWith('步驟')) {
                                    break;
                                }
                                if (nextLine) {
                                    stepsContent += (stepsContent ? '\n' : '') + nextLine;
                                }
                                k++;
                            }
                            if (stepsContent) {
                                steps = stepsContent.trim();
                            }
                        }
                    }
                }
                
                if (!question || question === answer) {
                    question = `題目${i}生成失敗，請檢查輸入內容並重試`;
                }
                if (!answer || answer === question) {
                    answer = `答案${i}生成失敗，請檢查輸入內容並重試`;
                }
                if (!steps || steps === question || steps === answer) {
                    steps = `步驟${i}生成失敗，請檢查輸入內容並重試`;
                }
                
                parsed.push({ question, answer, steps });
            }
            
            return parsed;
        }
function parsePracticalResponse(response) {
    const cleanResponse = removeThinkingTags(response);
    const lines = cleanResponse.split('\n').filter(line => line.trim() !== '');

    let question = '未生成';
    let material1 = '未生成';
    let material2 = '未生成';

    for (let i = 0; i < lines.length; i++) {
        const line = lines[i].trim();
        if (line.startsWith('題目：')) {
            question = line.replace('題目：', '').trim();
        } else if (line.startsWith('資料一：')) {
            let content = line.replace('資料一：', '').trim();
            let j = i + 1;
            while (j < lines.length && !lines[j].startsWith('資料二：') && !lines[j].startsWith('題目：')) {
                content += '\n' + lines[j].trim();
                j++;
            }
            material1 = content.trim();
            i = j - 1;
        } else if (line.startsWith('資料二：')) {
            let content = line.replace('資料二：', '').trim();
            let j = i + 1;
            while (j < lines.length && !lines[j].startsWith('題目：') && !lines[j].startsWith('資料一：')) {
                content += '\n' + lines[j].trim();
                j++;
            }
            material2 = content.trim();
            i = j - 1;
        }
    }

    return { question, material1, material2 };
}

        // 顯示結果函數
        function displayReadingQuestions(allQuestions) {
            hideProgress();
            
            const questionsDisplay = document.getElementById('questionsDisplay');
            questionsDisplay.innerHTML = '';

            allQuestions.forEach((item, index) => {
                const questionCard = createQuestionCard(
                    `第${index + 1}題`,
                    item.question,
                    item.answer,
                    item.steps,
                    item.type || 'reading'
                );
                questionsDisplay.appendChild(questionCard);
            });

            showResult();
        }

        function displayEssayQuestions(questions) {
            hideProgress();
            
            const questionsDisplay = document.getElementById('questionsDisplay');
            questionsDisplay.innerHTML = '';

            const trimmedQuestions = questions.trim();
            const questionList = trimmedQuestions.split('\n').filter(q => q.trim());

            questionList.forEach((question, index) => {
                const questionCard = createQuestionCard(
                    `第${index + 1}題`,
                    question.trim(),
                    null,
                    null,
                    'essay'
                );
                questionsDisplay.appendChild(questionCard);
            });

            showResult();
        }
function displayPracticalQuestions(allQuestions) {
    hideProgress();

    const questionsDisplay = document.getElementById('questionsDisplay');
    questionsDisplay.innerHTML = '';

    allQuestions.forEach((item, index) => {
        const titleCard = createQuestionCard(`第${index + 1}題 - 題目`, item.question, null, null, item.type);
        questionsDisplay.appendChild(titleCard);

        const material1Card = createQuestionCard(`第${index + 1}題 - 資料一`, item.material1, null, null, item.type);
        questionsDisplay.appendChild(material1Card);

        const material2Card = createQuestionCard(`第${index + 1}題 - 資料二`, item.material2, null, null, item.type);
        questionsDisplay.appendChild(material2Card);
    });

    showResult();
}

        function createQuestionCard(title, content, answer = null, steps = null, type = 'default') {
    const card = document.createElement('div');
    card.className = 'question-card p-10 shadow-2xl slide-up mb-12';
    
    // 格式化選擇題內容
    let formattedContent = content;
    if (type === '選擇') {
        // 為選擇題選項添加特殊樣式
        formattedContent = content.replace(/選項：\n/g, '<div class="choice-options-container"><h4 class="choice-options-title">選項：</h4>');
        formattedContent = formattedContent.replace(/([A-D]\.\s[^\n]+)/g, '<div class="choice-option">$1</div>');
        if (formattedContent.includes('choice-options-container')) {
            formattedContent += '</div>';
        }
    }

    // 設定題型顏色
    const typeColors = {
        'reading': 'var(--primary-teal)',
        'essay': 'var(--primary-blue)',
        'practical': 'var(--primary-green)',
        '複述': '#D4909F',
        '分析': '#B496EB',
        '印證': '#722F3E',
        '闡明': '#EA928F',
        '意見': '#8B6455',
        '比較': '#3EE1C2',
        '選擇': '##55A193'  // 為選擇題添加特殊顏色
    };
    
    const typeColor = typeColors[type] || 'var(--primary-teal)';
    
    let cardHTML = `
        <div class="flex items-center justify-between mb-8">
            <div class="question-title" style="background: linear-gradient(135deg, ${typeColor} 0%, ${typeColor}80 100%);">
                <i class="fas fa-question-circle mr-4"></i>
                ${title}
            </div>
            <span class="px-6 py-3 rounded-full text-base font-bold text-white" style="background: linear-gradient(135deg, ${typeColor} 0%, ${typeColor}CC 100%);">${type}</span>
        </div>
    `;

    // 選擇題需要特殊的樣式
    if (type === '選擇') {
        cardHTML += `
            <div class="bg-gradient-to-br from-gray-50 to-white rounded-2xl p-8 mb-8 border-2 border-gray-100">
                <div class="text-gray-800 leading-relaxed text-lg font-medium">${formattedContent}</div>
            </div>
            <style>
                .choice-options-container {
                    margin-top: 20px;
                    padding: 20px;
                    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
                    border-radius: 15px;
                    border-left: 5px solid ${typeColor};
                }
                .choice-options-title {
                    font-weight: bold;
                    color: ${typeColor};
                    margin-bottom: 15px;
                    font-size: 18px;
                }
                .choice-option {
                    padding: 10px 15px;
                    margin: 8px 0;
                    background: white;
                    border-radius: 8px;
                    border-left: 3px solid #dee2e6;
                    font-weight: 500;
                    transition: all 0.3s ease;
                }
                .choice-option:hover {
                    border-left-color: ${typeColor};
                    transform: translateX(5px);
                    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                }
            </style>
        `;
    } else {
        cardHTML += `
            <div class="bg-gradient-to-br from-gray-50 to-white rounded-2xl p-8 mb-8 border-2 border-gray-100">
                <div class="text-gray-800 leading-relaxed whitespace-pre-wrap text-lg font-medium">${formattedContent}</div>
            </div>
        `;
    }

    if (answer) {
        cardHTML += `
            <div class="border-t-4 pt-8" style="border-color: var(--divider-color);">
                <button onclick="toggleAnswer(this)" class="flex items-center font-bold mb-6 transition-colors duration-300 text-xl hover:transform hover:scale-105" style="color: ${typeColor};">
                    <i class="fas fa-eye mr-4"></i>顯示詳細答案
                </button>
                <div class="answer-content hidden">
                    <div class="answer-section mb-6">
                        <h4 class="font-bold mb-6 flex items-center text-xl" style="color: var(--primary-green);">
                            <i class="fas fa-lightbulb mr-4"></i>參考答案
                        </h4>
                        <div class="leading-relaxed whitespace-pre-wrap text-gray-700 text-lg">${answer}</div>
                    </div>
        `;
        
        if (steps) {
            cardHTML += `
                    <div class="steps-section">
                        <h4 class="font-bold mb-6 flex items-center text-xl" style="color: #7fb3d5;">
                            <i class="fas fa-list-ol mr-4"></i>答題步驟
                        </h4>
                        <div class="leading-relaxed whitespace-pre-wrap text-gray-700 text-lg">${steps}</div>
                    </div>
            `;
        }
        
        cardHTML += `
                </div>
            </div>
        `;
    }

    card.innerHTML = cardHTML;
    return card;
}

        function showResult() {
            mainContainer.classList.add('hidden');
            resultContainer.classList.remove('hidden');
            
            // 添加動畫延遲
            const cards = document.querySelectorAll('.question-card');
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.15}s`;
            });
        }

     function toggleAnswer(button, typeColor) {
    const answerContent = button.nextElementSibling;
    const icon = button.querySelector('i');
    
    if (answerContent.classList.contains('hidden')) {
        answerContent.classList.remove('hidden');
        button.innerHTML = '<i class="fas fa-eye-slash mr-4"></i>隱藏詳細答案';
        // 修訂處：移除顏色切換，保持 typeColor
        button.style.color = typeColor;
        answerContent.style.maxHeight = answerContent.scrollHeight + 'px';
    } else {
        answerContent.classList.add('hidden');
        button.innerHTML = '<i class="fas fa-eye mr-4"></i>顯示詳細答案';
        // 修訂處：移除顏色切換，保持 typeColor
        button.style.color = typeColor;
        answerContent.style.maxHeight = '0';
    }
}



        function goBack() {
            resultContainer.classList.add('hidden');
            mainContainer.classList.remove('hidden');
        }

        function regenerate() {
            handleGenerate();
        }

        function showError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'fixed top-8 right-8 p-8 rounded-2xl shadow-2xl z-50 fade-in text-white max-w-md';
            errorDiv.style.background = 'linear-gradient(135deg, var(--primary-rose) 0%, var(--secondary-rose) 100%)';
            errorDiv.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-exclamation-triangle mr-4 text-2xl"></i>
                    <span class="text-lg font-semibold flex-1">${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-6 text-white hover:text-gray-200 text-2xl transition-colors duration-300">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            document.body.appendChild(errorDiv);
            
            setTimeout(() => {
                if (errorDiv.parentElement) {
                    errorDiv.remove();
                }
            }, 6000);
        }


// 新增全域變數
var selectedWritingTypes = new Set();

// 長文寫作題型切換函數
function toggleWritingQuestionType(toggleElement, questionType) {
    const isActive = toggleElement.classList.contains('active');
    const quantityControl = toggleElement.closest('.question-type-selection').querySelector('.quantity-control');
    
    if (isActive) {
        // 取消選中
        toggleElement.classList.remove('active');
        selectedWritingTypes.delete(questionType);
        if (quantityControl) {
            quantityControl.style.display = 'none';
        }
        
        // 隱藏自訂配置
        if (questionType === '自訂') {
            document.getElementById('customEssayConfig').classList.add('hidden');
        }
    } else {
        // 選中
        toggleElement.classList.add('active');
        selectedWritingTypes.add(questionType);
        if (quantityControl) {
            quantityControl.style.display = 'flex';
        }
        
        // 顯示自訂配置
        if (questionType === '自訂') {
            document.getElementById('customEssayConfig').classList.remove('hidden');
        }
    }
}

// 長文寫作參考題目管理函數
function addEssayReference() {
    const list = document.getElementById('essayReferenceList');
    const currentCount = list.querySelectorAll('.essay-reference').length;
    const newRef = document.createElement('div');
    newRef.className = 'essay-reference fade-in';
    newRef.innerHTML = `
        <div class="flex items-start space-x-4 bg-white p-8 rounded-2xl border-3 border-blue-200">
            <span class="flex-shrink-0 w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-full flex items-center justify-center font-bold text-lg question-number">${currentCount + 1}</span>
            <textarea class="flex-1 p-6 border-2 border-blue-200 rounded-xl focus:border-blue-400 focus:ring-0 transition-colors duration-300 resize-vertical" placeholder="在此輸入參考題目"></textarea>
        </div>
    `;
    list.appendChild(newRef);
    updateEssayReferenceNumbers();
}

function removeEssayReference() {
    const list = document.getElementById('essayReferenceList');
    const items = list.querySelectorAll('.essay-reference');
    if (items.length > 1) {
        items[items.length - 1].remove();
        updateEssayReferenceNumbers();
    }
}

function clearEssayReference() {
    const textareas = document.querySelectorAll('.essay-reference textarea');
    textareas.forEach(textarea => {
        textarea.value = '';
    });
}

function updateEssayReferenceNumbers() {
    const items = document.querySelectorAll('.essay-reference');
    items.forEach((item, index) => {
        const numberSpan = item.querySelector('span');
        numberSpan.textContent = index + 1;
    });
}

// 從寫作試題庫獲取參考範例
function getWritingQuestionBankExamples(questionType, count = 3) {
    if (!writingQuestionBank[questionType]) {
        return [];
    }
    
    const examples = writingQuestionBank[questionType];
    const selectedCount = Math.min(count, examples.length);
    const selectedExamples = [];
    const usedIndexes = new Set();
    
    while (selectedExamples.length < selectedCount) {
        const randomIndex = Math.floor(Math.random() * examples.length);
        if (!usedIndexes.has(randomIndex)) {
            usedIndexes.add(randomIndex);
            selectedExamples.push(examples[randomIndex]);
        }
    }
    
    return selectedExamples.map(example => 
        `題目：${example.題目}\n題解：${example.題解}\n方向：${example.方向}`
    );
}


function getPracticalQuestionBankExamples(practicalType, count = 1) {
    if (!practicalQuestionBank[practicalType]) {
        return [];
    }

    const examples = practicalQuestionBank[practicalType];
    const selectedCount = Math.min(count, examples.length);
    const selectedExamples = [];
    const usedIndexes = new Set();

    while (selectedExamples.length < selectedCount) {
        const randomIndex = Math.floor(Math.random() * examples.length);
        if (!usedIndexes.has(randomIndex)) {
            usedIndexes.add(randomIndex);
            selectedExamples.push(examples[randomIndex]);
        }
    }

    return selectedExamples;
}


// 輔助函數：準備PDF輸出格式
function preparePDFLayout() {
    const questionsDisplay = document.getElementById('questionsDisplay');
    const cards = questionsDisplay.querySelectorAll('.question-card');
    
    cards.forEach((card, index) => {
        // 為每個卡片設置唯一標識
        card.setAttribute('data-pdf-page', index + 1);
        
        // 確保答案區域在PDF中可見
        const answerContent = card.querySelector('.answer-content');
        if (answerContent && answerContent.classList.contains('hidden')) {
            answerContent.classList.remove('hidden');
            answerContent.style.display = 'block';
            answerContent.style.maxHeight = 'none';
        }
        
        // 調整按鈕顯示
        const toggleButton = card.querySelector('button[onclick*="toggleAnswer"]');
        if (toggleButton) {
            toggleButton.style.display = 'none';
        }
    });
}

// 輔助函數：還原顯示格式
function restorePDFLayout() {
    const questionsDisplay = document.getElementById('questionsDisplay');
    const cards = questionsDisplay.querySelectorAll('.question-card');
    
    cards.forEach(card => {
        // 還原答案區域隱藏狀態
        const answerContent = card.querySelector('.answer-content');
        if (answerContent) {
            answerContent.classList.add('hidden');
            answerContent.style.maxHeight = '0';
        }
        
        // 還原按鈕顯示
        const toggleButton = card.querySelector('button[onclick*="toggleAnswer"]');
        if (toggleButton) {
            toggleButton.style.display = 'flex';
        }
    });
}


// LOCAL STORAGE 管理函數
function saveGeneratedQuestion(questionType, question) {
    const storageKey = 'generatedQuestions';
    let generatedQuestions = JSON.parse(localStorage.getItem(storageKey)) || {};
    
    if (!generatedQuestions[questionType]) {
        generatedQuestions[questionType] = [];
    }
    
    // 提取主題關鍵詞
    const keywords = extractKeywords(question);
    
    generatedQuestions[questionType].push({
        question: question,
        keywords: keywords,
        timestamp: new Date().getTime()
    });
    
    localStorage.setItem(storageKey, JSON.stringify(generatedQuestions));
}

function getGeneratedQuestions(questionType) {
    const storageKey = 'generatedQuestions';
    let generatedQuestions = JSON.parse(localStorage.getItem(storageKey)) || {};
    return generatedQuestions[questionType] || [];
}

function extractKeywords(question) {
    // 提取題目中的關鍵詞（主題詞）
    const keywordPatterns = [
        /「([^」]+)」/g,  // 引號內的詞
        /以「([^」]+)」為題/g,  // 以...為題
        /試以「([^」]+)」/g,   // 試以...
        /「([^」]+)」為首句/g,  // ...為首句
        /「([^」]+)」為末句/g   // ...為末句
    ];
    
    let keywords = [];
    keywordPatterns.forEach(pattern => {
        let match;
        while ((match = pattern.exec(question)) !== null) {
            keywords.push(match[1]);
        }
    });
    
    // 如果沒有找到引號內容，提取其他可能的主題詞
    if (keywords.length === 0) {
        const commonWords = ['以', '為題', '試', '寫作', '文章', '一篇', '根據', '描述'];
        const words = question.split(/[，。？！\s]+/);
        keywords = words.filter(word => 
            word.length >= 2 && 
            !commonWords.includes(word) &&
            !/^[0-9]+$/.test(word)
        ).slice(0, 3);
    }
    
    return keywords;
}

function clearGeneratedQuestions() {
    if (confirm('系統會自動記住已生成的題目，確保新題目主題不重複，確定要清除所有已生成的題目紀錄嗎？')) {
        localStorage.removeItem('generatedQuestions');
        alert('已清除所有題目記錄');
    }
}

function isTopicSimilar(newKeywords, existingKeywords) {
    // 檢查主題是否相似
    for (let newKeyword of newKeywords) {
        for (let existingKeyword of existingKeywords) {
            if (newKeyword === existingKeyword || 
                isSynonym(newKeyword, existingKeyword)) {
                return true;
            }
        }
    }
    return false;
}

function isSynonym(word1, word2) {
    // 定義近義詞組
    const synonymGroups = [
        ['沉默', '無聲', '寂靜', '安靜'],
        ['友誼', '友情', '朋友'],
        ['母愛', '母親', '媽媽'],
        ['夢想', '理想', '願望'],
        ['回憶', '記憶', '往事'],
        ['成長', '長大', '成熟'],
        ['堅持', '執著', '毅力'],
        ['勇氣', '勇敢', '膽量'],
        ['寬容', '包容', '體諒'],
        ['感恩', '感謝', '謝意']
    ];
    
    for (let group of synonymGroups) {
        if (group.includes(word1) && group.includes(word2)) {
            return true;
        }
    }
    return false;
}

function showQuestionHistory() {
    const storageKey = 'generatedQuestions';
    const generatedQuestions = JSON.parse(localStorage.getItem(storageKey)) || {};
    
    let historyHTML = '<div style="max-height: 400px; overflow-y: auto;">';
    let totalCount = 0;
    
    for (let [type, questions] of Object.entries(generatedQuestions)) {
        if (questions.length > 0) {
            historyHTML += `<h3 style="color: var(--primary-blue); margin: 15px 0 10px 0; font-weight: bold;">${type} (${questions.length}題)</h3>`;
            questions.forEach((q, index) => {
                const date = new Date(q.timestamp).toLocaleDateString();
                historyHTML += `
                    <div style="background: #f8f9fa; padding: 10px; margin: 8px 0; border-radius: 8px; border-left: 4px solid var(--primary-blue);">
                        <div style="font-weight: bold; margin-bottom: 5px;">第${index + 1}題 (${date})</div>
                        <div style="margin-bottom: 5px;">${q.question}</div>
                        <div style="font-size: 12px; color: #666;">關鍵詞：${q.keywords.join('、')}</div>
                    </div>
                `;
                totalCount++;
            });
        }
    }
    
    if (totalCount === 0) {
        historyHTML += '<p style="text-align: center; color: #666; margin: 20px;">尚無生成記錄</p>';
    }
    
    historyHTML += '</div>';
    
    // 創建模態框顯示記錄
    const modal = document.createElement('div');
    modal.style.cssText = `
        position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
        background: rgba(0,0,0,0.7); z-index: 10000; 
        display: flex; align-items: center; justify-content: center;
    `;
    modal.innerHTML = `
        <div style="background: white; padding: 30px; border-radius: 15px; max-width: 80%; width: 600px; max-height: 80%;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="margin: 0; color: var(--primary-blue);">
                    <i class="fas fa-history mr-3"></i>題目生成記錄 (共${totalCount}題)
                </h2>
                <button onclick="this.closest('.modal').remove()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #999;">×</button>
            </div>
            ${historyHTML}
        </div>
    `;
    modal.className = 'modal';
    document.body.appendChild(modal);
}



    </script>

   <!-- Copyright Footer -->
   <footer class="copyright-footer">
        <p>Copyright © 2025 陳冠健. All rights reserved.</p>
    </footer>

    
</body>
</html>
